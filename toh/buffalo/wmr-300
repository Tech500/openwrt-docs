<!DOCTYPE html>
<html lang="en" dir="ltr" class="no-js">
<head>
    <meta charset="utf-8" />
    <title>Buffalo WMR-300 [OpenWrt Wiki]</title>
    <script>(function(H){H.className=H.className.replace(/\bno-js\b/,'js')})(document.documentElement)</script>
    <meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="keywords" content="ramips,mt7620n,8flash,64ram,serial,mips,mips32,24kec"/>
<link rel="search" type="application/opensearchdescription+xml" href="../../lib/exe/opensearch.php" title="OpenWrt Wiki"/>
<link rel="start" href="../../index.html"/>
<link rel="contents" href="http://wiki.openwrt.org/toh/buffalo/wmr-300?do=index" title="Sitemap"/>
<link rel="alternate" type="application/rss+xml" title="Recent changes" href="../../feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Current namespace" href="../../feed.php?mode=list&amp;ns=toh:buffalo"/>
<link rel="alternate" type="text/html" title="Plain HTML" href="http://wiki.openwrt.org/_export/xhtml/toh/buffalo/wmr-300"/>
<link rel="alternate" type="text/plain" title="Wiki Markup" href="http://wiki.openwrt.org/_export/raw/toh/buffalo/wmr-300"/>
<link rel="canonical" href="wmr-300"/>
<link rel="stylesheet" type="text/css" href="../../lib/exe/css.php?t=openwrt&amp;tseed=6f44f363dc87908d905dc56ff3acbfc4"/>
<script type="text/javascript">/*<![CDATA[*/var NS='toh:buffalo';var JSINFO = {"id":"toh:buffalo:wmr-300","namespace":"toh:buffalo"};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="../../lib/exe/js.php?tseed=6f44f363dc87908d905dc56ff3acbfc4"></script>
<script type="text/javascript" charset="utf-8">/*<![CDATA[*/jQuery(function(){
	for ( i=0; i < document.forms.length; i++ ) {
		if (document.forms[i].method == 'post') {
			var myElement = document.createElement('input');
			myElement.setAttribute('type', 'hidden');
			myElement.name = 'bb2_screener_';
			myElement.value = '1432282055 166.182.3.122';
			document.forms[i].appendChild(myElement);
		}
	}
});
/*!]]>*/</script>
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <link rel="shortcut icon" href="../../lib/tpl/openwrt/images/favicon.ico" />
<link rel="apple-touch-icon" href="../../lib/tpl/openwrt/images/apple-touch-icon.png" />
    </head>

<body>
    <!--[if lte IE 7 ]><div id="IE7"><![endif]--><!--[if IE 8 ]><div id="IE8"><![endif]-->
    <div id="dokuwiki__site"><div id="dokuwiki__top" class="site dokuwiki mode_show tpl_openwrt     ">

        
<!-- ********** HEADER ********** -->
<div id="dokuwiki__header"><div class="pad group">

    
    <div class="headings group">
        <ul class="a11y skip">
            <li><a href="wmr-300#dokuwiki__content">skip to content</a></li>
        </ul>

        <h1><a href="../../start"  accesskey="h" title="[H]"><img src="../../lib/tpl/openwrt/images/logo.png" width="386" height="98" alt="" /> <span>OpenWrt Wiki</span></a></h1>
            </div>

    <div class="tools group">
        <!-- USER TOOLS -->
                    <div id="dokuwiki__usertools">
                <h3 class="a11y">User Tools</h3>
                <ul>
                    <li><a href="http://wiki.openwrt.org/toh/buffalo/wmr-300?do=register"  class="action register" rel="nofollow" title="Register">Register</a></li><li><a href="http://wiki.openwrt.org/toh/buffalo/wmr-300?do=login&amp;sectok=382740b13d95f946eed36caa57076b4a"  class="action login" rel="nofollow" title="Login">Login</a></li>                </ul>
            </div>
        
        <!-- SITE TOOLS -->
        <div id="dokuwiki__sitetools">
            <h3 class="a11y">Site Tools</h3>
            <form action="../../start" accept-charset="utf-8" class="search" id="dw__search" method="get" role="search"><div class="no"><input type="hidden" name="do" value="search" /><input type="text" id="qsearch__in" accesskey="f" name="id" class="edit" title="[F]" /><input type="submit" value="Search" class="button" title="Search" /><div id="qsearch__out" class="ajax_qsearch JSpopup"></div></div></form>            <div class="mobileTools">
                <form action="../../doku.php" method="get" accept-charset="utf-8"><div class="no"><input type="hidden" name="id" value="toh:buffalo:wmr-300" /><select name="do" class="edit quickselect" title="Tools"><option value="">Tools</option><optgroup label="Page Tools"><option value="edit">Show pagesource</option><option value="revisions">Old revisions</option><option value="backlink">Backlinks</option></optgroup><optgroup label="Site Tools"><option value="recent">Recent changes</option><option value="media">Media Manager</option><option value="index">Sitemap</option></optgroup><optgroup label="User Tools"><option value="login">Login</option><option value="register">Register</option></optgroup></select><input type="submit" value="&gt;" /></div></form>            </div>
            <ul>
                <li><a href="http://wiki.openwrt.org/toh/buffalo/wmr-300?do=recent"  class="action recent" accesskey="r" rel="nofollow" title="Recent changes [R]">Recent changes</a></li><li><a href="http://wiki.openwrt.org/toh/buffalo/wmr-300?do=media&amp;ns=toh%3Abuffalo"  class="action media" rel="nofollow" title="Media Manager">Media Manager</a></li><li><a href="http://wiki.openwrt.org/toh/buffalo/wmr-300?do=index"  class="action index" accesskey="x" rel="nofollow" title="Sitemap [X]">Sitemap</a></li>            </ul>
        </div>

    </div>

    <!-- BREADCRUMBS -->
            <div class="breadcrumbs">
                            <div class="youarehere"><span class="bchead">You are here: </span><span class="home"><bdi><a href="../../start" class="wikilink1" title="start">OpenWrt Wiki</a></bdi></span> » <bdi><a href="../start" class="wikilink1" title="toh:start">Table of Hardware</a></bdi> » <bdi><a href="start" class="wikilink1" title="toh:buffalo:start">Buffalo</a></bdi> » <bdi><span class="curid"><a href="wmr-300" class="wikilink1" title="toh:buffalo:wmr-300">Buffalo WMR-300</a></span></bdi></div>
                                    <div class="plugin_multilingual">
        <ul>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/cz/toh/buffalo/wmr-300" class="media" title="cz:toh:buffalo:wmr-300"><img src="../../lib/exe/fetch.php?cache=&amp;tok=aff589&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fcz.gif" class="media" title="Čeština (Czech)" alt="Čeština (Czech)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/de/toh/buffalo/wmr-300" class="media" title="de:toh:buffalo:wmr-300"><img src="../../lib/exe/fetch.php?cache=&amp;tok=e24010&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fde.gif" class="media" title="Deutsch (German)" alt="Deutsch (German)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <span class="curid"><a href="wmr-300" class="media" title="toh:buffalo:wmr-300"><img src="../../lib/exe/fetch.php?cache=&amp;tok=2a37ae&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fgb.gif" class="media" title="English" alt="English" /></a></span>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/es/toh/buffalo/wmr-300" class="media" title="es:toh:buffalo:wmr-300"><img src="../../lib/exe/fetch.php?cache=&amp;tok=46c004&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fmx.gif" class="media" title="Español (Spanish, Mexico)" alt="Español (Spanish, Mexico)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/fr/toh/buffalo/wmr-300" class="media" title="fr:toh:buffalo:wmr-300"><img src="../../lib/exe/fetch.php?cache=&amp;tok=a5beba&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Ffr.gif" class="media" title="Français (French)" alt="Français (French)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/hu/toh/buffalo/wmr-300" class="media" title="hu:toh:buffalo:wmr-300"><img src="../../lib/exe/fetch.php?cache=&amp;tok=6b5470&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fhu.gif" class="media" title="Magyar (Hungarian)" alt="Magyar (Hungarian)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/jp/toh/buffalo/wmr-300" class="media" title="jp:toh:buffalo:wmr-300"><img src="../../lib/exe/fetch.php?cache=&amp;tok=f999fc&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fjp.gif" class="media" title="日本語 (Japanese)" alt="日本語 (Japanese)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/pl/toh/buffalo/wmr-300" class="media" title="pl:toh:buffalo:wmr-300"><img src="../../lib/exe/fetch.php?cache=&amp;tok=c805c0&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fpl.gif" class="media" title="Poliski (Polish)" alt="Poliski (Polish)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/pt-br/toh/buffalo/wmr-300" class="media" title="pt-br:toh:buffalo:wmr-300"><img src="../../lib/exe/fetch.php?cache=&amp;tok=13127d&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fbr.gif" class="media" title="Português brasileiro (Portuguese, Brasil)" alt="Português brasileiro (Portuguese, Brasil)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/ru/toh/buffalo/wmr-300" class="media" title="ru:toh:buffalo:wmr-300"><img src="../../lib/exe/fetch.php?cache=&amp;tok=66ab5e&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fru.gif" class="media" title="Русский (Russsian)" alt="Русский (Russsian)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/tr/toh/buffalo/wmr-300" class="media" title="tr:toh:buffalo:wmr-300"><img src="../../lib/exe/fetch.php?cache=&amp;tok=f4beed&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Ftr.gif" class="media" title="Tϋrkçe (Turkish)" alt="Tϋrkçe (Turkish)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/zh-cn/toh/buffalo/wmr-300" class="media" title="zh-cn:toh:buffalo:wmr-300"><img src="../../lib/exe/fetch.php?cache=&amp;tok=93625a&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fzh-cn.gif" class="media" title="官話/官话 (Chinese)" alt="官話/官话 (Chinese)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/zh-tw/toh/buffalo/wmr-300" class="media" title="zh-tw:toh:buffalo:wmr-300"><img src="../../lib/exe/fetch.php?cache=&amp;tok=b56198&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fzh-tw.gif" class="media" title="臺灣華語 (Taiwanese)" alt="臺灣華語 (Taiwanese)" /></a>
              </div>
            </div>
          </li>
        </ul>
      </div>
        </div>
    
    
    <hr class="a11y" />
</div></div><!-- /header -->

        <div class="wrapper group">

            
            <!-- ********** CONTENT ********** -->
            <div id="dokuwiki__content"><div class="pad group">

                <div class="pageId"><span>toh:buffalo:wmr-300</span></div>

                <div class="page group">
                                                            <!-- wikipage start -->
                    <!-- TOC START -->
<div id="dw__toc">
<h3 class="toggle">Table of Contents</h3>
<div>

<ul class="toc">
<li class="level1"><div class="li"><a href="wmr-300#hardware">Hardware</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="wmr-300#overview">Overview</a></div></li>
<li class="level2"><div class="li"><a href="wmr-300#internal_photos">Internal Photos</a></div></li>
</ul>
</li>
<li class="level1"><div class="li"><a href="wmr-300#factory_bootlog">Factory Bootlog</a></div></li>
<li class="level1"><div class="li"><a href="wmr-300#openwrt_bootlog">OpenWrt Bootlog</a></div></li>
<li class="level1"><div class="li"><a href="wmr-300#procedure">Procedure</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="wmr-300#using_serial">Using serial</a></div></li>
<li class="level2"><div class="li"><a href="wmr-300#without_serial_via_tftp_server">Without serial, via tftp server</a></div></li>
</ul>
</li>
<li class="level1"><div class="li"><a href="wmr-300#tags">Tags</a></div></li>
</ul>
</div>
</div>
<!-- TOC END -->

<h1 class="sectionedit1" id="buffalo_wmr-300">Buffalo WMR-300</h1>
<div class="level1">

<p>
AirStation™ N300 Wireless Travel Router <br/>

</p>

<p>
<strong><span style='color:green; '>Supported in Barrier Breaker </span></strong><br/>

<a href="http://downloads.openwrt.org/barrier_breaker/14.07/ramips/mt7620n/openwrt-ramips-mt7620n-wmr-300-squashfs-sysupgrade.bin" class="urlextern" title="http://downloads.openwrt.org/barrier_breaker/14.07/ramips/mt7620n/openwrt-ramips-mt7620n-wmr-300-squashfs-sysupgrade.bin"  rel="nofollow">http://downloads.openwrt.org/barrier_breaker/14.07/ramips/mt7620n/openwrt-ramips-mt7620n-wmr-300-squashfs-sysupgrade.bin</a>
</p>

<p>
OpenWrt Forum Link : <br/>

<a href="https://forum.openwrt.org/viewtopic.php?id=55296" class="urlextern" title="https://forum.openwrt.org/viewtopic.php?id=55296"  rel="nofollow">https://forum.openwrt.org/viewtopic.php?id=55296</a>
</p>

<p>
Manufacturer&#039;s site: <br/>

<a href="http://www.buffalotech.com/products/wireless/single-band-routers/airstation-n300-wireless-travel-router" class="urlextern" title="http://www.buffalotech.com/products/wireless/single-band-routers/airstation-n300-wireless-travel-router"  rel="nofollow">http://www.buffalotech.com/products/wireless/single-band-routers/airstation-n300-wireless-travel-router</a>
</p>

</div>

<h2 class="sectionedit2" id="hardware">Hardware</h2>
<div class="level2">

</div>

<h3 class="sectionedit3" id="overview">Overview</h3>
<div class="level3">
<div class="table sectionedit4"><table class="inline">
	<tr class="row0">
		<td class="col0 leftalign"> <strong><a href="http://en.wikipedia.org/wiki/Instruction set" class="interwiki iw_wp" title="http://en.wikipedia.org/wiki/Instruction set">Architecture</a>:</strong>    </td><td class="col1"> MIPS </td>
	</tr>
	<tr class="row1">
		<td class="col0 leftalign"> <strong>Vendor:</strong>          </td><td class="col1"> MediaTek (Ralink) </td>
	</tr>
	<tr class="row2">
		<td class="col0 leftalign"> <strong><a href="../../doc/techref/bootloader.1" class="wikilink1" title="doc:techref:bootloader">Bootloader</a>:</strong>     </td><td class="col1">U-Boot 1.1.3</td>
	</tr>
	<tr class="row3">
		<td class="col0 leftalign"> <strong><a href="../../doc/hardware/soc.1" class="wikilink1" title="doc:hardware:soc">System-On-Chip</a>:</strong>  </td><td class="col1"> Ralink MT7620N ver:2 eco:3</td>
	</tr>
	<tr class="row4">
		<td class="col0 leftalign"> <strong><a href="../../doc/hardware/cpu" class="wikilink1" title="doc:hardware:cpu">CPU</a></strong>        </td><td class="col1"> MIPS 24KEc V5.0 </td>
	</tr>
	<tr class="row5">
		<td class="col0 leftalign"> <strong>CPU Speed</strong>     </td><td class="col1"> 580 <abbr title="Megahertz">MHz</abbr> </td>
	</tr>
	<tr class="row6">
		<td class="col0 leftalign"> <strong>Flash:</strong>        </td><td class="col1"> 8 <abbr title="Megabyte">MB</abbr> Macronix MX25L6406EM2I-12G</td>
	</tr>
	<tr class="row7">
		<td class="col0 leftalign"> <strong>RAM:</strong>          </td><td class="col1"> 64 <abbr title="Megabyte">MB</abbr> Hynix H5PS5162GFR-S6C </td>
	</tr>
	<tr class="row8">
		<td class="col0 leftalign"> <strong>Wireless:</strong>     </td><td class="col1"> SoC </td>
	</tr>
	<tr class="row9">
		<td class="col0 leftalign"> <strong>Ethernet:</strong>     </td><td class="col1"> 1 </td>
	</tr>
</table></div>

</div>

<h3 class="sectionedit5" id="internal_photos">Internal Photos</h3>
<div class="level3">

<p>
<a href="http://wiki.openwrt.org/_detail/media/buffalo/wmr-300-1.jpg?id=toh%3Abuffalo%3Awmr-300" class="media" title="media:buffalo:wmr-300-1.jpg"><img src="http://wiki.openwrt.org/_media/media/buffalo/wmr-300-1.jpg" class="media" alt="" /></a>
</p>

<p>
<a href="http://wiki.openwrt.org/_detail/media/buffalo/wmr300-0.jpg?id=toh%3Abuffalo%3Awmr-300" class="media" title="media:buffalo:wmr300-0.jpg"><img src="http://wiki.openwrt.org/_media/media/buffalo/wmr300-0.jpg" class="media" alt="" /></a>
</p>

</div>

<h2 class="sectionedit6" id="factory_bootlog">Factory Bootlog</h2>
<div class="level2">

<p style="padding: 10px;border:1px solid grey;height:200px;font:10px/14px Georgia, Garamond, Serif;overflow:Auto;background-color:#FFFFFF">
<code>
U-Boot 1.1.3 (Mar 20 2013 - 17:45:05)

Board: Ralink APSoC DRAM:  64 MB
relocate_code Pointer at: 83fb4000
enable ephy clock...done. rf reg 29 = 5
SSC disabled.
spi_wait_nsec: 29 
spi device id: c2 20 17 c2 20 (2017c220)
find flash: MX25L6405D
raspi_read: from:30000 len:1000 
raspi_read: from:30000 len:1000 
*** Check if data is correct or not...
*** Data is correct.
============================================ 
Ralink UBoot Version: 4.1.1.0
Buffalo UBoot Version: 3.00
-------------------------------------------- 
ASIC 7620_MP (Port5<->None)
DRAM component: 512 Mbits DDR, width 16
DRAM bus: 16 bit
Total memory: 64 MBytes
Flash component: SPI Flash
Date:Mar 20 2013  Time:17:45:05
============================================ 
icache: sets:512, ways:4, linesz:32 ,total:65536
dcache: sets:256, ways:4, linesz:32 ,total:32768 

 ##### The CPU freq = 580 MHZ #### 
 estimate memory size =64 Mbytes

Please choose the operation: 
   1: Load system code to SDRAM via TFTP. 
   2: Load system code then write to Flash via TFTP. 
   3: Boot system code via Flash (default).
   4: Entr boot command line interface.
   7: Load Boot Loader code then write to Flash via Serial. 
   9: Load Boot Loader code then write to Flash via TFTP. 
 0 
aossgpio=[4]
   
3: System Boot system code via Flash.
raspi_read: from:30000 len:10000 
Erasing SPI Flash...
raspi_erase: offs:30000 len:10000
.
Writing to SPI Flash...
raspi_write: to:30000 len:10000 
.
done
## Booting image at bc050000 ...
raspi_read: from:50000 len:40 
   Image Name:   Linux Kernel Image
   Image Type:   MIPS Linux Kernel Image (lzma compressed)
   Data Size:    3838138 Bytes =  3.7 MB
   Load Address: 80000000
   Entry Point:  8000c310
raspi_read: from:50040 len:3a90ba 
   Verifying Checksum ... OK
   Uncompressing Kernel Image ... OK
No initrd
## Transferring control to Linux (at address 8000c310) ...
## Giving linux memsize in MB, 64

Starting kernel ...


LINUX started...

 THIS IS ASIC
Linux version 2.6.36 (root@SWD1-CVS3) (gcc version 3.4.2) #23 Tue May 7 19:02:01 CST 2013

 The CPU feqenuce set to 580 MHz
 PCIE: bypass PCIe DLL.
 PCIE: Elastic buffer control: Addr:0x68 -> 0xB4
 disable all power about PCIe
 PCIE: PLL power down for MT7620N
CPU revision is: 00019650 (MIPS 24Kc)
Determined physical RAM map:
 memory: 04000000 @ 00000000 (usable)
Initrd not found or empty - disabling initrd
Zone PFN ranges:
  Normal   0x00000000 -> 0x00004000
Movable zone start PFN for each node
early_node_map[1] active PFN ranges
    0: 0x00000000 -> 0x00004000
Built 1 zonelists in Zone order, mobility grouping on.  Total pages: 16256
Kernel command line: console=ttyS1,57600n8 root=/dev/ram0 console=ttyS0
PID hash table entries: 256 (order: -2, 1024 bytes)
Dentry cache hash table entries: 8192 (order: 3, 32768 bytes)
Inode-cache hash table entries: 4096 (order: 2, 16384 bytes)
Primary instruction cache 64kB, VIPT, 4-way, linesize 32 bytes.
Primary data cache 32kB, 4-way, PIPT, no aliases, linesize 32 bytes
Writing ErrCtl register=0005c04f
Readback ErrCtl register=0005c04f
Memory: 57600k/65536k available (4064k kernel code, 7936k reserved, 700k data, 2368k init, 0k highmem)
NR_IRQS:128
console [ttyS1] enabled
Calibrating delay loop... 386.04 BogoMIPS (lpj=772096)
pid_max: default: 32768 minimum: 301
Mount-cache hash table entries: 512
NET: Registered protocol family 16
RALINK_GPIOMODE = 1ab11d
RALINK_GPIOMODE = 18b11d
PPLL_CFG1=0x4010000
MT7620 PPLL unlock
bio: create slab <bio-0> at 0
vgaarb: loaded
SCSI subsystem initialized
Switching to clocksource MIPS
NET: Registered protocol family 2
IP route cache hash table entries: 1024 (order: 0, 4096 bytes)
TCP established hash table entries: 2048 (order: 2, 16384 bytes)
TCP bind hash table entries: 2048 (order: 1, 8192 bytes)
TCP: Hash tables configured (established 2048 bind 2048)
TCP reno registered
UDP hash table entries: 256 (order: 0, 4096 bytes)
UDP-Lite hash table entries: 256 (order: 0, 4096 bytes)
NET: Registered protocol family 1
squashfs: version 4.0 (2009/01/31) Phillip Lougher
JFFS2 version 2.2 (NAND) (SUMMARY) (ZLIB) (RTIME) (CMODE_PRIORITY) (c) 2001-2006 Red Hat, Inc.
fuse init (API version 7.15)
msgmni has been set to 112
Block layer SCSI generic (bsg) driver version 0.4 loaded (major 254)
io scheduler noop registered (default)
HDLC line discipline maxframe=4096
N_HDLC line discipline registered.
#####GPIOMODE = 18911d#####
Ralink gpio driver initialized
Serial: 8250/16550 driver, 2 ports, IRQ sharing disabled
serial8250: ttyS0 at MMIO 0x10000500 (irq = 37) is a 16550A
serial8250: ttyS1 at MMIO 0x10000c00 (irq = 12) is a 16550A
brd: module loaded
flash0: started
deice id : c2 20 17 c2 20 (2017c220)
MX25L6405D(c2 2017c220) (8192 Kbytes)
mtd .name = raspi, .size = 0x00800000 (0M) .erasesize = 0x00000008 (0K) .numeraseregions = 65536
Creating 5 MTD partitions on "raspi":
0x000000000000-0x000000030000 : "Bootloader"
0x000000030000-0x000000040000 : "Config"
0x000000040000-0x000000050000 : "Factory"
0x000000050000-0x000000600000 : "Kernel"
0x000000600000-0x000000650000 : "User_CFG"
rdm_major = 253
SMACCR1 -- : 0x0000000c
SMACCR0 -- : 0x43762077
Ralink APSoC Ethernet Driver Initilization. v3.0  256 rx/tx descriptors allocated, mtu = 1500!
SMACCR1 -- : 0x0000000c
SMACCR0 -- : 0x43762077
PROC INIT OK!
PPP generic driver version 2.4.2
PPP BSD Compression module registered
NET: Registered protocol family 24
Ralink APSoC Hardware Watchdog Timer
Netfilter messages via NETLINK v0.30.
nf_conntrack version 0.5.0 (900 buckets, 3600 max)
ctnetlink v0.93: registering with nfnetlink.
IPVS: Registered protocols ()
IPVS: Connection hash table configured (size=4096, memory=32Kbytes)
IPVS: ipvs loaded.
ip_tables: (C) 2000-2006 Netfilter Core Team, Type=Restricted Cone
TCP cubic registered
NET: Registered protocol family 17
create_proc_read_write_entry: fail
L2TP core driver, V2.0
PPPoL2TP kernel driver, V2.0
802.1Q VLAN Support v1.8 Ben Greear <greearb@candelatech.com>
All bugs added by David S. Miller <davem@redhat.com>
Freeing unused kernel memory: 2368k freed
init started: BusyBox v1.12.1 (201Algorithmics/MIPS FPU Emulator v1.5
3-05-03 00:15:43 CST)
starting pid 21, tty '': '/etc_ro/rcS'
led=42, on=1, off=1, blinks,=4000, reset=1, time=4000
devpts: called with bogus options
mount: mounting none on /proc/bus/usb failed: No such file or directory
Welcome to
    _______  _______  ___     __  ____   _  _   ___
    |  ___  \|   __  ||   |   |__||    \ | || | /  /
    | |___| ||  |__| ||   |__  __ |     \| || |/  /
    |   _   /|   _   ||      ||  || |\     ||     \
    |__| \__\|__| |__||______||__||_| \____||_|\___\

   	             =System Architecture Department=

[check_jffs]80 : JFFS_OK
Set: phy[0].reg[0] = 3100
Set: phy[1].reg[0] = 3100
Set: phy[2].reg[0] = 3100
Set: phy[3].reg[0] = 3100
Set: phy[4].reg[0] = 3100
nvram_init: INFO=>nvram MAC initialized successfully!
==>shm_init()!!
check_shm_hash: Check shm hash value
nvram_init: INFO=>nvram conf initialized successfully!
nvram_init: INFO=> RAM CONF successful created!
nvram_init: INFO=> RC.CONF successful created!
---------------- Get WLAN MAC b0:c7:45:9a:72:54---------------
switch reg write offset=94, value=1000
switch reg write offset=2004, value=ff0003
switch reg write offset=2104, value=ff0003
switch reg write offset=2204, value=ff0003
switch reg write offset=2304, value=ff0003
switch reg write offset=2404, value=ff0003
switch reg write offset=2504, value=ff0003
switch reg write offset=2010, value=810000c0
switch reg write offset=2110, value=810000c0
switch reg write offset=2210, value=810000c0
switch reg write offset=2310, value=810000c0
switch reg write offset=2410, value=810000c0
switch reg write offset=2510, value=810000c0
switch reg write offset=2610, value=81000000
switch reg write offset=2710, value=81000000
switch reg write offset=2604, value=20ff0003
switch reg write offset=2704, value=20ff0003
Special Tag Disabled
switch reg write offset=2610, value=81000000
switch reg writRaeth v3.0 (e Taskletof)
fset=
phy_tx_ring = 0x02ec9000, tx_ring = 0xa2ec9000

phy_rx_ring0 = 0x02eca000, rx_ring0 = 0xa2eca000
SMACCR1 -- : 0x0000b0c7
SMACCR0 -- : 0x459a7254
20ESW: Link Status Changed - Port4 Link UP
14CDMA_CSG_CFG = 81000000
, GDMA1_FWD_CFG = 20710000
value=10001
switch reg write offset=2114, value=10001
switch reg write offset=2214, value=10001
switch reg write offset=2314, value=10001
switch reg write offset=2414, value=10002
switch reg write offset=2514, value=10001
REG_ESW_WT_MAC_ATC is 0x7ff0002
done.
device vlan0001 entered promiscuous mode
device eth2 entered promiscuous mode
input_access=[3]
echo 3 > /proc/lan_wlan_access_controller
br0: port 1(vlan0001) entering learning state
br0: port 1(vlan0001) entering learning state
led=44, on=1, off=1, blinks,=4000, reset=1, time=4000
getbootloaderenv : bootloader_ver =3.00
br0: port 1(vlan0001) entering forwarding state
Fri Jan  1 00:00:00 GMT 2010
[Enter Test] in wlan_led_ctrl.c main()
.libupnp: using UDP SSDP_PORT = 1900
brctl setwlanforward br0 15
rmmod: ipv6passthru: No such file or directory
rmmod: ipv6passthru: No such file or directory
/usr/shell/dnsmasq.sh stop ok
dnsmasq: [truncated] m
/usr/shell/dnsmasq.sh start ok
/usr/shell/udhcpd.sh config ok
/usr/shell/udhcpd.sh start ok

***** g_wl_interface = ra0 ******

MAX_NUM_SESSIONS : 5; NUM_SEES: 64 
route: ioctl 0x890c failed: No such process
/usr/shell/staticip.sh stop ok
route: ioctl 0x890c failed: No such process
/usr/shell/udhcpc.sh stop ok
killall: internet_chk: no process killed
====Wan Check: Enter CHECK_WAN_LINK state====
====Wan Check: WAN_LINK is online!====
====Wan Check: Enter CHECK_DHCP_SERVER_WAN state====
/usr/shell/udhcpc.sh start ok
====Wan Check: CHECK_DHCP_SERVER_WAN is Fail!====
route: ioctl 0x890c failed: No such process
/usr/shell/udhcpc.sh stop ok
====Wan Check: Enter CHECK_DHCP_SERVER_LAN state====
/usr/shell/udhcpc.sh lan_dhcpc_start ok
====Wan Check: CHECK_DHCP_SERVER_LAN is Fail!====
/usr/shell/udhcpc.sh lan_dhcpc_stop ok
route: ioctl 0x890c failed: No such process
/usr/shell/staticip.sh stop ok
route: ioctl 0x890c failed: No such process
/usr/shell/udhcpc.sh stop ok
killall: internet_chk: no process killed
/usr/shell/udhcpc.sh start ok
starting pid 4909, tty '/dev/ttyS1': '/bin/sh'


BusyBox v1.12.1 (2013-05-03 00:15:43 CST) built-in shell (ash)
Enter 'help' for a list of built-in commands.

</code>
</p>

</div>

<h2 class="sectionedit7" id="openwrt_bootlog">OpenWrt Bootlog</h2>
<div class="level2">

<p style="padding: 10px;border:1px solid grey;height:200px;font:10px/14px Georgia, Garamond, Serif;overflow:Auto;background-color:#FFFFFF">
<code>
U-Boot 1.1.3 (Mar 20 2013 - 17:45:05)

Board: Ralink APSoC DRAM:  64 MB
relocate_code Pointer at: 83fb4000
enable ephy clock...done. rf reg 29 = 5
SSC disabled.
spi_wait_nsec: 29 
spi device id: c2 20 17 c2 20 (2017c220)
find flash: MX25L6405D
raspi_read: from:30000 len:1000 
raspi_read: from:30000 len:1000 
*** Check if data is correct or not...
*** Data is correct.
============================================ 
Ralink UBoot Version: 4.1.1.0
Buffalo UBoot Version: 3.00
-------------------------------------------- 
ASIC 7620_MP (Port5<->None)
DRAM component: 512 Mbits DDR, width 16
DRAM bus: 16 bit
Total memory: 64 MBytes
Flash component: SPI Flash
Date:Mar 20 2013  Time:17:45:05
============================================ 
icache: sets:512, ways:4, linesz:32 ,total:65536
dcache: sets:256, ways:4, linesz:32 ,total:32768 

 ##### The CPU freq = 580 MHZ #### 
 estimate memory size =64 Mbytes

Please choose the operation: 
   1: Load system code to SDRAM via TFTP. 
   2: Load system code then write to Flash via TFTP. 
   3: Boot system code via Flash (default).
   4: Entr boot command line interface.
   7: Load Boot Loader code then write to Flash via Serial. 
   9: Load Boot Loader code then write to Flash via TFTP. 
 0 
aossgpio=[4]
   
3: System Boot system code via Flash.
raspi_read: from:30000 len:10000 
Erasing SPI Flash...
raspi_erase: offs:30000 len:10000
.
Writing to SPI Flash...
raspi_write: to:30000 len:10000 
.
done
## Booting image at bc050000 ...
raspi_read: from:50000 len:40 
   Image Name:   MIPS OpenWrt Linux-3.10.44
   Image Type:   MIPS Linux Kernel Image (lzma compressed)
   Data Size:    1014738 Bytes = 991 kB
   Load Address: 80000000
   Entry Point:  80000000
raspi_read: from:50040 len:f7bd2 
   Verifying Checksum ... OK
   Uncompressing Kernel Image ... OK
No initrd
## Transferring control to Linux (at address 80000000) ...
## Giving linux memsize in MB, 64

Starting kernel ...

[    0.000000] Linux version 3.10.44 (brown@brown) (gcc version 4.8.3 (OpenWrt/Linaro GCC 4.8-2014.04 r41672) ) #1 Wed Jul 16 14:43:46 CDT 2014
[    0.000000] Board has DDR2
[    0.000000] Analog PMU set to hw control
[    0.000000] Digital PMU set to hw control
[    0.000000] SoC Type: Ralink MT7620N ver:2 eco:3
[    0.000000] bootconsole [early0] enabled
[    0.000000] CPU revision is: 00019650 (MIPS 24KEc)
[    0.000000] MIPS: machine is Buffalo WMR-300
[    0.000000] Determined physical RAM map:
[    0.000000]  memory: 04000000 @ 00000000 (usable)
[    0.000000] Initrd not found or empty - disabling initrd
[    0.000000] Zone ranges:
[    0.000000]   Normal   [mem 0x00000000-0x03ffffff]
[    0.000000] Movable zone start for each node
[    0.000000] Early memory node ranges
[    0.000000]   node   0: [mem 0x00000000-0x03ffffff]
[    0.000000] Primary instruction cache 64kB, VIPT, 4-way, linesize 32 bytes.
[    0.000000] Primary data cache 32kB, 4-way, PIPT, no aliases, linesize 32 bytes
[    0.000000] Built 1 zonelists in Zone order, mobility grouping on.  Total pages: 16256
[    0.000000] Kernel command line: console=ttyS0,57600 rootfstype=squashfs,jffs2
[    0.000000] PID hash table entries: 256 (order: -2, 1024 bytes)
[    0.000000] Dentry cache hash table entries: 8192 (order: 3, 32768 bytes)
[    0.000000] Inode-cache hash table entries: 4096 (order: 2, 16384 bytes)
[    0.000000] Writing ErrCtl register=0004e1cf
[    0.000000] Readback ErrCtl register=0004e1cf
[    0.000000] Memory: 61712k/65536k available (2279k kernel code, 3824k reserved, 550k data, 176k init, 0k highmem)
[    0.000000] SLUB: HWalign=32, Order=0-3, MinObjects=0, CPUs=1, Nodes=1
[    0.000000] NR_IRQS:256
[    0.000000] CPU Clock: 580MHz
[    0.000000] Calibrating delay loop... 385.84 BogoMIPS (lpj=1929216)
[    0.060000] pid_max: default: 32768 minimum: 301
[    0.060000] Mount-cache hash table entries: 512
[    0.070000] pinctrl core: initialized pinctrl subsystem
[    0.080000] NET: Registered protocol family 16
[    0.100000] bio: create slab <bio-0> at 0
[    0.110000] rt2880_gpio 10000600.gpio: registering 24 gpios
[    0.120000] rt2880_gpio 10000600.gpio: registering 24 irq handlers
[    0.130000] rt2880_gpio 10000660.gpio: registering 32 gpios
[    0.140000] rt2880_gpio 10000660.gpio: registering 32 irq handlers
[    0.150000] Switching to clocksource MIPS
[    0.160000] NET: Registered protocol family 2
[    0.170000] TCP established hash table entries: 512 (order: 0, 4096 bytes)
[    0.180000] TCP bind hash table entries: 512 (order: -1, 2048 bytes)
[    0.190000] TCP: Hash tables configured (established 512 bind 512)
[    0.210000] TCP: reno registered
[    0.210000] UDP hash table entries: 256 (order: 0, 4096 bytes)
[    0.220000] UDP-Lite hash table entries: 256 (order: 0, 4096 bytes)
[    0.240000] NET: Registered protocol family 1
[    0.250000] rt-timer 10000100.timer: maximum frequncy is 2441Hz
[    0.270000] squashfs: version 4.0 (2009/01/31) Phillip Lougher
[    0.280000] jffs2: version 2.2 (NAND) (SUMMARY) (LZMA) (RTIME) (CMODE_PRIORITY) (c) 2001-2006 Red Hat, Inc.
[    0.310000] msgmni has been set to 120
[    0.310000] io scheduler noop registered
[    0.320000] io scheduler deadline registered (default)
[    0.330000] Serial: 8250/16550 driver, 2 ports, IRQ sharing disabled
[    0.350000] 10000c00.uartlite: ttyS0 at MMIO 0x10000c00 (irq = 20) is a 16550A
[    0.360000] console [ttyS0] enabled, bootconsole disabled
[    0.360000] console [ttyS0] enabled, bootconsole disabled
[    0.390000] m25p80 spi32766.0: mx25l6405d (8192 Kbytes)
[    0.400000] 4 ofpart partitions found on MTD device spi32766.0
[    0.410000] Creating 4 MTD partitions on "spi32766.0":
[    0.420000] 0x000000000000-0x000000030000 : "u-boot"
[    0.430000] 0x000000030000-0x000000040000 : "u-boot-env"
[    0.440000] 0x000000040000-0x000000050000 : "factory"
[    0.460000] 0x000000050000-0x000000800000 : "firmware"
[    0.470000] 0x000000147c12-0x000000800000 : "rootfs"
[    0.480000] mtd: partition "rootfs" must either start or end on erase block boundary or be smaller than an erase block -- forcing read-only
[    0.500000] mtd: device 4 (rootfs) set to be root filesystem
[    0.520000] mtd: partition "rootfs_data" created automatically, ofs=0x370000, len=0x490000
[    0.530000] 0x000000370000-0x000000800000 : "rootfs_data"
[    0.550000] ralink_soc_eth 10100000.ethernet: loaded mt7530 driver
[    0.560000] eth0: done loading
[    0.570000] rt3xxx-usbphy ubsphy.3: loaded
[    0.580000] rt2880_wdt 10000120.watchdog: Initialized
[    0.590000] TCP: cubic registered
[    0.590000] NET: Registered protocol family 17
[    0.600000] 8021q: 802.1Q VLAN Support v1.8
[    0.620000] VFS: Mounted root (squashfs filesystem) readonly on device 31:4.
[    0.640000] Freeing unused kernel memory: 176K (802c4000 - 802f0000)
procd: Console is alive
procd: - watchdog -
[    3.860000] leds-gpio gpio-leds.4: pins are not configured from the driver
procd: - preinit -
Press the [f] key and hit [enter] to enter failsafe mode
Press the [1], [2], [3] or [4] key and hit [enter] to select the debug level
jffs2 is ready
jffs2 is ready
[    7.590000] jffs2: notice: (260) jffs2_build_xattr_subsystem: complete building xattr subsystem, 1 of xdatum (0 unchecked, 0 orphan) and 9 of xref (0 dead, 0 orphan) found.
switching to overlay
procd: - early -
procd: - watchdog -
procd: - ubus -
procd: - init -
Please press Enter to activate this console.
[    8.980000] NET: Registered protocol family 10
[    9.000000] nf_conntrack version 0.5.0 (967 buckets, 3868 max)
[    9.020000] ip6_tables: (C) 2000-2006 Netfilter Core Team
[    9.040000] Loading modules backported from Linux version master-2014-05-22-0-gf2032ea
[    9.060000] Backport generated by backports.git backports-20140320-37-g5c33da0
[    9.080000] ip_tables: (C) 2000-2006 Netfilter Core Team
[    9.120000] xt_time: kernel timezone is -0000
[    9.160000] cfg80211: Calling CRDA to update world regulatory domain
[    9.170000] cfg80211: World regulatory domain updated:
[    9.180000] cfg80211:  DFS Master region: unset
[    9.190000] cfg80211:   (start_freq - end_freq @ bandwidth), (max_antenna_gain, max_eirp), (dfs_cac_time)
[    9.210000] cfg80211:   (2402000 KHz - 2472000 KHz @ 40000 KHz), (N/A, 2000 mBm), (N/A)
[    9.220000] cfg80211:   (2457000 KHz - 2482000 KHz @ 40000 KHz), (N/A, 2000 mBm), (N/A)
[    9.240000] cfg80211:   (2474000 KHz - 2494000 KHz @ 20000 KHz), (N/A, 2000 mBm), (N/A)
[    9.260000] cfg80211:   (5170000 KHz - 5250000 KHz @ 160000 KHz), (N/A, 2000 mBm), (N/A)
[    9.270000] cfg80211:   (5250000 KHz - 5330000 KHz @ 160000 KHz), (N/A, 2000 mBm), (0 s)
[    9.290000] cfg80211:   (5490000 KHz - 5730000 KHz @ 160000 KHz), (N/A, 2000 mBm), (0 s)
[    9.300000] cfg80211:   (5735000 KHz - 5835000 KHz @ 80000 KHz), (N/A, 2000 mBm), (N/A)
[    9.320000] cfg80211:   (57240000 KHz - 63720000 KHz @ 2160000 KHz), (N/A, 0 mBm), (N/A)
[    9.380000] PPP generic driver version 2.4.2
[    9.390000] NET: Registered protocol family 24
[    9.430000] rt2800_wmac 10180000.wmac: failed to load eeprom property
[    9.440000] ieee80211 phy0: rt2x00lib_request_eeprom_file: Info - Loading EEPROM data from 'soc_wmac.eeprom'.
[    9.460000] ieee80211 phy0: rt2x00_set_rt: Info - RT chipset 5390, rev 0500 detected
[    9.480000] ieee80211 phy0: rt2x00_set_rf: Info - RF chipset 7620 detected
procd: - init complete -
[   16.060000] device eth0.1 entered promiscuous mode
[   16.070000] device eth0 entered promiscuous mode
[   16.080000] br-lan: port 1(eth0.1) entered forwarding state
[   16.090000] br-lan: port 1(eth0.1) entered forwarding state
[   16.640000] cfg80211: Calling CRDA for country: JP
[   16.650000] cfg80211: Regulatory domain changed to country: JP
[   16.660000] cfg80211:  DFS Master region: JP
[   16.670000] cfg80211:   (start_freq - end_freq @ bandwidth), (max_antenna_gain, max_eirp), (dfs_cac_time)
[   16.680000] cfg80211:   (2402000 KHz - 2482000 KHz @ 40000 KHz), (N/A, 2000 mBm), (N/A)
[   16.700000] cfg80211:   (2474000 KHz - 2494000 KHz @ 20000 KHz), (N/A, 2000 mBm), (N/A)
[   16.720000] cfg80211:   (4910000 KHz - 4990000 KHz @ 40000 KHz), (N/A, 2300 mBm), (N/A)
[   16.730000] cfg80211:   (5030000 KHz - 5090000 KHz @ 40000 KHz), (N/A, 2300 mBm), (N/A)
[   16.750000] cfg80211:   (5170000 KHz - 5250000 KHz @ 80000 KHz), (N/A, 2000 mBm), (N/A)
[   16.760000] cfg80211:   (5250000 KHz - 5330000 KHz @ 80000 KHz), (N/A, 2000 mBm), (0 s)
[   16.780000] cfg80211:   (5490000 KHz - 5710000 KHz @ 160000 KHz), (N/A, 2300 mBm), (0 s)
[   18.090000] br-lan: port 1(eth0.1) entered forwarding state
[   18.260000] ------------[ cut here ]------------
[   18.270000] WARNING: at /data/openwrt/build_dir/target-mipsel_24kec+dsp_uClibc-0.9.33.2/linux-ramips_mt7620n/compat-wireless-2014-05-22/drivers/net/wireless/rt2x00/rt2800lib.c:408 rt2800_vco_calibration+0x2d8/0x3d4 [rt2800lib]()
[   18.310000] phy0: invalid EEPROM word 208
[   18.320000] Modules linked in: rt2800soc rt2800mmio rt2800lib pppoe ppp_async iptable_nat rt2x00soc rt2x00mmio rt2x00lib pppox ppp_generic nf_nat_ipv4 nf_conntrack_ipv4 mac80211 ipt_MASQUERADE cfg80211 xt_time xt_tcpudp xt_state xt_nat xt_multiport xt_mark xt_mac xt_limit xt_conntrack xt_comment xt_TCPMSS xt_REDIRECT xt_LOG xt_CT slhc nf_nat_irc nf_nat_ftp nf_nat nf_defrag_ipv4 nf_conntrack_irc nf_conntrack_ftp iptable_raw iptable_mangle iptable_filter ipt_REJECT ip_tables crc_itu_t crc_ccitt compat ledtrig_heartbeat ledtrig_gpio ip6t_REJECT ip6table_raw ip6table_mangle ip6table_filter ip6_tables x_tables nf_conntrack_ipv6 nf_conntrack nf_defrag_ipv6 ipv6 eeprom_93cx6 arc4 crypto_blkcipher leds_gpio gpio_button_hotplug
[   18.440000] CPU: 0 PID: 843 Comm: hostapd Not tainted 3.10.44 #1
[   18.460000] Stack : 00000000 00000000 00000000 00000000 802f2eea 00000034 830f6b88 8327dca8
	  80265984 802af1fb 0000034b 802f2694 830f6b88 8327dca8 00000001 00000000
	  00000001 8001e0ac 00000003 8001bb18 83133bd8 8327dca8 80267210 8327db14
	  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
	  00000000 00000000 00000000 00000000 00000000 00000000 00000000 8327daa0
	  ...
[   18.530000] Call Trace:
[   18.530000] [<80011254>] show_stack+0x48/0x70
[   18.540000] [<8001bc14>] warn_slowpath_common+0x78/0xa8
[   18.550000] [<8001bc70>] warn_slowpath_fmt+0x2c/0x38
[   18.560000] [<83122728>] rt2800_vco_calibration+0x2d8/0x3d4 [rt2800lib]
[   18.570000] [<831227fc>] rt2800_vco_calibration+0x3ac/0x3d4 [rt2800lib]
[   18.590000] [<8312a5cc>] rt2800_reset_tuner+0x7ac/0xb24 [rt2800lib]
[   18.600000] 
[   18.600000] ---[ end trace 332d69e446d66f32 ]---
[   18.630000] IPv6: ADDRCONF(NETDEV_UP): wlan0: link is not ready
[   18.640000] device wlan0 entered promiscuous mode
[   18.650000] br-lan: port 2(wlan0) entered forwarding state
[   18.660000] br-lan: port 2(wlan0) entered forwarding state
[   18.710000] IPv6: ADDRCONF(NETDEV_CHANGE): wlan0: link becomes ready
[   20.660000] br-lan: port 2(wlan0) entered forwarding state



BusyBox v1.22.1 (2014-07-16 14:09:06 CDT) built-in shell (ash)
Enter 'help' for a list of built-in commands.

  _______                     ________        __
 |       |.-----.-----.-----.|  |  |  |.----.|  |_
 |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|
 |_______||   __|_____|__|__||________||__|  |____|
          |__| W I R E L E S S   F R E E D O M
 -----------------------------------------------------
 BARRIER BREAKER (Bleeding Edge, r41672)
 -----------------------------------------------------
  * 1/2 oz Galliano         Pour all ingredients into
  * 4 oz cold Coffee        an irish coffee mug filled
  * 1 1/2 oz Dark Rum       with crushed ice. Stir.
  * 2 tsp. Creme de Cacao
 -----------------------------------------------------
root@OpenWrt:/#

</code>
</p>

</div>

<h2 class="sectionedit8" id="procedure">Procedure</h2>
<div class="level2">

<p>There is (at least) two ways to reach the flashing engine: <b>using serial</b>, and <b>via tftp</b>

</div>

<h3 class="sectionedit9" id="using_serial">Using serial</h3>
<div class="level3">

The following is necessary<ul>
<li>A 4-pin connector, like <img src="http://www.moates.net/images/Header%20-%204%20Pin%20-%20Unlatched.jpg"></li>
<li>A USB to serial interface (the FTDI modules are excellent)</li>
<li>A cable between the 4-pin connector and the FTDI module</li>
<li>A soldering iron and a bit of solder</li>
</ul>
<p>
No other tool is needed. Of course if your PC has a serial connector, you might use that instead of the FTDI.<br>
<br>
Opposite network connector (actually top of the box) is a hollow, which is thinner near the AOSS button.
This is where the top of the USB cable sits.
Try to depart the two sides of that thinner hollow - the top (2-3 millimeters) of the plastic (AOSS button side) should open.
Gently, keep pulling. <br>
<br>
In the bottom picture above, bottom-right side of the board is the 4 PINs serial connector (from square one: VCC, Rx, Tx, Gnd).
VCC does not need to be connected. Connect board Rx to PC Tx, Tx to PC Rx, and the G(rou)nd.<br>
<br>
<i>Parameters</i>: 57600 bauds, 8 bits, No parity, 1 stop bit.<br>
<br>
Open a serial terminal, set the parameters and switch on the router, you should see the bootlog as shown in the above page.
(It comes pretty quickly, ~2 seconds, so if you don't see anything, check your connections).<br>
</p>
<div style="padding:10px;margin:10px;border:3px solid #eee;background-color:#ccc;width:50%">
<code>U-Boot 1.1.3 (Mar 20 2013 - 17:45:05)

Board: Ralink APSoC DRAM:  64 MB
relocate_code Pointer at: 83fb4000
...
icache: sets:512, ways:4, linesz:32 ,total:65536
dcache: sets:256, ways:4, linesz:32 ,total:32768 

 ##### The CPU freq = 580 MHZ #### 
 estimate memory size =64 Mbytes

Please choose the operation: 
   1: Load system code to SDRAM via TFTP. 
   2: Load system code then write to Flash via TFTP. 
   3: Boot system code via Flash (default).
   4: Entr boot command line interface.
   7: Load Boot Loader code then write to Flash via Serial. 
   9: Load Boot Loader code then write to Flash via TFTP. 
 </code></div>
<p>To flash a firmware, either a Kermit-like tool to write it via serial is necessary (option 7).
Or  a tftp server  on the PC connected with the network cable (option 2).<br>
<br>
Default tftp settings (can be changed) are<ul>
<li> router is 192.168.<b>11</b>.1</li>
<li> PC is 192.168.<b>11</b>.168</li>
<li> filename: 'firmware_WMR-300.ram' (but it'll ask)</li>
</ul>
The pc must be set with that static IP, for the interface connected to the router. 
</p>

</div>

<h3 class="sectionedit10" id="without_serial_via_tftp_server">Without serial, via tftp server</h3>
<div class="level3">
<p>
No need of a serial connection - however the process is done blindly... <br><br>
Note that unlike many routers, the WMR-300 does <i>not</i> have a tftp server (at least the manufacturer's fw). Meaning: polling the tftp port (tftp command) from the PC until the router is ready and absorbs the data will <i>not</i> work. To push data (a fw) to the router, this is the other way around: start a tftp server on the PC, and trigger the tftp action from the router, as described below.<br><br>
Preliminary step and necessary file:
<ul>
<li>setup a tftp server PC side: the NIC IPv4 on PC to which the router is connected must be 192.168.<b>11</b>.168 (shouldn't matter much in this case, but the network is a class C)</li>
<li>a firmware which magic code is 0x27051956 (big endian, see below) for that chipset. The "initramfs" version of the wmr-300 will work fine (compile it or try to find it on the Net - see below)</li>
</ul>
The firmware file will actually be loaded in memory and run (ie not flashed directly).<br>
But once loaded, its features are usable.<br>
<br>
Unfortunately the SquashFS version of the firmware provided on the page above "openwrt-ramips-mt7620n-wmr-300-squashfs-sysupgrade.bin" (<a href="http://downloads.openwrt.org/barrier_breaker/14.07/ramips/mt7620n/">files for mt7620</a>)
works fine, when burned into the flash memory. However, when directly loaded in memory by the boot loader, the following fatal error is triggered
<div style="padding:10px;margin:10px;border:3px solid #eee;background-color:#ccc;width:50%">
<code>Kernel panic - not syncing: No init found</code> 
</div>
<a href="https://forum.openwrt.org/viewtopic.php?id=40652">This page</a> gives a hint <br>
<br>
basically (from @jow)
<div style="padding:10px;margin:10px;border:3px solid #eee;background-color:#ccc;width:50%">
<code>since OpenWrt has no initrd facility at all it cannot preload the required modules to find the rootfs. You need to run "make kernel_menuconfig" and mark the appropriate controller driver as builtin so that it is actually compiled into the kernel image.</code></div>
Don't panic (too :-) A workaround is to get a firmware compiled with "ramdisk" instead of "squash" FS, so that it can be loaded in memory, and be started directly from the boot loader.<br><ul>
<li>Do a web search of "Build openwrt" and get the environment for the BB version (not Breaking Bad, "Barrier Breaker" :-) See <a href="https://dev.openwrt.org/wiki/GetSource">here</a>.</li>
<li>Get the config file from latest BB repo, currently <a href="https://downloads.openwrt.org/barrier_breaker/14.07/ramips/mt7620n/">here</a> and copy it as ".config" in your 'openwrt' directory.</li>
<li>do 'make menuconfig', enter 'Target Images' and press space on "[  ] ramdisk" to get "[*] ramdisk"</li>
<li>Better add LuCI module (web access), search google on how to do that</li>
<li>"Save" the config (as .config) and do "make -j 5" (5 or number of cores + 1, to accelerate comp)</li>
</ul>
Total will take ~11GB, and a few minutes of CPU.<br>
In the openwrt home dir/bin/ramips should be "openwrt-ramips-mt7620n-wmr-300-initramfs-uImage.bin", that's the one to copy into the tftp server directory renamed as "firmware_WMR-300.ram".<br>
(the original Buffalo fw, once the first 0x34 bytes removed, doesn't have this problem and loads in memory then run with no problem )<br>Note: in the meantime, maybe someone generated the "initramfs" version in the openwrt downloads dir - check it, just in case.<br><br>
Once you get the right fw named "firmware_WMR-300.ram", set in the tftp server dir, plug the wmr-300 USB to start the boot process as follow:
<br>
<br><ul>
<li>Switch ON the router (plug USB)</li>
<li>after 1-2 seconds press and hold for ~5 seconds the AOSS button</li>
<li>The router then requests automatically your tftp server for a file named "firmware_WMR-300.ram"</li>
<li>The load of the fw takes less than 10 seconds</li>
<li>Then wait for the router to boot</li>
</ul>

Note that usually this kind of procedure requires to press a button <i>before</i> switching ON the router. Here, this is <b>not</b> the case. And doing so seems to freeze or damage the device if repeated, and the serial output is weird!<br>
So, ensure to press nothing when you switch on the beast...<br>
<br>
If successful, keep the router ON (remember the fw is only in RAM). The openwrt fw being loaded, the PC interface address (to which the router is connected) has to be changed from the tftp address/network to the openwrt default one (we're now on the 192.168.<b>1</b>.0/24 network).<br>
Say 192.168.<b>1</b>.22 for the PC (router is 192.168.<b>1</b>.1). If you can
<div style="padding:10px;margin:10px;border:3px solid #eee;background-color:#ccc;width:50%">
<code>ping 192.168.1.1</code>
</div>That's a hurrah!! Then from the browser access http://192.168.1.1 and the LuCI Flash feature should work directly, without the hassle of a serial connection. Select from the same binary dir (or the openwrt-site one) the "...wmr-300-squashfs-sysupgrade.bin" file to be flashed.</p>

</div>

<h2 class="sectionedit11" id="tags">Tags</h2>
<div class="level2">
<hr />
<div class="tags"><span>
	<a href="../../tag/ramips?do=showtag&amp;tag=ramips" class="wikilink1" title="tag:ramips" rel="tag">ramips</a>,
	<a href="../../tag/mt7620n?do=showtag&amp;tag=MT7620N" class="wikilink1" title="tag:mt7620n" rel="tag">MT7620N</a>,
	<a href="../../tag/8flash?do=showtag&amp;tag=8Flash" class="wikilink1" title="tag:8flash" rel="tag">8Flash</a>,
	<a href="../../tag/64ram?do=showtag&amp;tag=64RAM" class="wikilink1" title="tag:64ram" rel="tag">64RAM</a>,
	<a href="../../tag/serial?do=showtag&amp;tag=Serial" class="wikilink1" title="tag:serial" rel="tag">Serial</a>,
	<a href="../../tag/mips?do=showtag&amp;tag=MIPS" class="wikilink1" title="tag:mips" rel="tag">MIPS</a>,
	<a href="../../tag/mips32?do=showtag&amp;tag=MIPS32" class="wikilink1" title="tag:mips32" rel="tag">MIPS32</a>,
	<a href="../../tag/24kec?do=showtag&amp;tag=24kec" class="wikilink1" title="tag:24kec" rel="tag">24kec</a>
</span></div>

</div>

                    <!-- wikipage stop -->
                                    </div>

                <div class="docInfo"><bdi>toh/buffalo/wmr-300.txt</bdi> · Last modified: 2015/02/12 05:42 by <bdi>*++p</bdi></div>

                            </div></div><!-- /content -->

            <hr class="a11y" />

            <!-- PAGE ACTIONS -->
            <div id="dokuwiki__pagetools">
                <h3 class="a11y">Page Tools</h3>
                <div class="tools">
                    <ul>
                        <li><a href="http://wiki.openwrt.org/toh/buffalo/wmr-300?do=edit"  class="action source" accesskey="v" rel="nofollow" title="Show pagesource [V]"><span>Show pagesource</span></a></li><li><a href="http://wiki.openwrt.org/toh/buffalo/wmr-300?do=revisions"  class="action revs" accesskey="o" rel="nofollow" title="Old revisions [O]"><span>Old revisions</span></a></li><li><a href="http://wiki.openwrt.org/toh/buffalo/wmr-300?do=backlink"  class="action backlink" rel="nofollow" title="Backlinks"><span>Backlinks</span></a></li><li><a href="wmr-300#dokuwiki__top"  class="action top" accesskey="t" rel="nofollow" title="Back to top [T]"><span>Back to top</span></a></li>                    </ul>
                </div>
            </div>
        </div><!-- /wrapper -->

        
<!-- ********** FOOTER ********** -->
<div id="dokuwiki__footer"><div class="pad">
    <div class="license">Except where otherwise noted, content on this wiki is licensed under the following license: <bdi><a href="http://creativecommons.org/licenses/by-nc-sa/3.0/" rel="license" class="urlextern">CC Attribution-Noncommercial-Share Alike 3.0 Unported</a></bdi></div>
    <div class="buttons">
        <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/" rel="license"><img src="../../lib/images/license/button/cc-by-nc-sa.png" alt="CC Attribution-Noncommercial-Share Alike 3.0 Unported" /></a>        <a href="http://www.dokuwiki.org/donate" title="Donate" ><img
            src="../../lib/tpl/openwrt/images/button-donate.gif" width="80" height="15" alt="Donate" /></a>
        <a href="http://www.php.net" title="Powered by PHP" ><img
            src="../../lib/tpl/openwrt/images/button-php.gif" width="80" height="15" alt="Powered by PHP" /></a>
        <a href="http://validator.w3.org/check/referer" title="Valid HTML5" ><img
            src="../../lib/tpl/openwrt/images/button-html5.png" width="80" height="15" alt="Valid HTML5" /></a>
        <a href="http://jigsaw.w3.org/css-validator/check/referer?profile=css3" title="Valid CSS" ><img
            src="../../lib/tpl/openwrt/images/button-css.png" width="80" height="15" alt="Valid CSS" /></a>
        <a href="http://dokuwiki.org/" title="Driven by DokuWiki" ><img
            src="../../lib/tpl/openwrt/images/button-dw.png" width="80" height="15" alt="Driven by DokuWiki" /></a>
    </div>
</div></div><!-- /footer -->

    </div></div><!-- /site -->

    <div class="no"><img src="http://wiki.openwrt.org/lib/exe/indexer.php?id=toh%3Abuffalo%3Awmr-300&amp;1432282055" width="2" height="1" alt="" /></div>
    <div id="screen__mode" class="no"></div>    <!--[if ( lte IE 7 | IE 8 ) ]></div><![endif]-->
</body>
</html>
