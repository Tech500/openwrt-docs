<!DOCTYPE html>
<html lang="en" dir="ltr" class="no-js">
<head>
    <meta charset="utf-8" />
    <title>D-Link DSL-5xxT and DSL-G6xxT - ADAM2 Installation Guide [OpenWrt Wiki]</title>
    <script>(function(H){H.className=H.className.replace(/\bno-js\b/,'js')})(document.documentElement)</script>
    <meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="keywords" content="ar7"/>
<link rel="search" type="application/opensearchdescription+xml" href="../../lib/exe/opensearch.php" title="OpenWrt Wiki"/>
<link rel="start" href="../../index.html"/>
<link rel="contents" href="dsl-5xxt-6xxt-adam2?do=index" title="Sitemap"/>
<link rel="alternate" type="application/rss+xml" title="Recent changes" href="../../feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Current namespace" href="../../feed.php?mode=list&amp;ns=toh:d-link"/>
<link rel="alternate" type="text/html" title="Plain HTML" href="../../_export/xhtml/toh/d-link/dsl-5xxt-6xxt-adam2"/>
<link rel="alternate" type="text/plain" title="Wiki Markup" href="../../_export/raw/toh/d-link/dsl-5xxt-6xxt-adam2"/>
<link rel="canonical" href="dsl-5xxt-6xxt-adam2"/>
<link rel="stylesheet" type="text/css" href="../../lib/exe/css.php?t=openwrt&amp;tseed=6f44f363dc87908d905dc56ff3acbfc4"/>
<script type="text/javascript">/*<![CDATA[*/var NS='toh:d-link';var JSINFO = {"id":"toh:d-link:dsl-5xxt-6xxt-adam2","namespace":"toh:d-link"};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="../../lib/exe/js.php?tseed=6f44f363dc87908d905dc56ff3acbfc4"></script>
<script type="text/javascript" charset="utf-8">/*<![CDATA[*/jQuery(function(){
	for ( i=0; i < document.forms.length; i++ ) {
		if (document.forms[i].method == 'post') {
			var myElement = document.createElement('input');
			myElement.setAttribute('type', 'hidden');
			myElement.name = 'bb2_screener_';
			myElement.value = '1432267747 166.182.3.201';
			document.forms[i].appendChild(myElement);
		}
	}
});
/*!]]>*/</script>
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <link rel="shortcut icon" href="../../lib/tpl/openwrt/images/favicon.ico" />
<link rel="apple-touch-icon" href="../../lib/tpl/openwrt/images/apple-touch-icon.png" />
    </head>

<body>
    <!--[if lte IE 7 ]><div id="IE7"><![endif]--><!--[if IE 8 ]><div id="IE8"><![endif]-->
    <div id="dokuwiki__site"><div id="dokuwiki__top" class="site dokuwiki mode_show tpl_openwrt     ">

        
<!-- ********** HEADER ********** -->
<div id="dokuwiki__header"><div class="pad group">

    
    <div class="headings group">
        <ul class="a11y skip">
            <li><a href="dsl-5xxt-6xxt-adam2#dokuwiki__content">skip to content</a></li>
        </ul>

        <h1><a href="../../start"  accesskey="h" title="[H]"><img src="../../lib/tpl/openwrt/images/logo.png" width="386" height="98" alt="" /> <span>OpenWrt Wiki</span></a></h1>
            </div>

    <div class="tools group">
        <!-- USER TOOLS -->
                    <div id="dokuwiki__usertools">
                <h3 class="a11y">User Tools</h3>
                <ul>
                    <li><a href="dsl-5xxt-6xxt-adam2?do=register"  class="action register" rel="nofollow" title="Register">Register</a></li><li><a href="dsl-5xxt-6xxt-adam2?do=login&amp;sectok=382740b13d95f946eed36caa57076b4a"  class="action login" rel="nofollow" title="Login">Login</a></li>                </ul>
            </div>
        
        <!-- SITE TOOLS -->
        <div id="dokuwiki__sitetools">
            <h3 class="a11y">Site Tools</h3>
            <form action="../../start" accept-charset="utf-8" class="search" id="dw__search" method="get" role="search"><div class="no"><input type="hidden" name="do" value="search" /><input type="text" id="qsearch__in" accesskey="f" name="id" class="edit" title="[F]" /><input type="submit" value="Search" class="button" title="Search" /><div id="qsearch__out" class="ajax_qsearch JSpopup"></div></div></form>            <div class="mobileTools">
                <form action="../../doku.php" method="get" accept-charset="utf-8"><div class="no"><input type="hidden" name="id" value="toh:d-link:dsl-5xxt-6xxt-adam2" /><select name="do" class="edit quickselect" title="Tools"><option value="">Tools</option><optgroup label="Page Tools"><option value="edit">Show pagesource</option><option value="revisions">Old revisions</option><option value="backlink">Backlinks</option></optgroup><optgroup label="Site Tools"><option value="recent">Recent changes</option><option value="media">Media Manager</option><option value="index">Sitemap</option></optgroup><optgroup label="User Tools"><option value="login">Login</option><option value="register">Register</option></optgroup></select><input type="submit" value="&gt;" /></div></form>            </div>
            <ul>
                <li><a href="dsl-5xxt-6xxt-adam2?do=recent"  class="action recent" accesskey="r" rel="nofollow" title="Recent changes [R]">Recent changes</a></li><li><a href="dsl-5xxt-6xxt-adam2?do=media&amp;ns=toh%253Ad-link"  class="action media" rel="nofollow" title="Media Manager">Media Manager</a></li><li><a href="dsl-5xxt-6xxt-adam2?do=index"  class="action index" accesskey="x" rel="nofollow" title="Sitemap [X]">Sitemap</a></li>            </ul>
        </div>

    </div>

    <!-- BREADCRUMBS -->
            <div class="breadcrumbs">
                            <div class="youarehere"><span class="bchead">You are here: </span><span class="home"><bdi><a href="../../start" class="wikilink1" title="start">OpenWrt Wiki</a></bdi></span> » <bdi><a href="../start" class="wikilink1" title="toh:start">Table of Hardware</a></bdi> » <bdi><a href="start" class="wikilink1" title="toh:d-link:start">D-Link</a></bdi> » <bdi><span class="curid"><a href="dsl-5xxt-6xxt-adam2" class="wikilink1" title="toh:d-link:dsl-5xxt-6xxt-adam2">D-Link DSL-5xxT and DSL-G6xxT - ADAM2 Installation Guide</a></span></bdi></div>
                                    <div class="plugin_multilingual">
        <ul>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/cz/toh/d-link/dsl-5xxt-6xxt-adam2" class="media" title="cz:toh:d-link:dsl-5xxt-6xxt-adam2"><img src="../../lib/exe/fetch.php?cache=&amp;tok=aff589&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fcz.gif" class="media" title="Čeština (Czech)" alt="Čeština (Czech)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/de/toh/d-link/dsl-5xxt-6xxt-adam2" class="media" title="de:toh:d-link:dsl-5xxt-6xxt-adam2"><img src="../../lib/exe/fetch.php?cache=&amp;tok=e24010&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fde.gif" class="media" title="Deutsch (German)" alt="Deutsch (German)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <span class="curid"><a href="dsl-5xxt-6xxt-adam2" class="media" title="toh:d-link:dsl-5xxt-6xxt-adam2"><img src="../../lib/exe/fetch.php?cache=&amp;tok=2a37ae&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fgb.gif" class="media" title="English" alt="English" /></a></span>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/es/toh/d-link/dsl-5xxt-6xxt-adam2" class="media" title="es:toh:d-link:dsl-5xxt-6xxt-adam2"><img src="../../lib/exe/fetch.php?cache=&amp;tok=46c004&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fmx.gif" class="media" title="Español (Spanish, Mexico)" alt="Español (Spanish, Mexico)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/fr/toh/d-link/dsl-5xxt-6xxt-adam2" class="media" title="fr:toh:d-link:dsl-5xxt-6xxt-adam2"><img src="../../lib/exe/fetch.php?cache=&amp;tok=a5beba&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Ffr.gif" class="media" title="Français (French)" alt="Français (French)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/hu/toh/d-link/dsl-5xxt-6xxt-adam2" class="media" title="hu:toh:d-link:dsl-5xxt-6xxt-adam2"><img src="../../lib/exe/fetch.php?cache=&amp;tok=6b5470&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fhu.gif" class="media" title="Magyar (Hungarian)" alt="Magyar (Hungarian)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/jp/toh/d-link/dsl-5xxt-6xxt-adam2" class="media" title="jp:toh:d-link:dsl-5xxt-6xxt-adam2"><img src="../../lib/exe/fetch.php?cache=&amp;tok=f999fc&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fjp.gif" class="media" title="日本語 (Japanese)" alt="日本語 (Japanese)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/pl/toh/d-link/dsl-5xxt-6xxt-adam2" class="media" title="pl:toh:d-link:dsl-5xxt-6xxt-adam2"><img src="../../lib/exe/fetch.php?cache=&amp;tok=c805c0&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fpl.gif" class="media" title="Poliski (Polish)" alt="Poliski (Polish)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/pt-br/toh/d-link/dsl-5xxt-6xxt-adam2" class="media" title="pt-br:toh:d-link:dsl-5xxt-6xxt-adam2"><img src="../../lib/exe/fetch.php?cache=&amp;tok=13127d&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fbr.gif" class="media" title="Português brasileiro (Portuguese, Brasil)" alt="Português brasileiro (Portuguese, Brasil)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/ru/toh/d-link/dsl-5xxt-6xxt-adam2" class="media" title="ru:toh:d-link:dsl-5xxt-6xxt-adam2"><img src="../../lib/exe/fetch.php?cache=&amp;tok=66ab5e&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fru.gif" class="media" title="Русский (Russsian)" alt="Русский (Russsian)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/tr/toh/d-link/dsl-5xxt-6xxt-adam2" class="media" title="tr:toh:d-link:dsl-5xxt-6xxt-adam2"><img src="../../lib/exe/fetch.php?cache=&amp;tok=f4beed&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Ftr.gif" class="media" title="Tϋrkçe (Turkish)" alt="Tϋrkçe (Turkish)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/zh-cn/toh/d-link/dsl-5xxt-6xxt-adam2" class="media" title="zh-cn:toh:d-link:dsl-5xxt-6xxt-adam2"><img src="../../lib/exe/fetch.php?cache=&amp;tok=93625a&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fzh-cn.gif" class="media" title="官話/官话 (Chinese)" alt="官話/官话 (Chinese)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/zh-tw/toh/d-link/dsl-5xxt-6xxt-adam2" class="media" title="zh-tw:toh:d-link:dsl-5xxt-6xxt-adam2"><img src="../../lib/exe/fetch.php?cache=&amp;tok=b56198&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fzh-tw.gif" class="media" title="臺灣華語 (Taiwanese)" alt="臺灣華語 (Taiwanese)" /></a>
              </div>
            </div>
          </li>
        </ul>
      </div>
        </div>
    
    
    <hr class="a11y" />
</div></div><!-- /header -->

        <div class="wrapper group">

            
            <!-- ********** CONTENT ********** -->
            <div id="dokuwiki__content"><div class="pad group">

                <div class="pageId"><span>toh:d-link:dsl-5xxt-6xxt-adam2</span></div>

                <div class="page group">
                                                            <!-- wikipage start -->
                    <!-- TOC START -->
<div id="dw__toc">
<h3 class="toggle">Table of Contents</h3>
<div>

<ul class="toc">
<li class="level1"><div class="li"><a href="dsl-5xxt-6xxt-adam2#installation">Installation</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="dsl-5xxt-6xxt-adam2#finding_the_bootloader_address">Finding the bootloader address</a></div></li>
<li class="level2"><div class="li"><a href="dsl-5xxt-6xxt-adam2#partitioning">Partitioning</a></div></li>
<li class="level2"><div class="li"><a href="dsl-5xxt-6xxt-adam2#flashing">Flashing</a></div></li>
</ul>
</li>
<li class="level1"><div class="li"><a href="dsl-5xxt-6xxt-adam2#upgrading">Upgrading</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="dsl-5xxt-6xxt-adam2#tags">Tags</a></div></li>
</ul></li>
</ul>
</div>
</div>
<!-- TOC END -->

<h1 class="sectionedit1" id="d-link_dsl-5xxt_and_dsl-g6xxt_-_adam2_installation_guide">D-Link DSL-5xxT and DSL-G6xxT - ADAM2 Installation Guide</h1>
<div class="level1">

<p>
The 5xxT/G6xxT family uses an ADAM2 bootloader. That means that the installation is slighly more complex than the common one used for Broadcom (and PSPBoot-based AR7) devices. There is in-depth technical documentation on the <a href="http://www.seattlewireless.net/ADAM2" class="urlextern" title="http://www.seattlewireless.net/ADAM2"  rel="nofollow">Seatte Wireless ADAM2 page</a>.
</p>

<p>
There are multiple safeguards that make the risk of bricking the router pretty low. The bootloader starts an <abbr title="File Transfer Protocol">FTP</abbr> (<abbr title="File Transfer Protocol">FTP</abbr>, not <strong>T</strong><abbr title="File Transfer Protocol">FTP</abbr>!) server on each boot, and can be accessed directly with a <abbr title="File Transfer Protocol">FTP</abbr> client. It will also accept the original firmware image.
</p>

<p>
If something goes wrong, the <em>tiupgrade.exe</em> Windows tool can be used to restore the original firmware. For more advanced users, <a href="http://www.dlinkpedia.net/software/ciclamab.php" class="urlextern" title="http://www.dlinkpedia.net/software/ciclamab.php"  rel="nofollow">CICLaMaB</a> (and its wizard) might also be useful. If things go *really* wrong, the board has a JTAG port (not tested), which should be enough to recover a completely bricked device.
</p>

<p>
The easiest way to upgrade the firmware is directly from OpenWrt using the <code><a href="../../doc/techref/mtd" class="wikilink1" title="doc:techref:mtd">mtd</a></code>-tool because <a href="../../doc/howto/generic.sysupgrade" class="wikilink1" title="doc:howto:generic.sysupgrade">generic.sysupgrade</a> is not supported yet.
</p>
<hr />

<p>
Please do read:
</p>
<ul>
<li class="level1"><div class="li"> <a href="../../doc/howto/installing" class="wikilink1" title="doc:howto:generic.flashing">generic.flashing</a></div>
</li>
<li class="level1"><div class="li"> <a href="../../doc/howto/generic.flashing.ftp" class="wikilink1" title="doc:howto:generic.flashing.ftp">generic.flashing.ftp</a></div>
</li>
<li class="level1"><div class="li"> <a href="../../doc/techref/bootloader.1" class="wikilink1" title="doc:techref:bootloader">bootloader</a></div>
</li>
<li class="level1"><div class="li"> <a href="../../doc/techref/bootloader/adam2" class="wikilink1" title="doc:techref:bootloader:adam2">adam2</a></div>
</li>
</ul>
<hr />

</div>

<h2 class="sectionedit2" id="installation">Installation</h2>
<div class="level2">

</div>

<h3 class="sectionedit3" id="finding_the_bootloader_address">Finding the bootloader address</h3>
<div class="level3">

<p>
When booting, the bootloader waits a few seconds for incoming connections to its <abbr title="File Transfer Protocol">FTP</abbr> server. The address the bootloader listens to can be (and probably is) different from the one used by the device once the boot is completed. 
The easiest way to find it is to connect to the router with telnet, once the original firmware has completed booting.
</p>

<p>
User and passwords are both set by default to &quot;<strong>admin</strong>&quot;.
</p>
<div class="table sectionedit4"><table class="inline">
	<tr class="row0">
		<td class="col0"><pre class="code"># cat /proc/ticfg/env | grep my_ipaddress</pre>
</td>
	</tr>
</table></div>

<p>
If the IP is set it will be shown like this:
</p>
<div class="table sectionedit5"><table class="inline">
	<tr class="row0">
		<td class="col0"><pre class="code">my_ipaddress    10.8.8.8</pre>
</td>
	</tr>
</table></div>

<p>
Usually, most devices use either <strong>5.8.8.8</strong> or <strong>10.8.8.8</strong>. If you&#039;re upgraded the firmware in the past using <em>tiupgrade.exe</em>, it might have changed your IP to the one you specified in the web interface.
</p>

<p>
If it&#039;s not displayed, or to change it, it can be set with the command:
</p>
<div class="table sectionedit6"><table class="inline">
	<tr class="row0">
		<td class="col0"><pre class="code"># echo &quot;my_ipaddress 192.168.1.1&quot; &gt; /proc/sys/dev/adam2/environment</pre>
</td>
	</tr>
</table></div>

</div>

<h3 class="sectionedit7" id="partitioning">Partitioning</h3>
<div class="level3">

<p>
The flash on the device is divided into partitions. To get Openwrt to boot, we have to change some offsets.
</p>

<p>
The original firmware uses these partitions (in <strong>physical</strong> order):
</p>
<div class="table sectionedit8"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0"> Bootloader name </th><th class="col1"> start </th><th class="col2"> end </th><th class="col3"> size </th><th class="col4"> use </th>
	</tr>
	</thead>
	<tr class="row1">
		<td class="col0"> mtd2 </td><td class="col1"> 0x90000000 </td><td class="col2"> 0x90010000 </td><td class="col3"> 64 KiB </td><td class="col4"> Bootloader </td>
	</tr>
	<tr class="row2">
		<td class="col0"> mtd1 </td><td class="col1"> 0x90010090 </td><td class="col2"> 0x90091000 </td><td class="col3"> ~516 KiB </td><td class="col4"> Kernel </td>
	</tr>
	<tr class="row3">
		<td class="col0"> mtd0 </td><td class="col1"> 0x90091000 </td><td class="col2"> 0x903f0000 </td><td class="col3"> 3452 KiB </td><td class="col4"> Root filesystem </td>
	</tr>
	<tr class="row4">
		<td class="col0"> mtd3 </td><td class="col1"> 0x903f0000 </td><td class="col2"> 0x90400000 </td><td class="col3"> 64 KiB </td><td class="col4"> Configuration </td>
	</tr>
</table></div>

<p>
and another &quot;virtual&quot; partition&quot; that covers both mtd1 and mtd0
</p>
<div class="table sectionedit9"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0"> Bootloader name </th><th class="col1"> start </th><th class="col2"> end </th><th class="col3"> size </th><th class="col4"> use </th>
	</tr>
	</thead>
	<tr class="row1">
		<td class="col0"> mtd4 </td><td class="col1"> 0x90010000 </td><td class="col2"> 0x903f0000 </td><td class="col3"> 3968 KiB </td><td class="col4"> Kernel + FS </td>
	</tr>
</table></div>

<p>
The <em>mtd2</em> partition contains the bootloader. <strong>Never</strong> touch it. If the bootloader gets corrupted, the router won&#039;t boot anymore (in that case reprogramming the entire flash with the JTAG should bring it back to life). Just to be safe, during normal usage the kernel won&#039;t allow you to overwrite it even if explicitly requested.
</p>

<p>
The <em>mtd3</em> partition contains both the bootloader configuration and the original firmware settings. OpenWrt will ignore anything written in here. Don&#039;t touch it as well, or ADAM2 might get confused and unable to boot anymore.
</p>

<p>
To use OpenWrt on this unit the the partition layout need to be modified as follows (changes are in <strong>bold</strong>):
</p>

<p>
Partitions: (again, in physical ordering):
</p>
<div class="table sectionedit10"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0"> Bootloader name </th><th class="col1"> Kernel name </th><th class="col2"> Start </th><th class="col3"> End </th><th class="col4"> Use </th>
	</tr>
	</thead>
	<tr class="row1">
		<td class="col0"> mtd2 </td><td class="col1"> loader </td><td class="col2"> 0x90000000 </td><td class="col3"> 0x90010000 </td><td class="col4"> Bootloader (ADAM2) </td>
	</tr>
	<tr class="row2">
		<td class="col0"> mtd1 </td><td class="col1 leftalign"> linux  </td><td class="col2"> <strong>0x90010000</strong> </td><td class="col3"> <strong>0x903f0000</strong> </td><td class="col4"> Linux kernel (only the start address is used) </td>
	</tr>
	<tr class="row3">
		<td class="col0"> mtd0 </td><td class="col1"> rootfs </td><td class="col2"> <strong>0x90010000</strong> </td><td class="col3"> <strong>0x903f0000</strong> </td><td class="col4"> r/o squashfs + r/w jffs2 filesystems (only the end address is used) </td>
	</tr>
	<tr class="row4">
		<td class="col0"> mtd3 </td><td class="col1"> config </td><td class="col2"> 0x903f0000 </td><td class="col3"> 0x90400000 </td><td class="col4"> Original firmware configuration </td>
	</tr>
</table></div>

<p>
the &quot;virtual&quot; partition remains unchanged as
</p>
<div class="table sectionedit11"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0"> Bootloader name </th><th class="col1"> Kernel name </th><th class="col2"> Start </th><th class="col3"> End </th><th class="col4"> Use </th>
	</tr>
	</thead>
	<tr class="row1">
		<td class="col0"> mtd4 </td><td class="col1"> rootfs_data </td><td class="col2"> 0x90010000 </td><td class="col3"> 0x903f0000 </td><td class="col4"> Kernel + FS </td>
	</tr>
</table></div>

<p>
To be more precise, the kernel, once booted, will map another &quot;virtual&quot; partiton as <em>/dev/mtdblock4</em> that will point to the newly created jffs2 partition located inside mtd3. Just ignore it for this discussion.
</p>

<p>
<strong>NOTE:</strong> the end of mtd1 and the start of mtd0 are dummy addresses; OpenWrt auto-detects the boundary between the kernel and the file system. The extra addresses are only used by firmwares based on 2.4.x kernels. 
</p>

</div>

<h3 class="sectionedit12" id="flashing">Flashing</h3>
<div class="level3">

<p>
As an example, we&#039;ll use the <em>openwrt-ar7-squashfs.bin</em> image from the &quot;<em>ar7</em>&quot; OpenWrt port.
</p>

<p>
<strong>NOTE:</strong> The TCP/IP implementation in the bootloader is very basic and not completely standards compliant. There are some issues with recent Linux kernels that make the flashing process hang.<br/>

<strong>If your <abbr title="File Transfer Protocol">FTP</abbr> client seems stuck</strong>, wait a few minutes and power off the router, the flash won&#039;t be damaged. If you&#039;re having problems, try to run your <abbr title="File Transfer Protocol">FTP</abbr> client as root (so it can set different timeout parameters on the TCP socket). Windows (at least XP) and its built-in <abbr title="File Transfer Protocol">FTP</abbr> command-line client is reported to work.
</p>

<p>
To reach the router during bootup, configure your computer using a static IP address on the same subnet as the bootloader (10.8.8.<strong>1</strong>/8 or 5.8.8.<strong>1</strong>/8 should be fine).
</p>

<p>
Apply power to the router. There will be a few second window where a connection can established with <abbr title="File Transfer Protocol">FTP</abbr> to the address you&#039;ve found before. The time window is very small, so if it doesn&#039;t work try again. It should start listening when the 4 switch lights turn off.
</p>

<p>
<strong>Username and Password are &quot;adam2&quot;</strong>
</p>

<p>
The commands needed to fix the partition table are:
</p>
<div class="table sectionedit13"><table class="inline">
	<tr class="row0">
		<td class="col0"><pre class="code">quote &quot;SETENV mtd1,0x90010000,0x903f0000&quot;
quote &quot;GETENV mtd1&quot;</pre>
</td>
	</tr>
</table></div>

<p>
Check each partition before continuing, an error here might brick the device.
</p>

<p>
When this has been completed the image can be flashed to the Kernel+FS partition <em>mtd4</em>
</p>
<div class="table sectionedit14"><table class="inline">
	<tr class="row0">
		<td class="col0"><pre class="code">quote &quot;MEDIA FLSH&quot;
binary
debug
hash
put &quot;openwrt-ar7-squashfs.bin&quot; &quot;openwrt-ar7-squashfs.bin mtd4&quot;
quote REBOOT
quit</pre>
</td>
	</tr>
</table></div>

<p>
The router will reboot and set itself up, do not remove power as this could break it. Leave it until the status light has a steady heartbeat, then it is safe to power down.
</p>

</div>

<h2 class="sectionedit15" id="upgrading">Upgrading</h2>
<div class="level2">

<p>
you can not use sysupgrade to update this router, so you can use mtd:
</p>
<div class="table sectionedit16"><table class="inline">
	<tr class="row0">
		<td class="col0"><pre class="code">scp openwrt-ar7-squashfs.bin 192.168.1.1:/tmp
ssh 192.168.1.1
mtd -r write  /tmp/openwrt-ar7-squashfs.bin linux</pre>
</td>
	</tr>
</table></div>

<p>
in case you load a non-working you can still use the <abbr title="File Transfer Protocol">FTP</abbr> method to reflash with a working one
</p>

</div>

<h3 class="sectionedit17" id="tags">Tags</h3>
<div class="level3">
<div class="tags"><span>
	<a href="../../tag/ar7?do=showtag&amp;tag=ar7" class="wikilink1" title="tag:ar7" rel="tag">ar7</a>
</span></div>

</div>

                    <!-- wikipage stop -->
                                    </div>

                <div class="docInfo"><bdi>toh/d-link/dsl-5xxt-6xxt-adam2.txt</bdi> · Last modified: 2014/02/13 07:35 (external edit)</div>

                            </div></div><!-- /content -->

            <hr class="a11y" />

            <!-- PAGE ACTIONS -->
            <div id="dokuwiki__pagetools">
                <h3 class="a11y">Page Tools</h3>
                <div class="tools">
                    <ul>
                        <li><a href="dsl-5xxt-6xxt-adam2?do=edit"  class="action source" accesskey="v" rel="nofollow" title="Show pagesource [V]"><span>Show pagesource</span></a></li><li><a href="dsl-5xxt-6xxt-adam2?do=revisions"  class="action revs" accesskey="o" rel="nofollow" title="Old revisions [O]"><span>Old revisions</span></a></li><li><a href="dsl-5xxt-6xxt-adam2?do=backlink"  class="action backlink" rel="nofollow" title="Backlinks"><span>Backlinks</span></a></li><li><a href="dsl-5xxt-6xxt-adam2#dokuwiki__top"  class="action top" accesskey="t" rel="nofollow" title="Back to top [T]"><span>Back to top</span></a></li>                    </ul>
                </div>
            </div>
        </div><!-- /wrapper -->

        
<!-- ********** FOOTER ********** -->
<div id="dokuwiki__footer"><div class="pad">
    <div class="license">Except where otherwise noted, content on this wiki is licensed under the following license: <bdi><a href="http://creativecommons.org/licenses/by-nc-sa/3.0/" rel="license" class="urlextern">CC Attribution-Noncommercial-Share Alike 3.0 Unported</a></bdi></div>
    <div class="buttons">
        <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/" rel="license"><img src="../../lib/images/license/button/cc-by-nc-sa.png" alt="CC Attribution-Noncommercial-Share Alike 3.0 Unported" /></a>        <a href="http://www.dokuwiki.org/donate" title="Donate" ><img
            src="../../lib/tpl/openwrt/images/button-donate.gif" width="80" height="15" alt="Donate" /></a>
        <a href="http://www.php.net" title="Powered by PHP" ><img
            src="../../lib/tpl/openwrt/images/button-php.gif" width="80" height="15" alt="Powered by PHP" /></a>
        <a href="http://validator.w3.org/check/referer" title="Valid HTML5" ><img
            src="../../lib/tpl/openwrt/images/button-html5.png" width="80" height="15" alt="Valid HTML5" /></a>
        <a href="http://jigsaw.w3.org/css-validator/check/referer?profile=css3" title="Valid CSS" ><img
            src="../../lib/tpl/openwrt/images/button-css.png" width="80" height="15" alt="Valid CSS" /></a>
        <a href="http://dokuwiki.org/" title="Driven by DokuWiki" ><img
            src="../../lib/tpl/openwrt/images/button-dw.png" width="80" height="15" alt="Driven by DokuWiki" /></a>
    </div>
</div></div><!-- /footer -->

    </div></div><!-- /site -->

    <div class="no"><img src="../../lib/exe/indexer.php?id=toh%253Ad-link%253Adsl-5xxt-6xxt-adam2&amp;1432267747" width="2" height="1" alt="" /></div>
    <div id="screen__mode" class="no"></div>    <!--[if ( lte IE 7 | IE 8 ) ]></div><![endif]-->
</body>
</html>
