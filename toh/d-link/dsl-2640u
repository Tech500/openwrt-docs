<!DOCTYPE html>
<html lang="en" dir="ltr" class="no-js">
<head>
    <meta charset="utf-8" />
    <title>D-Link DSL-2640U(B) [OpenWrt Wiki]</title>
    <script>(function(H){H.className=H.className.replace(/\bno-js\b/,'js')})(document.documentElement)</script>
    <meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="keywords" content="bcm63xx,bcm6348"/>
<link rel="search" type="application/opensearchdescription+xml" href="../../lib/exe/opensearch.php" title="OpenWrt Wiki"/>
<link rel="start" href="../../index.html"/>
<link rel="contents" href="dsl-2640u?do=index" title="Sitemap"/>
<link rel="alternate" type="application/rss+xml" title="Recent changes" href="../../feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Current namespace" href="../../feed.php?mode=list&amp;ns=toh:d-link"/>
<link rel="alternate" type="text/html" title="Plain HTML" href="../../_export/xhtml/toh/d-link/dsl-2640u"/>
<link rel="alternate" type="text/plain" title="Wiki Markup" href="../../_export/raw/toh/d-link/dsl-2640u"/>
<link rel="canonical" href="dsl-2640u"/>
<link rel="stylesheet" type="text/css" href="../../lib/exe/css.php?t=openwrt&amp;tseed=6f44f363dc87908d905dc56ff3acbfc4"/>
<script type="text/javascript">/*<![CDATA[*/var NS='toh:d-link';var JSINFO = {"id":"toh:d-link:dsl-2640u","namespace":"toh:d-link"};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="../../lib/exe/js.php?tseed=6f44f363dc87908d905dc56ff3acbfc4"></script>
<script type="text/javascript" charset="utf-8">/*<![CDATA[*/jQuery(function(){
	for ( i=0; i < document.forms.length; i++ ) {
		if (document.forms[i].method == 'post') {
			var myElement = document.createElement('input');
			myElement.setAttribute('type', 'hidden');
			myElement.name = 'bb2_screener_';
			myElement.value = '1432266223 166.182.3.17';
			document.forms[i].appendChild(myElement);
		}
	}
});
/*!]]>*/</script>
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <link rel="shortcut icon" href="../../lib/tpl/openwrt/images/favicon.ico" />
<link rel="apple-touch-icon" href="../../lib/tpl/openwrt/images/apple-touch-icon.png" />
    </head>

<body>
    <!--[if lte IE 7 ]><div id="IE7"><![endif]--><!--[if IE 8 ]><div id="IE8"><![endif]-->
    <div id="dokuwiki__site"><div id="dokuwiki__top" class="site dokuwiki mode_show tpl_openwrt     ">

        
<!-- ********** HEADER ********** -->
<div id="dokuwiki__header"><div class="pad group">

    
    <div class="headings group">
        <ul class="a11y skip">
            <li><a href="dsl-2640u#dokuwiki__content">skip to content</a></li>
        </ul>

        <h1><a href="../../start"  accesskey="h" title="[H]"><img src="../../lib/tpl/openwrt/images/logo.png" width="386" height="98" alt="" /> <span>OpenWrt Wiki</span></a></h1>
            </div>

    <div class="tools group">
        <!-- USER TOOLS -->
                    <div id="dokuwiki__usertools">
                <h3 class="a11y">User Tools</h3>
                <ul>
                    <li><a href="dsl-2640u?do=register"  class="action register" rel="nofollow" title="Register">Register</a></li><li><a href="dsl-2640u?do=login&amp;sectok=382740b13d95f946eed36caa57076b4a"  class="action login" rel="nofollow" title="Login">Login</a></li>                </ul>
            </div>
        
        <!-- SITE TOOLS -->
        <div id="dokuwiki__sitetools">
            <h3 class="a11y">Site Tools</h3>
            <form action="../../start" accept-charset="utf-8" class="search" id="dw__search" method="get" role="search"><div class="no"><input type="hidden" name="do" value="search" /><input type="text" id="qsearch__in" accesskey="f" name="id" class="edit" title="[F]" /><input type="submit" value="Search" class="button" title="Search" /><div id="qsearch__out" class="ajax_qsearch JSpopup"></div></div></form>            <div class="mobileTools">
                <form action="../../doku.php" method="get" accept-charset="utf-8"><div class="no"><input type="hidden" name="id" value="toh:d-link:dsl-2640u" /><select name="do" class="edit quickselect" title="Tools"><option value="">Tools</option><optgroup label="Page Tools"><option value="edit">Show pagesource</option><option value="revisions">Old revisions</option><option value="backlink">Backlinks</option></optgroup><optgroup label="Site Tools"><option value="recent">Recent changes</option><option value="media">Media Manager</option><option value="index">Sitemap</option></optgroup><optgroup label="User Tools"><option value="login">Login</option><option value="register">Register</option></optgroup></select><input type="submit" value="&gt;" /></div></form>            </div>
            <ul>
                <li><a href="dsl-2640u?do=recent"  class="action recent" accesskey="r" rel="nofollow" title="Recent changes [R]">Recent changes</a></li><li><a href="dsl-2640u?do=media&amp;ns=toh%253Ad-link"  class="action media" rel="nofollow" title="Media Manager">Media Manager</a></li><li><a href="dsl-2640u?do=index"  class="action index" accesskey="x" rel="nofollow" title="Sitemap [X]">Sitemap</a></li>            </ul>
        </div>

    </div>

    <!-- BREADCRUMBS -->
            <div class="breadcrumbs">
                            <div class="youarehere"><span class="bchead">You are here: </span><span class="home"><bdi><a href="../../start" class="wikilink1" title="start">OpenWrt Wiki</a></bdi></span> » <bdi><a href="../start" class="wikilink1" title="toh:start">Table of Hardware</a></bdi> » <bdi><a href="start" class="wikilink1" title="toh:d-link:start">D-Link</a></bdi> » <bdi><span class="curid"><a href="dsl-2640u" class="wikilink1" title="toh:d-link:dsl-2640u">D-Link DSL-2640U(B)</a></span></bdi></div>
                                    <div class="plugin_multilingual">
        <ul>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/cz/toh/d-link/dsl-2640u" class="media" title="cz:toh:d-link:dsl-2640u"><img src="../../lib/exe/fetch.php?cache=&amp;tok=aff589&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fcz.gif" class="media" title="Čeština (Czech)" alt="Čeština (Czech)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/de/toh/d-link/dsl-2640u" class="media" title="de:toh:d-link:dsl-2640u"><img src="../../lib/exe/fetch.php?cache=&amp;tok=e24010&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fde.gif" class="media" title="Deutsch (German)" alt="Deutsch (German)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <span class="curid"><a href="dsl-2640u" class="media" title="toh:d-link:dsl-2640u"><img src="../../lib/exe/fetch.php?cache=&amp;tok=2a37ae&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fgb.gif" class="media" title="English" alt="English" /></a></span>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/es/toh/d-link/dsl-2640u" class="media" title="es:toh:d-link:dsl-2640u"><img src="../../lib/exe/fetch.php?cache=&amp;tok=46c004&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fmx.gif" class="media" title="Español (Spanish, Mexico)" alt="Español (Spanish, Mexico)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/fr/toh/d-link/dsl-2640u" class="media" title="fr:toh:d-link:dsl-2640u"><img src="../../lib/exe/fetch.php?cache=&amp;tok=a5beba&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Ffr.gif" class="media" title="Français (French)" alt="Français (French)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/hu/toh/d-link/dsl-2640u" class="media" title="hu:toh:d-link:dsl-2640u"><img src="../../lib/exe/fetch.php?cache=&amp;tok=6b5470&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fhu.gif" class="media" title="Magyar (Hungarian)" alt="Magyar (Hungarian)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/jp/toh/d-link/dsl-2640u" class="media" title="jp:toh:d-link:dsl-2640u"><img src="../../lib/exe/fetch.php?cache=&amp;tok=f999fc&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fjp.gif" class="media" title="日本語 (Japanese)" alt="日本語 (Japanese)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/pl/toh/d-link/dsl-2640u" class="media" title="pl:toh:d-link:dsl-2640u"><img src="../../lib/exe/fetch.php?cache=&amp;tok=c805c0&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fpl.gif" class="media" title="Poliski (Polish)" alt="Poliski (Polish)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/pt-br/toh/d-link/dsl-2640u" class="media" title="pt-br:toh:d-link:dsl-2640u"><img src="../../lib/exe/fetch.php?cache=&amp;tok=13127d&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fbr.gif" class="media" title="Português brasileiro (Portuguese, Brasil)" alt="Português brasileiro (Portuguese, Brasil)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/ru/toh/d-link/dsl-2640u" class="media" title="ru:toh:d-link:dsl-2640u"><img src="../../lib/exe/fetch.php?cache=&amp;tok=66ab5e&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fru.gif" class="media" title="Русский (Russsian)" alt="Русский (Russsian)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/tr/toh/d-link/dsl-2640u" class="media" title="tr:toh:d-link:dsl-2640u"><img src="../../lib/exe/fetch.php?cache=&amp;tok=f4beed&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Ftr.gif" class="media" title="Tϋrkçe (Turkish)" alt="Tϋrkçe (Turkish)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/zh-cn/toh/d-link/dsl-2640u" class="media" title="zh-cn:toh:d-link:dsl-2640u"><img src="../../lib/exe/fetch.php?cache=&amp;tok=93625a&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fzh-cn.gif" class="media" title="官話/官话 (Chinese)" alt="官話/官话 (Chinese)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/zh-tw/toh/d-link/dsl-2640u" class="media" title="zh-tw:toh:d-link:dsl-2640u"><img src="../../lib/exe/fetch.php?cache=&amp;tok=b56198&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fzh-tw.gif" class="media" title="臺灣華語 (Taiwanese)" alt="臺灣華語 (Taiwanese)" /></a>
              </div>
            </div>
          </li>
        </ul>
      </div>
        </div>
    
    
    <hr class="a11y" />
</div></div><!-- /header -->

        <div class="wrapper group">

            
            <!-- ********** CONTENT ********** -->
            <div id="dokuwiki__content"><div class="pad group">

                <div class="pageId"><span>toh:d-link:dsl-2640u</span></div>

                <div class="page group">
                                                            <!-- wikipage start -->
                    <!-- TOC START -->
<div id="dw__toc">
<h3 class="toggle">Table of Contents</h3>
<div>

<ul class="toc">
<li class="level1"><div class="li"><a href="dsl-2640u#hardware">Hardware</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="dsl-2640u#info">Info</a></div></li>
<li class="level2"><div class="li"><a href="dsl-2640u#board_images">Board images</a></div></li>
<li class="level2"><div class="li"><a href="dsl-2640u#serial_port_pinout">Serial port pinout</a></div></li>
<li class="level2"><div class="li"><a href="dsl-2640u#cfe_startup_output">CFE startup output</a></div></li>
<li class="level2"><div class="li"><a href="dsl-2640u#jtag_connector">JTAG connector</a></div></li>
<li class="level2"><div class="li"><a href="dsl-2640u#simple_schematics_of_jtag_connection">Simple schematics of JTAG connection</a></div></li>
<li class="level2"><div class="li"><a href="dsl-2640u#broadcom_tag">Broadcom tag</a></div></li>
</ul>
</li>
<li class="level1"><div class="li"><a href="dsl-2640u#installation">Installation</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="dsl-2640u#using_modified_vendor_s_firmware">Using modified vendor&#039;s firmware</a></div></li>
<li class="level2"><div class="li"><a href="dsl-2640u#flashing_via_serial_cable">Flashing via Serial Cable</a></div></li>
<li class="level2"><div class="li"><a href="dsl-2640u#upgrading_openwrt">Upgrading OpenWrt</a></div></li>
<li class="level2"><div class="li"><a href="dsl-2640u#uninstalling_openwrt">Uninstalling OpenWrt</a></div></li>
</ul>
</li>
<li class="level1"><div class="li"><a href="dsl-2640u#configuration">Configuration</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="dsl-2640u#switch_ports">Switch Ports</a></div></li>
<li class="level2"><div class="li"><a href="dsl-2640u#vlan_handling">VLAN Handling</a></div></li>
<li class="level2"><div class="li"><a href="dsl-2640u#adsl_driver_status">ADSL driver status</a></div></li>
<li class="level2"><div class="li"><a href="dsl-2640u#wi-fi_80211g_stability_problem">Wi-Fi 802.11g Stability Problem</a></div></li>
</ul>
</li>
<li class="level1"><div class="li"><a href="dsl-2640u#notes">Notes</a></div></li>
<li class="level1"><div class="li"><a href="dsl-2640u#debricking">Debricking</a></div></li>
<li class="level1"><div class="li"><a href="dsl-2640u#tags">Tags</a></div></li>
</ul>
</div>
</div>
<!-- TOC END -->

<h1 class="sectionedit1" id="d-link_dsl-2640u_b">D-Link DSL-2640U(B)</h1>
<div class="level1">

<p>
On EU and USA market router branded as 2640<strong>B</strong>, on Russian market - as 2640<strong>U</strong> (HW rev B2). This model fully supported in OpenWrt 10.03 (except of ADSL, since Broadcom didnt released source code of their drivers). Notice however the instructions below do not apply to B3 (for details on the unsuccessfull attempts to bring openwrt to this device without opening it, see <a href="https://forum.openwrt.org/viewtopic.php?pid=195443" class="urlextern" title="https://forum.openwrt.org/viewtopic.php?pid=195443"  rel="nofollow">this thread</a>).
</p>

<p>
Also, there are models D-Link DSL-2640U<strong>/BRU/C</strong> (on Broadcom 6338 CPU and Broadcom 4312 WLAN), and D-Link DSL-2640U<strong>/BRU/D</strong> (on Broadcom 6348 CPU and Broadcom 4318 WLAN). Both of them are not tested for OpenWrt support, though second one should work, probably, with minimal board definitions patching. Routers branded D-Link DSL-2640<strong>T</strong> and D-Link DSL-2640<strong>R</strong> have totally different hardware platform - first board built on on TI AR7VW, and second - on TrendChip TC3160 (ADSL2+) and Ralink RT2561 (WLAN).
</p>

</div>

<h2 class="sectionedit2" id="hardware">Hardware</h2>
<div class="level2">

</div>

<h3 class="sectionedit3" id="info">Info</h3>
<div class="level3">
<div class="table sectionedit4"><table class="inline">
	<tr class="row0">
		<td class="col0 leftalign"> <strong><a href="http://en.wikipedia.org/wiki/Instruction set" class="interwiki iw_wp" title="http://en.wikipedia.org/wiki/Instruction set">Architecture</a>:</strong>    </td><td class="col1"> <a href="http://en.wikipedia.org/wiki/MIPS architecture" class="interwiki iw_wp" title="http://en.wikipedia.org/wiki/MIPS architecture">MIPS</a> </td>
	</tr>
	<tr class="row1">
		<td class="col0 leftalign"> <strong>Vendor:</strong>          </td><td class="col1"> <a href="http://en.wikipedia.org/wiki/Broadcom" class="interwiki iw_wp" title="http://en.wikipedia.org/wiki/Broadcom">Broadcom</a> </td>
	</tr>
	<tr class="row2">
		<td class="col0 leftalign"> <strong><a href="../../doc/techref/bootloader.1" class="wikilink1" title="doc:techref:bootloader">Bootloader</a>:</strong>     </td><td class="col1"> <a href="../../doc/techref/bootloader/cfe" class="wikilink1" title="doc:techref:bootloader:cfe">CFE</a> </td>
	</tr>
	<tr class="row3">
		<td class="col0 leftalign"> <strong>Board Id:</strong>  </td><td class="col1"> D-4P-W </td>
	</tr>
	<tr class="row4">
		<td class="col0 leftalign"> <strong><a href="../../doc/hardware/soc.1" class="wikilink1" title="doc:hardware:soc">System-On-Chip</a>:</strong>  </td><td class="col1"> BCM6348SKFBG </td>
	</tr>
	<tr class="row5">
		<td class="col0 leftalign"> <strong><a href="../../doc/hardware/cpu" class="wikilink1" title="doc:hardware:cpu">CPU</a>/Speed</strong>        </td><td class="col1"> BMIPS3300 V0.7 / 256 <abbr title="Megahertz">MHz</abbr> </td>
	</tr>
	<tr class="row6">
		<td class="col0 leftalign"> <strong>Flash-Chip:</strong>      </td><td class="col1"> <a href="http://pdf1.alldatasheet.com/datasheet-pdf/view/143143/MCNIX/MX29LV320CBTC-70G.html" class="urlextern" title="http://pdf1.alldatasheet.com/datasheet-pdf/view/143143/MCNIX/MX29LV320CBTC-70G.html"  rel="nofollow">Macronix MX29LV320CBTC-90G</a> </td>
	</tr>
	<tr class="row7">
		<td class="col0 leftalign"> <strong>Flash size:</strong>      </td><td class="col1"> 4 MiB </td>
	</tr>
	<tr class="row8">
		<td class="col0 leftalign"> <strong>RAM:</strong>             </td><td class="col1 leftalign"> <a href="http://www.esmt.com.tw/DB/manager/upload/M12L64164.pdf" class="urlextern" title="http://www.esmt.com.tw/DB/manager/upload/M12L64164.pdf"  rel="nofollow">ESMT M12L64164A-7T</a> / 2x8 MiB / SDR-143   </td>
	</tr>
	<tr class="row9">
		<td class="col0 leftalign"> <strong>Wireless:</strong>        </td><td class="col1"> Broadcom 4318 802.11b/g (onboard) </td>
	</tr>
	<tr class="row10">
		<td class="col0 leftalign"> <strong>WLAN Front-End:</strong>  </td><td class="col1"> Skyworks SKY65206-13 </td>
	</tr>
	<tr class="row11">
		<td class="col0 leftalign"> <strong>Ethernet:</strong>        </td><td class="col1"> Broadcom BCM5325 w/ vlan support <a href="../../doc/techref/swconfig" class="wikilink1" title="doc:techref:swconfig">swconfig</a> </td>
	</tr>
	<tr class="row12">
		<td class="col0 leftalign"> <strong>Internet:</strong>        </td><td class="col1 leftalign"> ADSL2+  </td>
	</tr>
	<tr class="row13">
		<td class="col0"> <strong>ASDL Line driver:</strong> </td><td class="col1 leftalign"> BCM6301KSG  </td>
	</tr>
	<tr class="row14">
		<td class="col0 leftalign"> <strong>USB:</strong>             </td><td class="col1 leftalign"> No  </td>
	</tr>
	<tr class="row15">
		<td class="col0 leftalign"> <strong><a href="../../OpenWrtDocs/Customizing/Hardware/Serial_Console" class="wikilink1" title="doc:hardware:port.serial">Serial</a>:</strong>          </td><td class="col1"> <a href="dsl-2640u#serial" title="toh:d-link:dsl-2640u ↵" class="wikilink1">Yes</a> </td>
	</tr>
	<tr class="row16">
		<td class="col0 leftalign"> <strong><a href="../../doc/hardware/port.jtag" class="wikilink1" title="doc:hardware:port.jtag">JTAG</a>:</strong>            </td><td class="col1 leftalign"> <a href="dsl-2640u#jtag" title="toh:d-link:dsl-2640u ↵" class="wikilink1">Yes</a>  </td>
	</tr>
</table></div>

<p>
Hardware of D-Link DSL-2640U(B) identical to such products as ASUS AM604g (former AAM6020VI-B6), and Zhone 6218-I2-x0x (former Paradyne 6218-I2).
</p>

</div>

<h3 class="sectionedit5" id="board_images">Board images</h3>
<div class="level3">

<p>
<a href="../../_detail/toh/d-link/dsl2640utopofboard.jpg?id=toh%253Ad-link%253Adsl-2640u" class="media" title="toh:d-link:dsl2640utopofboard.jpg"><img src="../../_media/toh/d-link/dsl2640utopofboard.jpg?w=250&amp;tok=38c1a0" class="media" alt="" width="250" /></a><a href="../../_detail/toh/d-link/dsl2640ubottomofboard.jpg?id=toh%253Ad-link%253Adsl-2640u" class="media" title="toh:d-link:dsl2640ubottomofboard.jpg"><img src="../../_media/toh/d-link/dsl2640ubottomofboard.jpg?w=250&amp;tok=f2a49d" class="media" alt="" width="250" /></a>
</p>

</div>

<h3 class="sectionedit6" id="serial_port_pinout">Serial port pinout</h3>
<div class="level3">

<p>
<a href="../../_detail/toh/d-link/dsl2640uconsole.jpg?id=toh%253Ad-link%253Adsl-2640u" class="media" title="toh:d-link:dsl2640uconsole.jpg"><img src="../../_media/toh/d-link/dsl2640uconsole.jpg?w=250&amp;tok=e6f3a5" class="media" title="dsl2640uconsole.jpg" alt="dsl2640uconsole.jpg" width="250" /></a>
</p>

<p>
Console port uses 3.3 V signaling at speed 115200.
</p>

</div>

<h3 class="sectionedit7" id="cfe_startup_output">CFE startup output</h3>
<div class="level3">
<div class="table sectionedit8"><table class="inline">
	<tr class="row0">
		<td class="col0"><pre class="code">CFE version 1.0.37-6.5.17 for BCM96348 (32bit,SP,BE)
Copyright (C) 2000-2005 Broadcom Corporation.

Boot Address 0xbfc00000

Initializing Arena.
Initializing Devices.
Parallel flash device: name MX29LV320AB, id 0x22a8, size 4096KB
Unknown PHY type
CPU type 0x29107: 256MHz, Bus: 128MHz, Ref: 32MHz
Total memory: 16777216 bytes (16MB)

Total memory used by CFE:  0x80401000 - 0x805257C0 (1198016)
Initialized Data:          0x8041CE20 - 0x8041EDF0 (8144)
BSS Area:                  0x8041EDF0 - 0x804237C0 (18896)
Local Heap:                0x804237C0 - 0x805237C0 (1048576)
Stack Area:                0x805237C0 - 0x805257C0 (8192)
Text (code) segment:       0x80401000 - 0x8041CE20 (114208)
Boot area (physical):      0x00526000 - 0x00566000
Relocation Factor:         I:00000000 - D:00000000

Board IP address                  : 192.168.1.1
Host IP address                   : 192.168.1.100
Gateway IP address                :
Run from flash/host (f/h)         : f
Default host run file name        : vmlinux
Default host flash file name      : bcm963xx_fs_kernel
Boot delay (0-9 seconds)          : 3
Board Id Name                     : D-4P-W
Psi size in KB                    : 24
Number of MAC Addresses (1-32)    : 24
Base MAC Address                  : 00:19:5b:c7:58:01
Ethernet PHY Type                 : External Switch Using Reverse MII
Memory size in MB                 : 16
CMT Thread Number                 : 0
Dying Gasp Enable (0:Disable 1:Enable)  : 1</pre>
</td>
	</tr>
</table></div>

</div>

<h3 class="sectionedit9" id="jtag_connector">JTAG connector</h3>
<div class="level3">

<p>
(8 pin connector marked as &quot;J7&quot;) :<br/>

</p>

<p>
<a href="../../_detail/toh/d-link/dsl2640ujtag.jpg?id=toh%253Ad-link%253Adsl-2640u" class="media" title="toh:d-link:dsl2640ujtag.jpg"><img src="../../_media/toh/d-link/dsl2640ujtag.jpg" class="media" alt="" /></a>
</p>
<div class="table sectionedit10"><table class="inline">
	<tr class="row0">
		<td class="col0"><pre class="code">1 - TDO (Test Data Output) 3.306v
2 - SRST (System Reset) 3.306v
3 - TMS (Test Mode Select) 3.292v
4 - TDI (Test Data Input) 3.294v
5 - TCK (Test Clock) 2.795v
6 - TRST (Test Reset) 3.306v
7 - GND (Ground) 0v
8 - n/a</pre>
</td>
	</tr>
</table></div>

</div>

<h3 class="sectionedit11" id="simple_schematics_of_jtag_connection">Simple schematics of JTAG connection</h3>
<div class="level3">

<p>
<a href="../../_detail/toh/d-link/dsl2640ujtagconnector.gif?id=toh%253Ad-link%253Adsl-2640u" class="media" title="toh:d-link:dsl2640ujtagconnector.gif"><img src="../../_media/toh/d-link/dsl2640ujtagconnector.gif" class="media" alt="" /></a>
</p>

<p>
Many thanks for this info to <a href="http://pudeev.livejournal.com/" class="urlextern" title="http://pudeev.livejournal.com/"  rel="nofollow">http://pudeev.livejournal.com/</a>
</p>

</div>

<h3 class="sectionedit12" id="broadcom_tag">Broadcom tag</h3>
<div class="level3">

<p>
This device&#039;s CFE has tag 3.10, so it&#039;s currently not possible to flash openwrt via vendor&#039;s (unmodified) http, ftp, tftp services.
</p>

<p>
More <a href="../../doc/techref/brcm63xx.imagetag" class="urlextern" title="http://wiki.openwrt.org/doc/techref/brcm63xx.imagetag"  rel="nofollow">http://wiki.openwrt.org/doc/techref/brcm63xx.imagetag</a>
</p>

</div>

<h2 class="sectionedit13" id="installation">Installation</h2>
<div class="level2">

<p>
There are 2 methods to install OpenWrt on this hardware:
</p>

</div>

<h3 class="sectionedit14" id="using_modified_vendor_s_firmware">Using modified vendor&#039;s firmware</h3>
<div class="level3">

<p>
<strong>Don&#039;t try this</strong> unless you are sure OpenWrt firmware you are trying to flash will <strong>work just as planned</strong>.
</p>
<ol>
<li class="level1"><div class="li"> Get <abbr title="GNU General Public License">GPL</abbr> source code from D-Link&#039;s ftp</div>
</li>
<li class="level1"><div class="li"> Modify userapps\opensource\ftpd\fwsyscall.c in the vendor&#039;s firmware as described in <a href="https://dev.openwrt.org/ticket/5472" class="urlextern" title="https://dev.openwrt.org/ticket/5472"  rel="nofollow">bugzilla</a>.</div>
</li>
<li class="level1"><div class="li"> Compile and flash modified firmware.</div>
</li>
<li class="level1"><div class="li"> Login via telnet and use tftp to flash OpenWrt (you need to set up tftpd on your machine)</div>
</li>
</ol>

</div>

<h3 class="sectionedit15" id="flashing_via_serial_cable">Flashing via Serial Cable</h3>
<div class="level3">

<p>
Set up tftpd on your machine, then access router&#039;s CFE, and run
<pre class="code">cfe&gt; flashimage ip_of_tftpd:openwrt-DSL2640B-squashfs-cfe.bin</pre>

</p>

</div>

<h3 class="sectionedit16" id="upgrading_openwrt">Upgrading OpenWrt</h3>
<div class="level3">

<p>
Read about <em>sysupgrade</em> if you don&#039;t have a serial cable. I don&#039;t know whether it works.
</p>

</div>

<h3 class="sectionedit17" id="uninstalling_openwrt">Uninstalling OpenWrt</h3>
<div class="level3">

<p>
Hold reset button and power on the router. Power led should be red. Configure your host to have IP 192.168.1.100. Visit <a href="http://192.168.1.1" class="urlextern" title="http://192.168.1.1"  rel="nofollow">http://192.168.1.1</a> and follow the instructions. When you are going to flash D-Link&#039;s firmware, the CFE will be overwritten, so be careful.
</p>

</div>

<h2 class="sectionedit18" id="configuration">Configuration</h2>
<div class="level2">

</div>

<h3 class="sectionedit19" id="switch_ports">Switch Ports</h3>
<div class="level3">

<p>
Switch is detected by roboswitch kernel module as 2350 on eth1.
</p>
<div class="table sectionedit20"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0 centeralign">  Switch Port    </th><th class="col1 leftalign"> Ethernet Connector      </th>
	</tr>
	</thead>
	<tr class="row1">
		<td class="col0 leftalign"> 0    </td><td class="col1 leftalign"> 4     </td>
	</tr>
	<tr class="row2">
		<td class="col0 leftalign"> 1    </td><td class="col1 leftalign"> 3     </td>
	</tr>
	<tr class="row3">
		<td class="col0 leftalign"> 2    </td><td class="col1 leftalign"> 2     </td>
	</tr>
	<tr class="row4">
		<td class="col0 leftalign"> 3    </td><td class="col1 leftalign"> 1     </td>
	</tr>
	<tr class="row5">
		<td class="col0 leftalign"> 4    </td><td class="col1 leftalign">       </td>
	</tr>
	<tr class="row6">
		<td class="col0 leftalign"> 5    </td><td class="col1 centeralign">   (CPU)    </td>
	</tr>
</table></div>

</div>

<h3 class="sectionedit21" id="vlan_handling">VLAN Handling</h3>
<div class="level3">

<p>
Here is an example that shows 2 VLANs configuration. WAN is assigned to ethernet connector #4. ADSL (eth0) is not used.
</p>

<p>
/etc/config/network:
</p>
<div class="table sectionedit22"><table class="inline">
	<tr class="row0">
		<td class="col0"><pre class="code">config &#039;switch&#039; &#039;eth1&#039;
	option &#039;enable&#039; &#039;1&#039;
	option &#039;enable_vlan&#039; &#039;1&#039;
	option &#039;reset&#039; &#039;1&#039;

config &#039;switch_vlan&#039; &#039;vlan0&#039;
	option &#039;vlan&#039; &#039;0&#039;
	option &#039;device&#039; &#039;eth1&#039;
	option &#039;ports&#039; &#039;1 2 3 5*&#039;

config &#039;switch_vlan&#039; &#039;vlan1&#039;
	option &#039;vlan&#039; &#039;1&#039;
	option &#039;device&#039; &#039;eth1&#039;
	option &#039;ports&#039; &#039;0 5t&#039;

config &#039;interface&#039; &#039;loopback&#039;
	option &#039;ifname&#039; &#039;lo&#039;
	option &#039;proto&#039; &#039;static&#039;
	option &#039;ipaddr&#039; &#039;127.0.0.1&#039;
	option &#039;netmask&#039; &#039;255.0.0.0&#039;

config &#039;interface&#039; &#039;lan&#039;
	option &#039;type&#039; &#039;bridge&#039;
	option &#039;ifname&#039; &#039;eth1.0&#039;
	option &#039;proto&#039; &#039;static&#039;
	option &#039;macaddr&#039; &#039;xx:xx:xx:xx:xx:xx&#039;
	option &#039;netmask&#039; &#039;255.255.255.0&#039;
	option &#039;nat&#039; &#039;1&#039;
	option &#039;mtu&#039; &#039;1500&#039;
	option &#039;defaultroute&#039; &#039;0&#039;
	option &#039;peerdns&#039; &#039;0&#039;
	option &#039;ipaddr&#039; &#039;172.16.1.1&#039;

config &#039;interface&#039; &#039;wan&#039;
	option &#039;ifname&#039; &#039;eth1.1&#039;
	option &#039;mtu&#039; &#039;1500&#039;
	option &#039;proto&#039; &#039;dhcp&#039;
</pre>
</td>
	</tr>
</table></div>

</div>

<h3 class="sectionedit23" id="adsl_driver_status">ADSL driver status</h3>
<div class="level3">

<p>
Take a look at the topic in the forum:
<a href="https://forum.openwrt.org/viewtopic.php?id=24271" class="urlextern" title="https://forum.openwrt.org/viewtopic.php?id=24271"  rel="nofollow">BCM 63xx chips - ADSL State of art</a>.
</p>

<p>
Somehow ADSL source code leaked to public. It is not free software, of course, so it&#039;s pretty much unusable.
</p>

</div>

<h3 class="sectionedit24" id="wi-fi_80211g_stability_problem">Wi-Fi 802.11g Stability Problem</h3>
<div class="level3">

<p>
AP mode in BCM4318 is not officially supported. Due to a bug in b43 kernel module there may be packet loss and chip lockup at high transmission rates:
</p>

<p>
<a href="http://linuxwireless.org/en/users/Drivers/b43#Known_issues" class="urlextern" title="http://linuxwireless.org/en/users/Drivers/b43#Known_issues"  rel="nofollow">http://linuxwireless.org/en/users/Drivers/b43#Known_issues</a>
</p>

<p>
<a href="https://forum.openwrt.org/viewtopic.php?id=24208" class="urlextern" title="https://forum.openwrt.org/viewtopic.php?id=24208"  rel="nofollow">https://forum.openwrt.org/viewtopic.php?id=24208</a>
</p>

<p>
I don&#039;t experience this problem in 802.11b mode.
</p>

<p>
Also take a look at OpenFWWF project: <a href="http://www.ing.unibs.it/openfwwf/" class="urlextern" title="http://www.ing.unibs.it/openfwwf/"  rel="nofollow">http://www.ing.unibs.it/openfwwf/</a>
</p>

</div>

<h2 class="sectionedit25" id="notes">Notes</h2>
<div class="level2">

<p>
The original <abbr title="GNU General Public License">GPL</abbr> sourcecode v1.00 can be downloaded <a href="ftp://ftp.dlink.ru/pub/ADSL/GPL_source_code/RU_DSL-2640U/RU_DSL-2640U_3-06-04-3C_GPL.tar.gz" class="urlextern" title="ftp://ftp.dlink.ru/pub/ADSL/GPL_source_code/RU_DSL-2640U/RU_DSL-2640U_3-06-04-3C_GPL.tar.gz"  rel="nofollow">Here</a> <a href="ftp://ftp.dlink.ru/pub/ADSL/GPL_source_code/DSL-2640U_BRU_D/DLink_DSL-2640U_RU_1.10_GPL.tar.gz" class="urlextern" title="ftp://ftp.dlink.ru/pub/ADSL/GPL_source_code/DSL-2640U_BRU_D/DLink_DSL-2640U_RU_1.10_GPL.tar.gz"  rel="nofollow">Here</a>. It consist on a Linux 2.? kernel with binary Broadcom tools&amp;drivers and sourcecode of the kernel and the rest of tools.
</p>

</div>

<h2 class="sectionedit26" id="debricking">Debricking</h2>
<div class="level2">

<p>
Contrary to the generic debrick guidelines at <a href="../../doc/howto/generic.failsafe" class="urlextern" title="http://wiki.openwrt.org/doc/howto/generic.failsafe"  rel="nofollow">http://wiki.openwrt.org/doc/howto/generic.failsafe</a>
</p>

<p>
An EU version of the DSL-2640U(B) using the preparation firmware EU_DSL-2640B_EU_4.00_310022.wrt linked on <a href="https://dev.openwrt.org/ticket/5472" class="urlextern" title="https://dev.openwrt.org/ticket/5472"  rel="nofollow">https://dev.openwrt.org/ticket/5472</a>, followed by an OpenWrt installation via tftp, means that debrick can be achieved as follows.
</p>
<ol>
<li class="level1"><div class="li"> Press in the reset button at the back - keep pressed</div>
</li>
<li class="level1"><div class="li"> Power recycle the unit</div>
</li>
<li class="level1"><div class="li"> Release the reset button</div>
</li>
</ol>

<p>
You can now reload the D-Link firmware through a web browser via <a href="http://192.168.1.1/" class="urlextern" title="http://192.168.1.1/"  rel="nofollow">http://192.168.1.1/</a> regardless of what your previous IP was.
</p>

</div>

<h2 class="sectionedit27" id="tags">Tags</h2>
<div class="level2">
<div class="tags"><span>
	<a href="../../tag/bcm63xx?do=showtag&amp;tag=bcm63xx" class="wikilink1" title="tag:bcm63xx" rel="tag">bcm63xx</a>,
	<a href="../../tag/bcm6348?do=showtag&amp;tag=bcm6348" class="wikilink1" title="tag:bcm6348" rel="tag">bcm6348</a>
</span></div>

</div>

                    <!-- wikipage stop -->
                                    </div>

                <div class="docInfo"><bdi>toh/d-link/dsl-2640u.txt</bdi> · Last modified: 2015/01/03 22:41 by <bdi>m1bxd</bdi></div>

                            </div></div><!-- /content -->

            <hr class="a11y" />

            <!-- PAGE ACTIONS -->
            <div id="dokuwiki__pagetools">
                <h3 class="a11y">Page Tools</h3>
                <div class="tools">
                    <ul>
                        <li><a href="dsl-2640u?do=edit"  class="action source" accesskey="v" rel="nofollow" title="Show pagesource [V]"><span>Show pagesource</span></a></li><li><a href="dsl-2640u?do=revisions"  class="action revs" accesskey="o" rel="nofollow" title="Old revisions [O]"><span>Old revisions</span></a></li><li><a href="dsl-2640u?do=backlink"  class="action backlink" rel="nofollow" title="Backlinks"><span>Backlinks</span></a></li><li><a href="dsl-2640u#dokuwiki__top"  class="action top" accesskey="t" rel="nofollow" title="Back to top [T]"><span>Back to top</span></a></li>                    </ul>
                </div>
            </div>
        </div><!-- /wrapper -->

        
<!-- ********** FOOTER ********** -->
<div id="dokuwiki__footer"><div class="pad">
    <div class="license">Except where otherwise noted, content on this wiki is licensed under the following license: <bdi><a href="http://creativecommons.org/licenses/by-nc-sa/3.0/" rel="license" class="urlextern">CC Attribution-Noncommercial-Share Alike 3.0 Unported</a></bdi></div>
    <div class="buttons">
        <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/" rel="license"><img src="../../lib/images/license/button/cc-by-nc-sa.png" alt="CC Attribution-Noncommercial-Share Alike 3.0 Unported" /></a>        <a href="http://www.dokuwiki.org/donate" title="Donate" ><img
            src="../../lib/tpl/openwrt/images/button-donate.gif" width="80" height="15" alt="Donate" /></a>
        <a href="http://www.php.net" title="Powered by PHP" ><img
            src="../../lib/tpl/openwrt/images/button-php.gif" width="80" height="15" alt="Powered by PHP" /></a>
        <a href="http://validator.w3.org/check/referer" title="Valid HTML5" ><img
            src="../../lib/tpl/openwrt/images/button-html5.png" width="80" height="15" alt="Valid HTML5" /></a>
        <a href="http://jigsaw.w3.org/css-validator/check/referer?profile=css3" title="Valid CSS" ><img
            src="../../lib/tpl/openwrt/images/button-css.png" width="80" height="15" alt="Valid CSS" /></a>
        <a href="http://dokuwiki.org/" title="Driven by DokuWiki" ><img
            src="../../lib/tpl/openwrt/images/button-dw.png" width="80" height="15" alt="Driven by DokuWiki" /></a>
    </div>
</div></div><!-- /footer -->

    </div></div><!-- /site -->

    <div class="no"><img src="../../lib/exe/indexer.php?id=toh%253Ad-link%253Adsl-2640u&amp;1432266223" width="2" height="1" alt="" /></div>
    <div id="screen__mode" class="no"></div>    <!--[if ( lte IE 7 | IE 8 ) ]></div><![endif]-->
</body>
</html>
