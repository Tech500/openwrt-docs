<!DOCTYPE html>
<html lang="en" dir="ltr" class="no-js">
<head>
    <meta charset="utf-8" />
    <title>Ubiquiti UniFi AP [OpenWrt Wiki]</title>
    <script>(function(H){H.className=H.className.replace(/\bno-js\b/,'js')})(document.documentElement)</script>
    <meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="keywords" content="toh,ubiquiti,unifi"/>
<link rel="search" type="application/opensearchdescription+xml" href="../../lib/exe/opensearch.php" title="OpenWrt Wiki"/>
<link rel="start" href="../../index.html"/>
<link rel="contents" href="unifi?do=index" title="Sitemap"/>
<link rel="alternate" type="application/rss+xml" title="Recent changes" href="../../feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Current namespace" href="../../feed.php?mode=list&amp;ns=toh:ubiquiti"/>
<link rel="alternate" type="text/html" title="Plain HTML" href="../../_export/xhtml/toh/ubiquiti/unifi"/>
<link rel="alternate" type="text/plain" title="Wiki Markup" href="../../_export/raw/toh/ubiquiti/unifi"/>
<link rel="canonical" href="unifi"/>
<link rel="stylesheet" type="text/css" href="../../lib/exe/css.php?t=openwrt&amp;tseed=6f44f363dc87908d905dc56ff3acbfc4"/>
<script type="text/javascript">/*<![CDATA[*/var NS='toh:ubiquiti';var JSINFO = {"id":"toh:ubiquiti:unifi","namespace":"toh:ubiquiti"};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="../../lib/exe/js.php?tseed=6f44f363dc87908d905dc56ff3acbfc4"></script>
<script type="text/javascript" charset="utf-8">/*<![CDATA[*/jQuery(function(){
	for ( i=0; i < document.forms.length; i++ ) {
		if (document.forms[i].method == 'post') {
			var myElement = document.createElement('input');
			myElement.setAttribute('type', 'hidden');
			myElement.name = 'bb2_screener_';
			myElement.value = '1432266264 166.182.3.99';
			document.forms[i].appendChild(myElement);
		}
	}
});
/*!]]>*/</script>
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <link rel="shortcut icon" href="../../lib/tpl/openwrt/images/favicon.ico" />
<link rel="apple-touch-icon" href="../../lib/tpl/openwrt/images/apple-touch-icon.png" />
    </head>

<body>
    <!--[if lte IE 7 ]><div id="IE7"><![endif]--><!--[if IE 8 ]><div id="IE8"><![endif]-->
    <div id="dokuwiki__site"><div id="dokuwiki__top" class="site dokuwiki mode_show tpl_openwrt     ">

        
<!-- ********** HEADER ********** -->
<div id="dokuwiki__header"><div class="pad group">

    
    <div class="headings group">
        <ul class="a11y skip">
            <li><a href="unifi#dokuwiki__content">skip to content</a></li>
        </ul>

        <h1><a href="../../start"  accesskey="h" title="[H]"><img src="../../lib/tpl/openwrt/images/logo.png" width="386" height="98" alt="" /> <span>OpenWrt Wiki</span></a></h1>
            </div>

    <div class="tools group">
        <!-- USER TOOLS -->
                    <div id="dokuwiki__usertools">
                <h3 class="a11y">User Tools</h3>
                <ul>
                    <li><a href="unifi?do=register"  class="action register" rel="nofollow" title="Register">Register</a></li><li><a href="unifi?do=login&amp;sectok=382740b13d95f946eed36caa57076b4a"  class="action login" rel="nofollow" title="Login">Login</a></li>                </ul>
            </div>
        
        <!-- SITE TOOLS -->
        <div id="dokuwiki__sitetools">
            <h3 class="a11y">Site Tools</h3>
            <form action="../../start" accept-charset="utf-8" class="search" id="dw__search" method="get" role="search"><div class="no"><input type="hidden" name="do" value="search" /><input type="text" id="qsearch__in" accesskey="f" name="id" class="edit" title="[F]" /><input type="submit" value="Search" class="button" title="Search" /><div id="qsearch__out" class="ajax_qsearch JSpopup"></div></div></form>            <div class="mobileTools">
                <form action="../../doku.php" method="get" accept-charset="utf-8"><div class="no"><input type="hidden" name="id" value="toh:ubiquiti:unifi" /><select name="do" class="edit quickselect" title="Tools"><option value="">Tools</option><optgroup label="Page Tools"><option value="edit">Show pagesource</option><option value="revisions">Old revisions</option><option value="backlink">Backlinks</option></optgroup><optgroup label="Site Tools"><option value="recent">Recent changes</option><option value="media">Media Manager</option><option value="index">Sitemap</option></optgroup><optgroup label="User Tools"><option value="login">Login</option><option value="register">Register</option></optgroup></select><input type="submit" value="&gt;" /></div></form>            </div>
            <ul>
                <li><a href="unifi?do=recent"  class="action recent" accesskey="r" rel="nofollow" title="Recent changes [R]">Recent changes</a></li><li><a href="unifi?do=media&amp;ns=toh%253Aubiquiti"  class="action media" rel="nofollow" title="Media Manager">Media Manager</a></li><li><a href="unifi?do=index"  class="action index" accesskey="x" rel="nofollow" title="Sitemap [X]">Sitemap</a></li>            </ul>
        </div>

    </div>

    <!-- BREADCRUMBS -->
            <div class="breadcrumbs">
                            <div class="youarehere"><span class="bchead">You are here: </span><span class="home"><bdi><a href="../../start" class="wikilink1" title="start">OpenWrt Wiki</a></bdi></span> » <bdi><a href="../start" class="wikilink1" title="toh:start">Table of Hardware</a></bdi> » <bdi><a href="start" class="wikilink1" title="toh:ubiquiti:start">Ubiquiti</a></bdi> » <bdi><span class="curid"><a href="unifi" class="wikilink1" title="toh:ubiquiti:unifi">Ubiquiti UniFi AP</a></span></bdi></div>
                                    <div class="plugin_multilingual">
        <ul>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/cz/toh/ubiquiti/unifi" class="media" title="cz:toh:ubiquiti:unifi"><img src="../../lib/exe/fetch.php?cache=&amp;tok=aff589&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fcz.gif" class="media" title="Čeština (Czech)" alt="Čeština (Czech)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/de/toh/ubiquiti/unifi" class="media" title="de:toh:ubiquiti:unifi"><img src="../../lib/exe/fetch.php?cache=&amp;tok=e24010&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fde.gif" class="media" title="Deutsch (German)" alt="Deutsch (German)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <span class="curid"><a href="unifi" class="media" title="toh:ubiquiti:unifi"><img src="../../lib/exe/fetch.php?cache=&amp;tok=2a37ae&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fgb.gif" class="media" title="English" alt="English" /></a></span>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/es/toh/ubiquiti/unifi" class="media" title="es:toh:ubiquiti:unifi"><img src="../../lib/exe/fetch.php?cache=&amp;tok=46c004&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fmx.gif" class="media" title="Español (Spanish, Mexico)" alt="Español (Spanish, Mexico)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/fr/toh/ubiquiti/unifi" class="media" title="fr:toh:ubiquiti:unifi"><img src="../../lib/exe/fetch.php?cache=&amp;tok=a5beba&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Ffr.gif" class="media" title="Français (French)" alt="Français (French)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/hu/toh/ubiquiti/unifi" class="media" title="hu:toh:ubiquiti:unifi"><img src="../../lib/exe/fetch.php?cache=&amp;tok=6b5470&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fhu.gif" class="media" title="Magyar (Hungarian)" alt="Magyar (Hungarian)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/jp/toh/ubiquiti/unifi" class="media" title="jp:toh:ubiquiti:unifi"><img src="../../lib/exe/fetch.php?cache=&amp;tok=f999fc&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fjp.gif" class="media" title="日本語 (Japanese)" alt="日本語 (Japanese)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/pl/toh/ubiquiti/unifi" class="media" title="pl:toh:ubiquiti:unifi"><img src="../../lib/exe/fetch.php?cache=&amp;tok=c805c0&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fpl.gif" class="media" title="Poliski (Polish)" alt="Poliski (Polish)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/pt-br/toh/ubiquiti/unifi" class="media" title="pt-br:toh:ubiquiti:unifi"><img src="../../lib/exe/fetch.php?cache=&amp;tok=13127d&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fbr.gif" class="media" title="Português brasileiro (Portuguese, Brasil)" alt="Português brasileiro (Portuguese, Brasil)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/ru/toh/ubiquiti/unifi" class="media" title="ru:toh:ubiquiti:unifi"><img src="../../lib/exe/fetch.php?cache=&amp;tok=66ab5e&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fru.gif" class="media" title="Русский (Russsian)" alt="Русский (Russsian)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/tr/toh/ubiquiti/unifi" class="media" title="tr:toh:ubiquiti:unifi"><img src="../../lib/exe/fetch.php?cache=&amp;tok=f4beed&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Ftr.gif" class="media" title="Tϋrkçe (Turkish)" alt="Tϋrkçe (Turkish)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/zh-cn/toh/ubiquiti/unifi" class="media" title="zh-cn:toh:ubiquiti:unifi"><img src="../../lib/exe/fetch.php?cache=&amp;tok=93625a&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fzh-cn.gif" class="media" title="官話/官话 (Chinese)" alt="官話/官话 (Chinese)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/zh-tw/toh/ubiquiti/unifi" class="media" title="zh-tw:toh:ubiquiti:unifi"><img src="../../lib/exe/fetch.php?cache=&amp;tok=b56198&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fzh-tw.gif" class="media" title="臺灣華語 (Taiwanese)" alt="臺灣華語 (Taiwanese)" /></a>
              </div>
            </div>
          </li>
        </ul>
      </div>
        </div>
    
    
    <hr class="a11y" />
</div></div><!-- /header -->

        <div class="wrapper group">

            
            <!-- ********** CONTENT ********** -->
            <div id="dokuwiki__content"><div class="pad group">

                <div class="pageId"><span>toh:ubiquiti:unifi</span></div>

                <div class="page group">
                                                            <!-- wikipage start -->
                    <!-- TOC START -->
<div id="dw__toc">
<h3 class="toggle">Table of Contents</h3>
<div>

<ul class="toc">
<li class="level1"><div class="li"><a href="unifi#hardware">Hardware</a></div></li>
<li class="level1"><div class="li"><a href="unifi#status">Status</a></div></li>
<li class="level1"><div class="li"><a href="unifi#installing_a_new_firmware_image">Installing a new Firmware Image</a></div></li>
<li class="level1"><div class="li"><a href="unifi#upgrading_openwrt">Upgrading OpenWRT</a></div></li>
<li class="level1"><div class="li"><a href="unifi#serial">Serial</a></div></li>
<li class="level1"><div class="li"><a href="unifi#jtag">JTAG</a></div></li>
</ul>
</div>
</div>
<!-- TOC END -->

<h1 class="sectionedit1" id="ubiquiti_unifi_ap">Ubiquiti UniFi AP</h1>
<div class="level1">

</div>

<h2 class="sectionedit2" id="hardware">Hardware</h2>
<div class="level2">
<div class="table sectionedit3"><table class="inline">
	<tr class="row0">
		<td class="col0"> <strong>Architecture:</strong> MIPS </td>
	</tr>
	<tr class="row1">
		<td class="col0"> <strong>Vendor:</strong> Atheros </td>
	</tr>
	<tr class="row2">
		<td class="col0"> <strong>Bootloader:</strong> U-boot </td>
	</tr>
	<tr class="row3">
		<td class="col0"> <strong>System-On-Chip:</strong> Atheros (AR7240) </td>
	</tr>
	<tr class="row4">
		<td class="col0"> <strong>CPU Speed:</strong> 400 Mhz </td>
	</tr>
	<tr class="row5">
		<td class="col0"> <strong>Flash-Chip:</strong> <a href="http://www.macronix.com/QuickPlace/hq/PageLibrary4825740B00298A3B.nsf/$defaultview/7CE3021F57B8EA4848257412002E26CC/$File/PCN21_3V%206405D%20SPI.pdf?OpenElement" class="urlextern" title="http://www.macronix.com/QuickPlace/hq/PageLibrary4825740B00298A3B.nsf/$defaultview/7CE3021F57B8EA4848257412002E26CC/$File/PCN21_3V%206405D%20SPI.pdf?OpenElement"  rel="nofollow">MX25L6405D</a> </td>
	</tr>
	<tr class="row6">
		<td class="col0"> <strong>Flash size:</strong> 8 MiB </td>
	</tr>
	<tr class="row7">
		<td class="col0"> <strong>RAM:</strong> 64 MiB DDR </td>
	</tr>
	<tr class="row8">
		<td class="col0"> <strong>Wireless:</strong> AR9287 </td>
	</tr>
	<tr class="row9">
		<td class="col0"> <strong>Switch:</strong> none </td>
	</tr>
	<tr class="row10">
		<td class="col0"> <strong>Ethernet ports:</strong> 1x Gigabit, POE capable</td>
	</tr>
	<tr class="row11">
		<td class="col0"> <strong>USB:</strong> No <sup><a href="unifi#fn__1" id="fnt__1" class="fn_top">1)</a></sup> </td>
	</tr>
	<tr class="row12">
		<td class="col0"> <strong>Serial:</strong> <a href="http://wiki.openwrt.org/doc/hardware/serial.cable" class="wikilink2" title="doc:hardware:serial.cable" rel="nofollow">Yes</a>, <a href="unifi#serial_settings" title="toh:ubiquiti:unifi ↵" class="wikilink1">settings</a> </td>
	</tr>
	<tr class="row13">
		<td class="col0"> <strong>JTAG:</strong> <a href="http://wiki.openwrt.org/doc/hardware/jtag.cable" class="wikilink2" title="doc:hardware:jtag.cable" rel="nofollow">Yes</a> </td>
	</tr>
</table></div>

</div>

<h1 class="sectionedit4" id="hardware_photo">Hardware Photo</h1>
<div class="level1">

<p>
<a href="../../_detail/toh/ubiquiti/unifi_ap.jpg?id=toh%253Aubiquiti%253Aunifi" class="media" title="toh:ubiquiti:unifi_ap.jpg"><img src="../../_media/toh/ubiquiti/unifi_ap.jpg?w=300&amp;tok=74cdda" class="media" alt="" width="300" /></a> <a href="../../_detail/toh/ubiquiti/unifi_case.png?id=toh%253Aubiquiti%253Aunifi" class="media" title="toh:ubiquiti:unifi_case.png"><img src="../../_media/toh/ubiquiti/unifi_case.png?w=225&amp;tok=3b4d98" class="media" alt="" width="225" /></a><br/>

<em>Click to zoom</em>
</p>

</div>

<h2 class="sectionedit5" id="status">Status</h2>
<div class="level2">

<p>
Since <a href="https://dev.openwrt.org/changeset/23904" class="urlextern" title="https://dev.openwrt.org/changeset/23904"  rel="nofollow">r23904</a> this device is supported in trunk and in future stable release.<br/>

12.09 includes this AP as stable.
</p>

<p>
Barrier Breaker 14.07 <a href="https://downloads.openwrt.org/barrier_breaker/14.07/ar71xx/generic/openwrt-ar71xx-generic-ubnt-unifi-squashfs-factory.bin" class="urlextern" title="https://downloads.openwrt.org/barrier_breaker/14.07/ar71xx/generic/openwrt-ar71xx-generic-ubnt-unifi-squashfs-factory.bin"  rel="nofollow">openwrt-ar71xx-generic-ubnt-unifi-squashfs-factory.bin</a> works out of the box, no need to change XM/BZ for the firmware image. Configurations then can be changed right away using LuCi.
</p>

</div>

<h2 class="sectionedit6" id="installing_a_new_firmware_image">Installing a new Firmware Image</h2>
<div class="level2">
<ol>
<li class="level1"><div class="li"> Device get IP address from DHCP</div>
</li>
<li class="level1"><div class="li"> Login inside the AP with ssh ubnt@ip_address (password ubnt)</div>
</li>
<li class="level1"><div class="li"> Find the image like &quot;openwrt-ar71xx-ubnt-unifi-*-factory.bin&quot; on openwrt binary repository and download inside /tmp.</div>
</li>
<li class="level1"><div class="li"> Use the ubiquity fwupgrade utils to reflash it: <pre class="code">fwupdate.real -m openwrt-ar71xx-ubnt-unifi-*-factory.bin -d</pre>
</div>
</li>
</ol>

<p>
fwupdate.real can complain about the version of the firmware image, because it is built with prefix &quot;XM&quot; instead of the &quot;BZ&quot; of the unifi image (trunk r38381 works). To change you will have to download the OpenWRT Image builder, patch the Makefile at target/linux/ar71xx/image (replace XM with BZ around line 844: 
<pre class="code">$(eval $(call SingleProfile,UBNTXM,$(fs_64k),UBNTUNIFI,ubnt-unifi,UBNT-UF,ttyS0,115200,XM,BZ,ar7240))
make image PROFILE=UBNTUNIFI </pre>

Or just replace characters 4-6 in the firmware image file 
</p>

</div>

<h2 class="sectionedit7" id="upgrading_openwrt">Upgrading OpenWRT</h2>
<div class="level2">

<p>
If you have already installed OpenWrt and like to reflash for e.g. upgrading to a new OpenWrt version you can upgrade using the sysupgrade command line tool. It is important that you put the firmware image into the ramdisk (/tmp) before you start flashing.
</p>

</div>

<h5 id="luci_web_upgrade_process">LuCI Web Upgrade Process</h5>
<div class="level5">
<ul>
<li class="level1"><div class="li"> Browse to <a href="http://192.168.1.1/cgi-bin/luci/mini/system/upgrade/" class="urlextern" title="http://192.168.1.1/cgi-bin/luci/mini/system/upgrade/"  rel="nofollow">http://192.168.1.1/cgi-bin/luci/mini/system/upgrade/</a> LuCI Upgrade <abbr title="Uniform Resource Locator">URL</abbr></div>
</li>
<li class="level1"><div class="li"> Upload &quot;openwrt-ar71xx-ubnt-unifi-*-sysupgrade.bin&quot; file to LuCI</div>
</li>
<li class="level1"><div class="li"> Wait for reboot</div>
</li>
</ul>

</div>

<h5 id="terminal_upgrade_process">Terminal Upgrade Process</h5>
<div class="level5">
<ul>
<li class="level1"><div class="li"> Login as root via SSH on your access point ip</div>
</li>
<li class="level1"><div class="li"> Use the following commands to upgrade: <pre class="code">cd /tmp/
wget http://downloads.openwrt.org/.../openwrt-ar71xx-ubnt-unifi-*-sysupgrade.bin
sysupgrade -i /tmp/openwrt-ar71xx-ubnt-unifi-*-sysupgrade.bin</pre>
</div>
</li>
</ul>

<p>

<a name="serial_settings">

</p>

</div>

<h2 class="sectionedit8" id="serial">Serial</h2>
<div class="level2">

<p>
A male-strip is on board to connect your TTL capable serial converter.
Use the following settings: 115200 8N1.
</p>

<p>
<a href="../../_detail/toh/ubiquiti/unifi_serial.png?id=toh%253Aubiquiti%253Aunifi" class="media" title="toh:ubiquiti:unifi_serial.png"><img src="../../_media/toh/ubiquiti/unifi_serial.png?w=100&amp;h=120&amp;tok=580a78" class="media" alt="" width="100" height="120" /></a><br/>

<em>Click to zoom</em>
</p>

</div>

<h2 class="sectionedit9" id="jtag">JTAG</h2>
<div class="level2">

<p>
How to connect to JTAG interface, and how to reflash the device with <a href="http://downloads.openwrt.org/tools/oem/jtag/tools.zip" class="urlextern" title="http://downloads.openwrt.org/tools/oem/jtag/tools.zip"  rel="nofollow">JTAG tools</a>
</p>

<p>
See <a href="../../doc/hardware/port.jtag" class="wikilink1" title="doc:hardware:port.jtag">port.jtag</a> for more JTAG details.
</p>

</div>

<h1 class="sectionedit10" id="specific_configuration">Specific Configuration</h1>
<div class="level1">

<p>
The UniFi ap has 2 leds, the orange one can be configured adding something like:
<pre class="code">config &#039;led&#039;
	option &#039;name&#039; &#039;lan&#039;
	option &#039;sysfs&#039; &#039;ubnt:orange:dome&#039;
	option &#039;trigger&#039; &#039;netdev&#039;
	option &#039;dev&#039; &#039;br-lan&#039;
	option &#039;mode&#039; &#039;tx rx&#039; </pre>

at the end of <em>/etc/config/system</em>
</p>

<p>
Also its possible to change the led status manually. 
</p>
<ol>
<li class="level1"><div class="li"> static, use 1 for on, 0 for off: <pre class="code shell">echo 1 &gt; /sys/class/leds/ubnt\:orange\:dome/brightness
echo 1 &gt; /sys/class/leds/ubnt\:green\:dome/brightness
echo 0 &gt; /sys/class/leds/ubnt\:green\:dome/brightness
echo 0 &gt; /sys/class/leds/ubnt\:orange\:dome/brightness</pre>
</div>
</li>
<li class="level1"><div class="li"> blinking</div>
<ol>
<li class="level2"><div class="li"> blinking on, interval 1000ms, orange led: <pre class="code shell">echo timer &gt; /sys/class/leds/ubnt\:orange\:dome/trigger
echo 1000 &gt; /sys/class/leds/ubnt\:orange\:dome/delay_on
echo 1000 &gt; /sys/class/leds/ubnt\:orange\:dome/delay_off</pre>
</div>
</li>
<li class="level2"><div class="li"> blinking off: <pre class="code shell">echo 0 &gt; /sys/class/leds/ubnt\:orange\:dome/delay_off</pre>
</div>
</li>
</ol>
</li>
</ol>

</div>

<h1 class="sectionedit11" id="network_configuration_unifi_as_standalone_wireless_router">Network configuration  (Unifi as standalone wireless Router)</h1>
<div class="level1">

<p>
The UniFi has only the single ethernet port, so much of the OpenWrt documentation is a little confusing.  Most of the documentation is written with the idea of routers which have a WAN port, a <abbr title="Local Area Network">LAN</abbr> wired switch and the WLAN wireless.  Clearly the Unifi doesn&#039;t have the wired <abbr title="Local Area Network">LAN</abbr> switch.
</p>

<p>
After flashing (I found r41163 worked while the 12.09 version had the XM problem discussed above and editing the characters 4-6 didn&#039;t fix it) I was able to connect via wired ethernet as described in FirstLogin (i.e. there is a DHCP server handing out IPs in the 192.168.1.X subnet, running on the ethernet port).
</p>

<p>
After changing the password and exiting, I had to wait a while (60 secs?) until I could ssh back into the box. That was strange because I thought I&#039;d lost networking … I think that is due to a long-running first time ssh key generation.  Even so, each ssh in takes a long time to respond (something about recent versions of dropbear taking a long time to setup a session key). I found LUCI not installed, so I had to work to get internet access on the box before I could use that.
</p>

<p>
Once ssh&#039;d into the box I followed these steps: 
1. Enable wireless, using commands at top of <a href="../../doc/uci/wireless" class="urlextern" title="http://wiki.openwrt.org/doc/uci/wireless"  rel="nofollow">the UCI wireless config page</a>. This enables the radio.  The radio is bridged to the lan network.
2. Connect to the wireless network, disconnect the wired from your computer, and ensure that you can ssh in via the wifi.
3. Swap eth0 and eth1 between lan and wan. The default configuration has the ethernet port on the lan network.  But if you are going to plug the Unifi into a cable modem (for example) to use it as a router, then you want the ethernet port to be the wan network (and to seek a dhcp assigned address).  I edited the /etc/config/wireless file changing etho in the lan section to eth1, and eth0 in the wan section to eth1.  Quite honestly I&#039;m not sure that this is perfect (since there isn&#039;t an eth1 on the Unifi, but it worked for me).
4. Restart networking (/etc/inid.d/networking restart)
5. Connect the ethernet lan on the PoE injector to the cable modem.  Remember nonsense about having cable modem off for 20 seconds or so to give out an IP to a new MAC address.
6.  Connect back to the OpenWrt Wifi.
7.  ping google.com.  yay. 
</p>

<p>
At this point things are working with NAT routing between the lan and the wan.
</p>

<p>
 	root@OpenWrt:~# cat /etc/config/network
</p>
<pre class="code">config interface &#039;loopback&#039;
	option ifname &#039;lo&#039;
	option proto &#039;static&#039;
	option ipaddr &#039;127.0.0.1&#039;
	option netmask &#039;255.0.0.0&#039;</pre>
<pre class="code">config globals &#039;globals&#039;
	option ula_prefix &#039;fd18:37f2:587f::/48&#039;</pre>
<pre class="code">config interface &#039;lan&#039;
	option ifname &#039;eth1&#039;
	option force_link &#039;1&#039;
	option type &#039;bridge&#039;
	option proto &#039;static&#039;
	option ipaddr &#039;192.168.1.1&#039;
	option netmask &#039;255.255.255.0&#039;
	option ip6assign &#039;60&#039;</pre>
<pre class="code">config interface &#039;wan&#039;
	option ifname &#039;eth0&#039;
	option proto &#039;dhcp&#039;</pre>
<pre class="code">config interface &#039;wan6&#039;
	option ifname &#039;@wan&#039;
	option proto &#039;dhcpv6&#039;</pre>
<pre class="code">root@OpenWrt:~# ifconfig
br-lan    Link encap:Ethernet  HWaddr DC:9F:DB:EB:19:24
          inet addr:192.168.1.1  Bcast:192.168.1.255  Mask:255.255.255.0
          inet6 addr: fd18:37f2:587f::1/60 Scope:Global
          inet6 addr: 2605:6000:1018:5f::1/64 Scope:Global
          inet6 addr: fe80::de9f:dbff:feeb:1924/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:35879 errors:0 dropped:0 overruns:0 frame:0
          TX packets:64154 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:7629054 (7.2 MiB)  TX bytes:76188963 (72.6 MiB)</pre>
<pre class="code">eth0      Link encap:Ethernet  HWaddr DC:9F:DB:EA:19:24
          inet addr:70.113.82.54  Bcast:70.113.95.255  Mask:255.255.224.0
          inet6 addr: 2605:6000:ffc0:60:1406:59bd:ae45:b383/128 Scope:Global
          inet6 addr: fe80::de9f:dbff:feea:1924/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:88136 errors:0 dropped:1 overruns:0 frame:0
          TX packets:36148 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:78402192 (74.7 MiB)  TX bytes:8333999 (7.9 MiB)
          Interrupt:4</pre>
<pre class="code">lo        Link encap:Local Loopback
          inet addr:127.0.0.1  Mask:255.0.0.0
          inet6 addr: ::1/128 Scope:Host
          UP LOOPBACK RUNNING  MTU:65536  Metric:1
          RX packets:16092 errors:0 dropped:0 overruns:0 frame:0
          TX packets:16092 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:1137726 (1.0 MiB)  TX bytes:1137726 (1.0 MiB)</pre>
<pre class="code">wlan0     Link encap:Ethernet  HWaddr DC:9F:DB:EB:19:24
          inet6 addr: fe80::de9f:dbff:feeb:1924/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:35881 errors:0 dropped:0 overruns:0 frame:0
          TX packets:65056 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:8131532 (7.7 MiB)  TX bytes:77645373 (74.0 MiB)</pre>

</div>

<h1 class="sectionedit12" id="putting_unifi_into_failsafe_mode">Putting Unifi into failsafe mode</h1>
<div class="level1">

<p>
Also useful to know how to put the Unifi into failsafe mode.  I found that connecting the ethernet PoE cable to the Unifi, but removing it from the injector, then pushing a pin into the hole next to the ethernet connection on the Unifi, digging around until you feel a button press (it seems easy to miss) and holding it down with one hand while connecting the cable into the PoE injector and then holding for about 8 seconds, until the led lights up.  When the Unifi was in failsafe I had blinking green led lights (sometimes really quickly, sometimes slowly). 
</p>

</div>
<div class="footnotes">
<div class="fn"><sup><a href="unifi#fnt__1" id="fn__1" class="fn_bot">1)</a></sup> 
but <a href="https://forum.openwrt.org/viewtopic.php?pid=109825#p109825" class="urlextern" title="https://forum.openwrt.org/viewtopic.php?pid=109825#p109825"  rel="nofollow">hackable</a></div>
</div>

                    <!-- wikipage stop -->
                                    </div>

                <div class="docInfo"><bdi>toh/ubiquiti/unifi.txt</bdi> · Last modified: 2015/03/12 04:16 by <bdi>kls</bdi></div>

                            </div></div><!-- /content -->

            <hr class="a11y" />

            <!-- PAGE ACTIONS -->
            <div id="dokuwiki__pagetools">
                <h3 class="a11y">Page Tools</h3>
                <div class="tools">
                    <ul>
                        <li><a href="unifi?do=edit"  class="action source" accesskey="v" rel="nofollow" title="Show pagesource [V]"><span>Show pagesource</span></a></li><li><a href="unifi?do=revisions"  class="action revs" accesskey="o" rel="nofollow" title="Old revisions [O]"><span>Old revisions</span></a></li><li><a href="unifi?do=backlink"  class="action backlink" rel="nofollow" title="Backlinks"><span>Backlinks</span></a></li><li><a href="unifi#dokuwiki__top"  class="action top" accesskey="t" rel="nofollow" title="Back to top [T]"><span>Back to top</span></a></li>                    </ul>
                </div>
            </div>
        </div><!-- /wrapper -->

        
<!-- ********** FOOTER ********** -->
<div id="dokuwiki__footer"><div class="pad">
    <div class="license">Except where otherwise noted, content on this wiki is licensed under the following license: <bdi><a href="http://creativecommons.org/licenses/by-nc-sa/3.0/" rel="license" class="urlextern">CC Attribution-Noncommercial-Share Alike 3.0 Unported</a></bdi></div>
    <div class="buttons">
        <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/" rel="license"><img src="../../lib/images/license/button/cc-by-nc-sa.png" alt="CC Attribution-Noncommercial-Share Alike 3.0 Unported" /></a>        <a href="http://www.dokuwiki.org/donate" title="Donate" ><img
            src="../../lib/tpl/openwrt/images/button-donate.gif" width="80" height="15" alt="Donate" /></a>
        <a href="http://www.php.net" title="Powered by PHP" ><img
            src="../../lib/tpl/openwrt/images/button-php.gif" width="80" height="15" alt="Powered by PHP" /></a>
        <a href="http://validator.w3.org/check/referer" title="Valid HTML5" ><img
            src="../../lib/tpl/openwrt/images/button-html5.png" width="80" height="15" alt="Valid HTML5" /></a>
        <a href="http://jigsaw.w3.org/css-validator/check/referer?profile=css3" title="Valid CSS" ><img
            src="../../lib/tpl/openwrt/images/button-css.png" width="80" height="15" alt="Valid CSS" /></a>
        <a href="http://dokuwiki.org/" title="Driven by DokuWiki" ><img
            src="../../lib/tpl/openwrt/images/button-dw.png" width="80" height="15" alt="Driven by DokuWiki" /></a>
    </div>
</div></div><!-- /footer -->

    </div></div><!-- /site -->

    <div class="no"><img src="../../lib/exe/indexer.php?id=toh%253Aubiquiti%253Aunifi&amp;1432266264" width="2" height="1" alt="" /></div>
    <div id="screen__mode" class="no"></div>    <!--[if ( lte IE 7 | IE 8 ) ]></div><![endif]-->
</body>
</html>
