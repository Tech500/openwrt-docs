<!DOCTYPE html>
<html lang="en" dir="ltr" class="no-js">
<head>
    <meta charset="utf-8" />
    <title>Iomega iConnect [OpenWrt Wiki]</title>
    <script>(function(H){H.className=H.className.replace(/\bno-js\b/,'js')})(document.documentElement)</script>
    <meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="keywords" content="toh,iomega,iconnect"/>
<link rel="search" type="application/opensearchdescription+xml" href="../../lib/exe/opensearch.php" title="OpenWrt Wiki"/>
<link rel="start" href="../../index.html"/>
<link rel="contents" href="http://wiki.openwrt.org/toh/iomega/iconnect?do=index" title="Sitemap"/>
<link rel="alternate" type="application/rss+xml" title="Recent changes" href="../../feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Current namespace" href="http://wiki.openwrt.org/feed.php?mode=list&amp;ns=toh:iomega"/>
<link rel="alternate" type="text/html" title="Plain HTML" href="http://wiki.openwrt.org/_export/xhtml/toh/iomega/iconnect"/>
<link rel="alternate" type="text/plain" title="Wiki Markup" href="http://wiki.openwrt.org/_export/raw/toh/iomega/iconnect"/>
<link rel="canonical" href="iconnect"/>
<link rel="stylesheet" type="text/css" href="../../lib/exe/css.php?t=openwrt&amp;tseed=6f44f363dc87908d905dc56ff3acbfc4"/>
<script type="text/javascript">/*<![CDATA[*/var NS='toh:iomega';var JSINFO = {"id":"toh:iomega:iconnect","namespace":"toh:iomega"};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="../../lib/exe/js.php?tseed=6f44f363dc87908d905dc56ff3acbfc4"></script>
<script type="text/javascript" charset="utf-8">/*<![CDATA[*/jQuery(function(){
	for ( i=0; i < document.forms.length; i++ ) {
		if (document.forms[i].method == 'post') {
			var myElement = document.createElement('input');
			myElement.setAttribute('type', 'hidden');
			myElement.name = 'bb2_screener_';
			myElement.value = '1432287319 166.182.3.91';
			document.forms[i].appendChild(myElement);
		}
	}
});
/*!]]>*/</script>
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <link rel="shortcut icon" href="../../lib/tpl/openwrt/images/favicon.ico" />
<link rel="apple-touch-icon" href="../../lib/tpl/openwrt/images/apple-touch-icon.png" />
    </head>

<body>
    <!--[if lte IE 7 ]><div id="IE7"><![endif]--><!--[if IE 8 ]><div id="IE8"><![endif]-->
    <div id="dokuwiki__site"><div id="dokuwiki__top" class="site dokuwiki mode_show tpl_openwrt     ">

        
<!-- ********** HEADER ********** -->
<div id="dokuwiki__header"><div class="pad group">

    
    <div class="headings group">
        <ul class="a11y skip">
            <li><a href="iconnect#dokuwiki__content">skip to content</a></li>
        </ul>

        <h1><a href="../../start"  accesskey="h" title="[H]"><img src="../../lib/tpl/openwrt/images/logo.png" width="386" height="98" alt="" /> <span>OpenWrt Wiki</span></a></h1>
            </div>

    <div class="tools group">
        <!-- USER TOOLS -->
                    <div id="dokuwiki__usertools">
                <h3 class="a11y">User Tools</h3>
                <ul>
                    <li><a href="http://wiki.openwrt.org/toh/iomega/iconnect?do=register"  class="action register" rel="nofollow" title="Register">Register</a></li><li><a href="http://wiki.openwrt.org/toh/iomega/iconnect?do=login&amp;sectok=382740b13d95f946eed36caa57076b4a"  class="action login" rel="nofollow" title="Login">Login</a></li>                </ul>
            </div>
        
        <!-- SITE TOOLS -->
        <div id="dokuwiki__sitetools">
            <h3 class="a11y">Site Tools</h3>
            <form action="../../start" accept-charset="utf-8" class="search" id="dw__search" method="get" role="search"><div class="no"><input type="hidden" name="do" value="search" /><input type="text" id="qsearch__in" accesskey="f" name="id" class="edit" title="[F]" /><input type="submit" value="Search" class="button" title="Search" /><div id="qsearch__out" class="ajax_qsearch JSpopup"></div></div></form>            <div class="mobileTools">
                <form action="../../doku.php" method="get" accept-charset="utf-8"><div class="no"><input type="hidden" name="id" value="toh:iomega:iconnect" /><select name="do" class="edit quickselect" title="Tools"><option value="">Tools</option><optgroup label="Page Tools"><option value="edit">Show pagesource</option><option value="revisions">Old revisions</option><option value="backlink">Backlinks</option></optgroup><optgroup label="Site Tools"><option value="recent">Recent changes</option><option value="media">Media Manager</option><option value="index">Sitemap</option></optgroup><optgroup label="User Tools"><option value="login">Login</option><option value="register">Register</option></optgroup></select><input type="submit" value="&gt;" /></div></form>            </div>
            <ul>
                <li><a href="http://wiki.openwrt.org/toh/iomega/iconnect?do=recent"  class="action recent" accesskey="r" rel="nofollow" title="Recent changes [R]">Recent changes</a></li><li><a href="http://wiki.openwrt.org/toh/iomega/iconnect?do=media&amp;ns=toh%3Aiomega"  class="action media" rel="nofollow" title="Media Manager">Media Manager</a></li><li><a href="http://wiki.openwrt.org/toh/iomega/iconnect?do=index"  class="action index" accesskey="x" rel="nofollow" title="Sitemap [X]">Sitemap</a></li>            </ul>
        </div>

    </div>

    <!-- BREADCRUMBS -->
            <div class="breadcrumbs">
                            <div class="youarehere"><span class="bchead">You are here: </span><span class="home"><bdi><a href="../../start" class="wikilink1" title="start">OpenWrt Wiki</a></bdi></span> » <bdi><a href="../start" class="wikilink1" title="toh:start">Table of Hardware</a></bdi> » <bdi><a href="http://wiki.openwrt.org/toh/iomega/start" class="wikilink2" title="toh:iomega:start" rel="nofollow">iomega</a></bdi> » <bdi><span class="curid"><a href="iconnect" class="wikilink1" title="toh:iomega:iconnect">Iomega iConnect</a></span></bdi></div>
                                    <div class="plugin_multilingual">
        <ul>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/cz/toh/iomega/iconnect" class="media" title="cz:toh:iomega:iconnect"><img src="../../lib/exe/fetch.php?cache=&amp;tok=aff589&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fcz.gif" class="media" title="Čeština (Czech)" alt="Čeština (Czech)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/de/toh/iomega/iconnect" class="media" title="de:toh:iomega:iconnect"><img src="../../lib/exe/fetch.php?cache=&amp;tok=e24010&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fde.gif" class="media" title="Deutsch (German)" alt="Deutsch (German)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <span class="curid"><a href="iconnect" class="media" title="toh:iomega:iconnect"><img src="../../lib/exe/fetch.php?cache=&amp;tok=2a37ae&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fgb.gif" class="media" title="English" alt="English" /></a></span>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/es/toh/iomega/iconnect" class="media" title="es:toh:iomega:iconnect"><img src="../../lib/exe/fetch.php?cache=&amp;tok=46c004&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fmx.gif" class="media" title="Español (Spanish, Mexico)" alt="Español (Spanish, Mexico)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/fr/toh/iomega/iconnect" class="media" title="fr:toh:iomega:iconnect"><img src="../../lib/exe/fetch.php?cache=&amp;tok=a5beba&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Ffr.gif" class="media" title="Français (French)" alt="Français (French)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/hu/toh/iomega/iconnect" class="media" title="hu:toh:iomega:iconnect"><img src="../../lib/exe/fetch.php?cache=&amp;tok=6b5470&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fhu.gif" class="media" title="Magyar (Hungarian)" alt="Magyar (Hungarian)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/jp/toh/iomega/iconnect" class="media" title="jp:toh:iomega:iconnect"><img src="../../lib/exe/fetch.php?cache=&amp;tok=f999fc&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fjp.gif" class="media" title="日本語 (Japanese)" alt="日本語 (Japanese)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/pl/toh/iomega/iconnect" class="media" title="pl:toh:iomega:iconnect"><img src="../../lib/exe/fetch.php?cache=&amp;tok=c805c0&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fpl.gif" class="media" title="Poliski (Polish)" alt="Poliski (Polish)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/pt-br/toh/iomega/iconnect" class="media" title="pt-br:toh:iomega:iconnect"><img src="../../lib/exe/fetch.php?cache=&amp;tok=13127d&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fbr.gif" class="media" title="Português brasileiro (Portuguese, Brasil)" alt="Português brasileiro (Portuguese, Brasil)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/ru/toh/iomega/iconnect" class="media" title="ru:toh:iomega:iconnect"><img src="../../lib/exe/fetch.php?cache=&amp;tok=66ab5e&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fru.gif" class="media" title="Русский (Russsian)" alt="Русский (Russsian)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/tr/toh/iomega/iconnect" class="media" title="tr:toh:iomega:iconnect"><img src="../../lib/exe/fetch.php?cache=&amp;tok=f4beed&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Ftr.gif" class="media" title="Tϋrkçe (Turkish)" alt="Tϋrkçe (Turkish)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/zh-cn/toh/iomega/iconnect" class="media" title="zh-cn:toh:iomega:iconnect"><img src="../../lib/exe/fetch.php?cache=&amp;tok=93625a&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fzh-cn.gif" class="media" title="官話/官话 (Chinese)" alt="官話/官话 (Chinese)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/zh-tw/toh/iomega/iconnect" class="media" title="zh-tw:toh:iomega:iconnect"><img src="../../lib/exe/fetch.php?cache=&amp;tok=b56198&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fzh-tw.gif" class="media" title="臺灣華語 (Taiwanese)" alt="臺灣華語 (Taiwanese)" /></a>
              </div>
            </div>
          </li>
        </ul>
      </div>
        </div>
    
    
    <hr class="a11y" />
</div></div><!-- /header -->

        <div class="wrapper group">

            
            <!-- ********** CONTENT ********** -->
            <div id="dokuwiki__content"><div class="pad group">

                <div class="pageId"><span>toh:iomega:iconnect</span></div>

                <div class="page group">
                                                            <!-- wikipage start -->
                    <!-- TOC START -->
<div id="dw__toc">
<h3 class="toggle">Table of Contents</h3>
<div>

<ul class="toc">
<li class="level1"><div class="li"><a href="iconnect#supported_versions">Supported Versions</a></div></li>
<li class="level1"><div class="li"><a href="iconnect#highlights">Highlights</a></div></li>
<li class="level1"><div class="li"><a href="iconnect#hardware_specification">Hardware Specification</a></div></li>
<li class="level1"><div class="li"><a href="iconnect#serial_jtag_and_usb_pinouts">Serial, JTAG and USB pinouts</a></div></li>
<li class="level1"><div class="li"><a href="iconnect#flash_layout">Flash Layout</a></div></li>
<li class="level1"><div class="li"><a href="iconnect#installation_of_openwrt_from_trunk">Installation of OpenWRT from Trunk</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="iconnect#connect_serial_cable">1. Connect Serial Cable</a></div></li>
<li class="level2"><div class="li"><a href="iconnect#connecting_lan">2. Connecting LAN</a></div></li>
<li class="level2"><div class="li"><a href="iconnect#tftp_server_configuration">3. Tftp server configuration</a></div></li>
<li class="level2"><div class="li"><a href="iconnect#updating_u-boot">4. Updating U-Boot</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="iconnect#backup_your_env_settings">4.1 Backup your env settings</a></div></li>
<li class="level3"><div class="li"><a href="iconnect#flashing_new_u-boot">4.2 Flashing new U-Boot</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="iconnect#default_u-boot_configuration">5. Default U-Boot configuration</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="iconnect#remove_unwanted_env_safe_way">5.1 Remove unwanted env (safe way)</a></div></li>
<li class="level3"><div class="li"><a href="iconnect#reset_bootenv_safe">5.2 Reset bootenv (safe)</a></div></li>
<li class="level3"><div class="li"><a href="iconnect#erase_flash_where_env_is_stored_little_bit_risky">5.3 Erase flash where env is stored (little bit risky)</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="iconnect#flash_openwrt_with_fresh_u-boot">6. Flash OpenWRT with fresh U-Boot</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="iconnect#setting_up_environment">6.1 Setting up environment</a></div></li>
<li class="level3"><div class="li"><a href="iconnect#flashing_jffs2_imagesfilesystem_not_recommended">6.2 Flashing JFFS2 images/filesystem (not recommended)</a></div></li>
<li class="level3"><div class="li"><a href="iconnect#flashing_images_jffs2">6.3 Flashing images (jffs2)</a></div></li>
<li class="level3"><div class="li"><a href="iconnect#flashing_images_ubifs">6.4 Flashing images (ubifs)</a></div></li>
<li class="level3"><div class="li"><a href="iconnect#first_boot_jffs2">6.5 First boot (jffs2)</a></div></li>
<li class="level3"><div class="li"><a href="iconnect#first_boot_ubifs">6.6 First boot (ubifs)</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="iconnect#accessing_iconnect_with_ssh">7. Accessing iConnect with SSH</a></div></li>
<li class="level2"><div class="li"><a href="iconnect#setting_up_internet_access">8. Setting up Internet access</a></div></li>
<li class="level2"><div class="li"><a href="iconnect#setting_up_the_wireless_adapter_access">9. Setting up the Wireless Adapter access</a></div></li>
</ul>
</li>
<li class="level1"><div class="li"><a href="iconnect#flashing_u-boot_with_jtag_unbricking_bootloader">Flashing U-Boot with JTAG (unbricking bootloader)</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="iconnect#introduction">1. Introduction</a></div></li>
<li class="level2"><div class="li"><a href="iconnect#hardware_and_software_used">2. Hardware and software used</a></div></li>
<li class="level2"><div class="li"><a href="iconnect#installing_jtag_inteface_in_windows">3. Installing JTAG inteface in Windows</a></div></li>
<li class="level2"><div class="li"><a href="iconnect#installing_openocd_in_windows">4. Installing OpenOCD in Windows</a></div></li>
<li class="level2"><div class="li"><a href="iconnect#configuration">5. Configuration</a></div></li>
<li class="level2"><div class="li"><a href="iconnect#connecting_with_openocd_to_board">6. Connecting with OpenOCD to board</a></div></li>
<li class="level2"><div class="li"><a href="iconnect#connect_to_openocd_telnet_interface">7. Connect to OpenOCD telnet interface.</a></div></li>
<li class="level2"><div class="li"><a href="iconnect#first_method_-_direct_flash_u-boot">8. First method - direct flash U-Boot</a></div></li>
<li class="level2"><div class="li"><a href="iconnect#second_method_-_booting_u-boot_in_ram_and_flashing_image_using_it">9. Second method - booting U-Boot in RAM and flashing image using it.</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="iconnect#prepare_network_card_settings">9.1 Prepare network card settings</a></div></li>
<li class="level3"><div class="li"><a href="iconnect#prepare_tftpd_server">9.2 Prepare tftpd server</a></div></li>
<li class="level3"><div class="li"><a href="iconnect#runing_u-boot_from_ram">9.3 Runing U-Boot from RAM.</a></div></li>
<li class="level3"><div class="li"><a href="iconnect#configure_basic_env_variables">9.4 Configure basic env variables</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="iconnect#post_rescue_procedure">10. Post rescue procedure.</a></div></li>
</ul></li>
</ul>
</div>
</div>
<!-- TOC END -->

<h1 class="sectionedit1" id="iomega_iconnect">Iomega iConnect</h1>
<div class="level1">

</div>

<h2 class="sectionedit2" id="supported_versions">Supported Versions</h2>
<div class="level2">
<div class="table sectionedit3"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0"> Version/Model </th><th class="col1"> S/N </th><th class="col2"> OpenWrt Version Supported </th><th class="col3"> Model Specific Notes </th>
	</tr>
	</thead>
	<tr class="row1">
		<td class="col0"> All </td><td class="col1"> - </td><td class="col2"> Attitude Adjustment 12.09</td><td class="col3"> - </td>
	</tr>
</table></div>

</div>

<h2 class="sectionedit4" id="highlights">Highlights</h2>
<div class="level2">
<div class="table sectionedit5"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0"> CPU </th><th class="col1"> Ram </th><th class="col2"> Flash </th><th class="col3"> Network </th><th class="col4"> USB </th><th class="col5"> Serial </th><th class="col6"> JTag </th>
	</tr>
	</thead>
	<tr class="row1">
		<td class="col0"> Marvell 6281 Kirkwood@1000MHz </td><td class="col1"> 256 MiB DDR2 </td><td class="col2"> 512 MiB </td><td class="col3"> 1 gigE </td><td class="col4"> 4x 2.0 </td><td class="col5"> Yes </td><td class="col6"> Yes </td>
	</tr>
</table></div>

</div>

<h2 class="sectionedit6" id="hardware_specification">Hardware Specification</h2>
<div class="level2">
<div class="table sectionedit7"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0"> Part Name </th><th class="col1"> Description </th><th class="col2"> Product Page </th><th class="col3"> Documentation </th>
	</tr>
	</thead>
	<tr class="row1">
		<td class="col0"> CPU </td><td class="col1"> Marvell 88F6281  Feroceon 88FR131 revision 1 (ARMv5TE) </td><td class="col2"> <a href="http://www.marvell.com/embedded-processors/kirkwood/" class="urlextern" title="http://www.marvell.com/embedded-processors/kirkwood/"  rel="nofollow">Link</a> </td><td class="col3"> <a href="http://www.marvell.com/embedded-processors/kirkwood/assets/88F6281-004_ver1.pdf" class="urlextern" title="http://www.marvell.com/embedded-processors/kirkwood/assets/88F6281-004_ver1.pdf"  rel="nofollow">Product Brief</a> <a href="http://www.marvell.com/embedded-processors/kirkwood/assets/HW_88F6281_OpenSource.pdf" class="urlextern" title="http://www.marvell.com/embedded-processors/kirkwood/assets/HW_88F6281_OpenSource.pdf"  rel="nofollow">Hardware Spec</a> <a href="http://www.marvell.com/embedded-processors/kirkwood/assets/FS_88F6180_9x_6281_OpenSource.pdf" class="urlextern" title="http://www.marvell.com/embedded-processors/kirkwood/assets/FS_88F6180_9x_6281_OpenSource.pdf"  rel="nofollow">Functional Spec</a> </td>
	</tr>
	<tr class="row2">
		<td class="col0"> RAM </td><td class="col1"> 2x Hynix H5PS1G83EFR 128 <abbr title="Megabyte">MB</abbr></td><td class="col2"> <a href="http://www.hynix.com/datasheet/eng/computing/details/computing_03_H5PS1G83EFR.jsp" class="urlextern" title="http://www.hynix.com/datasheet/eng/computing/details/computing_03_H5PS1G83EFR.jsp"  rel="nofollow">Link</a> </td><td class="col3"> <a href="http://www.hynix.com/inc/pdfDownload.jsp?path=/datasheet/pdf/dram/H5PS1G4(8,6)3EFR(Rev0.4).pdf" class="urlextern" title="http://www.hynix.com/inc/pdfDownload.jsp?path=/datasheet/pdf/dram/H5PS1G4(8,6)3EFR(Rev0.4).pdf"  rel="nofollow">Datasheet</a> </td>
	</tr>
	<tr class="row3">
		<td class="col0"> Flash </td><td class="col1"> Hynix HY27UF084G2B 512 <abbr title="Megabyte">MB</abbr></td><td class="col2"> <a href="http://www.hynix.co.kr/datasheet/eng/nand/details/large_11_HY27UF084G2B.jsp" class="urlextern" title="http://www.hynix.co.kr/datasheet/eng/nand/details/large_11_HY27UF084G2B.jsp"  rel="nofollow">Link</a> </td><td class="col3"> <a href="http://www.hynix.co.kr/inc/pdfDownload.jsp?path=/datasheet/pdf/flash/HY27UF(08_16)4G2B%20(Rev0.4).pdf" class="urlextern" title="http://www.hynix.co.kr/inc/pdfDownload.jsp?path=/datasheet/pdf/flash/HY27UF(08_16)4G2B%20(Rev0.4).pdf"  rel="nofollow">Datasheet</a> </td>
	</tr>
	<tr class="row4">
		<td class="col0"> USB Hub </td><td class="col1"> Alcor AU6256 4x USB 2.0 </td><td class="col2"> <a href="http://www.alcormicro.com/en_content/c_product/product_01b.php?CategoryID=6&amp;IndexID=1" class="urlextern" title="http://www.alcormicro.com/en_content/c_product/product_01b.php?CategoryID=6&amp;IndexID=1"  rel="nofollow">Link</a> </td><td class="col3"> </td>
	</tr>
	<tr class="row5">
		<td class="col0"> <abbr title="Local Area Network">LAN</abbr> </td><td class="col1"> Marvell Alaska 88E1116R-NNC1 1x Gigabit RJ45 </td><td class="col2"> <a href="http://www.marvell.com/transceivers/alaska-gbe/" class="urlextern" title="http://www.marvell.com/transceivers/alaska-gbe/"  rel="nofollow">Link</a> </td><td class="col3"> <a href="http://www.marvell.com/transceivers/assets/Marvell-Alaska-88E1116R-Single-Port-GbE.pdf" class="urlextern" title="http://www.marvell.com/transceivers/assets/Marvell-Alaska-88E1116R-Single-Port-GbE.pdf"  rel="nofollow">Product Brief</a> <a href="http://www.marvell.com/transceivers/assets/88E1116R_Technical_Product_Brief.pdf" class="urlextern" title="http://www.marvell.com/transceivers/assets/88E1116R_Technical_Product_Brief.pdf"  rel="nofollow">Technical Product Brief</a> </td>
	</tr>
	<tr class="row6">
		<td class="col0"> WiFi </td><td class="col1"> SparkLAN WPER-116GN b/g/n, 150Mbps, Mini PCIE, Ralink RT3090, 1T1R </td><td class="col2"> <a href="http://www.sparklan.com/product.php?func=view&amp;prod_id=100" class="urlextern" title="http://www.sparklan.com/product.php?func=view&amp;prod_id=100"  rel="nofollow">Link</a> </td><td class="col3"> <a href="http://www.sparklan.com/downloadDataSheet.php?data_id=132" class="urlextern" title="http://www.sparklan.com/downloadDataSheet.php?data_id=132"  rel="nofollow">Datasheet</a> <a href="http://www.sparklan.com/download.php?prod_id=100" class="urlextern" title="http://www.sparklan.com/download.php?prod_id=100"  rel="nofollow">Drivers</a> </td>
	</tr>
</table></div>

</div>

<h2 class="sectionedit8" id="serial_jtag_and_usb_pinouts">Serial, JTAG and USB pinouts</h2>
<div class="level2">

<p>
<a href="http://wiki.openwrt.org/_detail/media/toh/iomega/iconnect/connect.pinout.png?id=toh%3Aiomega%3Aiconnect" class="media" title="media:toh:iomega:iconnect:connect.pinout.png"><img src="http://wiki.openwrt.org/_media/media/toh/iomega/iconnect/connect.pinout.png" class="media" alt="" /></a><br/>

Picture 1. iConnect board with pin outs description.
<br/>

<br/>

<strong>Serial port</strong><br/>

Pins on board:<br/>

1 - VCC (in white rectangle)<br/>

2 - TX (connect here cable RX line)<br/>

3 - GND<br/>

4 - RX (connect here cable TX line<br/>

</p>

<p>
<strong>JTAG</strong><br/>

Is standard ARM 20 pinout.<br/>

First pin is in white rectangle, just next to connector name J2.<br/>

</p>

<p>
<strong>USB</strong><br/>

USB hub sockets numeration starts from one on the back (1) then on the front from status led (2).
This may be important when you connect USB storage.<br/>

If many devices are connected at once then they will be mounted according to numeration of port.
</p>

</div>

<h2 class="sectionedit9" id="flash_layout">Flash Layout</h2>
<div class="level2">
<div class="table sectionedit10"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0 centeralign" colspan="6">           OpenWrt FlashLayout           </th>
	</tr>
	</thead>
	<tr class="row1">
		<th class="col0 leftalign"> mtd#     </th><td class="col1 leftalign"> mtd0      </td><td class="col2 leftalign"> mtd0         </td><td class="col3 leftalign"> mtd1            </td><td class="col4 leftalign"> mtd2      </td><td class="col5 leftalign"> mtd3      </td>
	</tr>
	<tr class="row2">
		<th class="col0 leftalign"> Start    </th><td class="col1 leftalign"> 0x00000   </td><td class="col2 leftalign"> 0x080000     </td><td class="col3 leftalign">0x100000         </td><td class="col4"> 0x0400000 </td><td class="col5"> 0x02400000 </td>
	</tr>
	<tr class="row3">
		<th class="col0 leftalign"> End      </th><td class="col1 leftalign"> 0x80000   </td><td class="col2 leftalign"> 0x100000     </td><td class="col3 leftalign">0x400000         </td><td class="col4"> 0x2400000 </td><td class="col5"> 0x20000000 </td>
	</tr>
	<tr class="row4">
		<th class="col0 leftalign"> Size     </th><td class="col1 leftalign"> 0x80000   </td><td class="col2 leftalign"> 0x20000      </td><td class="col3 leftalign">0x300000         </td><td class="col4"> 0x2000000 </td><td class="col5"> 0x17600000 </td>
	</tr>
	<tr class="row5">
		<th class="col0"> Size MiB </th><td class="col1 leftalign"> 800KB     </td><td class="col2 leftalign"> 200KB        </td><td class="col3 leftalign">4                </td><td class="col4 leftalign"> 32        </td><td class="col5 leftalign"> 473     </td>
	</tr>
	<tr class="row6">
		<th class="col0 leftalign"> Name     </th><td class="col1 leftalign"> U-Boot    </td><td class="col2 leftalign"> U-Boot env   </td><td class="col3 leftalign">uImage (kernel)  </td><td class="col4 leftalign"> rootfs    </td><td class="col5 leftalign"> data      </td>
	</tr>
	<tr class="row7">
		<th class="col0 leftalign"> File system  </th><td class="col1"> <em>none</em> </td><td class="col2"> <em>none</em> </td><td class="col3 leftalign"> <em>none</em>        </td><td class="col4 leftalign"> JFFS2     </td><td class="col5 leftalign">   </td>
	</tr>
</table></div>

</div>

<h2 class="sectionedit11" id="installation_of_openwrt_from_trunk">Installation of OpenWRT from Trunk</h2>
<div class="level2">

<p>
This tutorial assumes that you are using Windows 7 <abbr title="Operating System">OS</abbr>.
You will need:<br/>

<a href="http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html" class="urlextern" title="http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html"  rel="nofollow">PuTTY</a><br/>

<a href="http://winscp.net/" class="urlextern" title="http://winscp.net/"  rel="nofollow">WinSCP</a><br/>

<a href="http://tftpd32.jounin.net" class="urlextern" title="http://tftpd32.jounin.net"  rel="nofollow">tftpd</a><br/>

<a href="http://downloads.openwrt.org/snapshots/trunk/kirkwood/" class="urlextern" title="http://downloads.openwrt.org/snapshots/trunk/kirkwood/"  rel="nofollow">Files from Trunk</a>
</p>

<p>
<img src="../../lib/images/smileys/icon_exclaim.gif" class="icon" alt=":!:" /> Correctly if you want to use UBIFS you need to compile your own images. <br/>

Make sure that you <strong>enable</strong> &quot;Include kernel in root filesystem&quot; and &quot;Include DTB in root filesystem&quot; which you can find under &quot;Target Images&quot; in menuconfig.
</p>

</div>

<h3 class="sectionedit12" id="connect_serial_cable">1. Connect Serial Cable</h3>
<div class="level3">

<p>
Using description above connect serial cable to board and establish connection with serial console using PuTTY.
</p>

</div>

<h3 class="sectionedit13" id="connecting_lan">2. Connecting LAN</h3>
<div class="level3">

<p>
Connect <abbr title="Local Area Network">LAN</abbr> cable between your computer and iConnect.
</p>

<p>
Set computer IP to 192.168.1.5
</p>

<p>
Go to Start → Control Panel → Network and Sharing Center → Local Area connection → Properties → Internet Protocol Version 4(TCP/IPv4)
</p>

<p>
Choose &quot;Use the following IP address&quot; and set:
<pre class="code">IP address: 192.168.1.5
Subnet mask: 255.255.255.0</pre>

</p>

<p>
Confirm by clicking OK.
</p>

</div>

<h3 class="sectionedit14" id="tftp_server_configuration">3. Tftp server configuration</h3>
<div class="level3">

<p>
Extract zip to c:\tftpd, create folder c:\tftpd\files.
</p>

<p>
Download from <a href="http://downloads.openwrt.org/snapshots/trunk/kirkwood/" class="urlextern" title="http://downloads.openwrt.org/snapshots/trunk/kirkwood/"  rel="nofollow">trunk repository</a> or final version if available:
<pre class="file">openwrt-kirkwood-uImage
openwrt-kirkwood--jffs2-128k.img
openwrt-kirkwood-iconnect-u-boot.kwb</pre>

and copy them to c:\tftpd\files.
</p>

<p>
Run tftpd, click &quot;Settings&quot; button, choose TFTP tab and set &quot;Base Directory&quot; to c:\tftpd\files, click OK button.
</p>

<p>
Check if &quot;Server interface&quot; is 192.168.1.5, if not choose it from the list.
</p>

</div>

<h3 class="sectionedit15" id="updating_u-boot">4. Updating U-Boot</h3>
<div class="level3">

<p>

<span style="color:red;">!!! This is risky operation which can brick your iConnect.  !!!<br/>
Please first skip to next point and continue with you current U-Boot.<br/>
If you will be having problems with running OpenWRT then come back here.</span>
<br/>

Even when you brick it, you may use JTAG connector to bring it live.<br/>

</p>

</div>

<h4 id="backup_your_env_settings">4.1 Backup your env settings</h4>
<div class="level4">

<p>
Power up iConnect and watch serial console output. When you notice:
</p>

<p>
<pre class="code">Hit any key to stop autoboot:  0</pre>

press enter. Then type:
<pre class="code">printenv</pre>

you will see all env variables, copy it and save to text file it will be needed later.
</p>

</div>

<h4 id="flashing_new_u-boot">4.2 Flashing new U-Boot</h4>
<div class="level4">

<p>
Set tftp server and iConnect IP addresses.
<pre class="code">setenv serverip 192.168.1.5
setenv ipaddr 192.168.1.200</pre>

</p>

<p>
Flash new U-Boot
<pre class="code">mw 0x0800000 0xffff 0x100000 
tftp 0x0800000 openwrt-kirkwood-iconnect-u-boot.kwb
nand erase 0x0 0x100000
nand write 0x0800000 0x0 0x100000</pre>

</p>

<p>
Result should be similar to this:
<pre class="code">iconnect =&gt; setenv serverip 192.168.1.5
iconnect =&gt; setenv ipaddr 192.168.1.200
iconnect =&gt; mw 0x0800000 0xffff 0x100000
iconnect =&gt; tftp 0x0800000 openwrt-kirkwood-iconnect-u-boot.kwb
Using egiga0 device
TFTP from server 192.168.1.5; our IP address is 192.168.1.200
Filename &#039;openwrt-kirkwood-iconnect-u-boot.kwb&#039;.
Load address: 0x800000
Loading: ############################
done
Bytes transferred = 401136 (61ef0 hex)

iconnect =&gt; nand erase 0x0 0x100000

NAND erase: device 0 offset 0x0, size 0x100000
Erasing at 0xe0000 -- 100% complete.
OK

iconnect =&gt; nand write 0x0800000 0x0 0x100000

NAND write: device 0 offset 0x0, size 0x100000
 1048576 bytes written: OK</pre>

</p>

<p>
If there were no errors then type reset.
<pre class="code">reset</pre>

</p>

<p>
If your iConnect does not bring up (blue diode don&#039;t blink), something went wrong and it is bricked.
Don&#039;t be scary there is a way to bring it up, you must use JTAG connector, see article Flashing U-Boot with JTAG.
</p>

</div>

<h3 class="sectionedit16" id="default_u-boot_configuration">5. Default U-Boot configuration</h3>
<div class="level3">

<p>
To prevent any problems caused by old environment configuration it is best to reset them to default values.
</p>

<p>
Here is a default configuration of first run U-Boot.
<pre class="code">iconnect =&gt; printenv
baudrate=115200
bootargs_root=noinitrd ubi.mtd=2 root=ubi0:rootfs rootfstype=ubifs
bootcmd=setenv bootargs ${console} ${mtdparts} ${bootargs_root}; ubi part rootfs; ubifsmount rootfs; ubifsload 0x800000 ${kernel}; bootm 0x800000
bootdelay=3
console=console=ttyS0,115200
ethact=egiga0
kernel=/boot/uImage
mtdids=nand0=orion_nand
mtdparts=mtdparts=orion_nand:0x80000@0x0(uboot),0x20000@0x80000(uboot_env),-@0xa0000(rootfs)
stderr=serial
stdin=serial
stdout=serial

Environment size: 487/131068 bytes</pre>

</p>

<p>
There are three ways to do that.
</p>

</div>

<h4 id="remove_unwanted_env_safe_way">5.1 Remove unwanted env (safe way)</h4>
<div class="level4">

<p>
To remove env variables use:
<pre class="code">setenv env_name &#039;&#039;</pre>

</p>

<p>
reapeat for each variable to remove.
</p>

</div>

<h4 id="reset_bootenv_safe">5.2 Reset bootenv (safe)</h4>
<div class="level4">

<p>
<pre class="code">env default -a
saveenv</pre>

</p>

</div>

<h4 id="erase_flash_where_env_is_stored_little_bit_risky">5.3 Erase flash where env is stored (little bit risky)</h4>
<div class="level4">

<p>
To force U-Boot to recreate whole env with basic configuration you may erase this part of flash memory. It can be risky if env storage location is changed with future version and you erase part of U-Boot.
</p>

<p>
Execute:
<pre class="code">nand erase 0x80000 0x100000
reset</pre>

</p>

<p>
After reset you will get two errors:
<pre class="code">*** Warning - bad CRC, using default environment
Warning: failed to set MAC address</pre>

To fix it you must restore MAC address (search for ethaddr in your backup file) and save env values:
<pre class="code">setenv ethaddr &#039;00:D0:##:##:##:##&#039;
saveenv
reset</pre>

</p>

<p>
After restart you shouldn&#039;t see any errors.
</p>

</div>

<h3 class="sectionedit17" id="flash_openwrt_with_fresh_u-boot">6. Flash OpenWRT with fresh U-Boot</h3>
<div class="level3">

</div>

<h4 id="setting_up_environment">6.1 Setting up environment</h4>
<div class="level4">

<p>
Find in your backup file MAC address, variable ethaddr.
</p>

<p>
Now add MAC, set server IP to 1.5, and iConnect IP to 1.200, save and restart:
<pre class="code">setenv ethaddr &#039;00:D0:##:##:##:##&#039;
setenv serverip &#039;192.168.1.5&#039; 
setenv ipaddr &#039;192.168.1.200&#039;
saveenv
reset</pre>

</p>

</div>

<h4 id="flashing_jffs2_imagesfilesystem_not_recommended">6.2 Flashing JFFS2 images/filesystem (not recommended)</h4>
<div class="level4">

<p>
<img src="../../lib/images/smileys/icon_exclaim.gif" class="icon" alt=":!:" /> Please refer to section 6.4 if you want to use ubifs (recommended)
</p>

<p>
Set boot parameters:
<pre class="code">setenv machid &#039;B36&#039;
setenv arcNumber &#039;2870&#039;
setenv loadaddr &#039;0x6400000&#039;
setenv console &#039;console=ttyS0,115200 panic=20&#039;
setenv bootargs_root &#039;root=/dev/mtdblock2 rootfstype=jffs2&#039;</pre>

</p>

<p>
Add scripts which will make flashing easy:
<pre class="code">setenv kernel_name &#039;openwrt-kirkwood-uImage&#039;
setenv rootfs_name &#039;openwrt-kirkwood--jffs2-128k.img&#039;

setenv download_kernel &#039;mw $(loadaddr) 0xffff 0x300000; tftp $(loadaddr) $(kernel_name);&#039;
setenv flash_kernel &#039;nand erase 0x100000 0x400000; nand write.e $(loadaddr) 0x100000 0x400000;&#039;

setenv download_rootfs &#039;mw $(loadaddr) 0xffff 0x200000; tftp $(loadaddr) $(rootfs_name);&#039;
setenv flash_rootfs &#039;nand erase 0x500000 0xfb00000; nand write.e $(loadaddr) 0x500000 0x200000;&#039;

setenv load_openwrt &#039;setenv bootargs $(console) $(bootargs_root); nand read $(loadaddr) 0x100000 0x400000; bootm $(loadaddr)&#039;
setenv bootcmd &#039;run load_openwrt&#039;
saveenv</pre>

</p>

</div>

<h4 id="flashing_images_jffs2">6.3 Flashing images (jffs2)</h4>
<div class="level4">

<p>
Flash images by executing:
<pre class="code">run download_kernel
run flash_kernel
run download_rootfs
run flash_rootfs
reset</pre>

</p>

<p>
Results:
<pre class="code">iconnect =&gt; run download_kernel
Using egiga0 device
TFTP from server 192.168.1.5; our IP address is 192.168.1.200
Filename &#039;openwrt-kirkwood-uImage&#039;.
Load address: 0x6400000
Loading: #################################################################
         ######################
done
Bytes transferred = 1264864 (134ce0 hex)

iconnect =&gt; run flash_kernel

NAND erase: device 0 offset 0x100000, size 0x400000
Erasing at 0x4e0000 -- 100% complete.
OK

NAND write: device 0 offset 0x100000, size 0x400000
 4194304 bytes written: OK

connect =&gt; run download_rootfs
Using egiga0 device
TFTP from server 192.168.1.5; our IP address is 192.168.1.200
Filename &#039;openwrt-kirkwood--jffs2-128k.img&#039;.
Load address: 0x6400000
Loading: #################################################################
         ##################################
done
Bytes transferred = 1443840 (160800 hex)

iconnect =&gt; run flash_rootfs

NAND erase: device 0 offset 0x500000, size 0xfb00000
Skipping bad block at  0x0b5a0000
Skipping bad block at  0x0b5e0000
Skipping bad block at  0x0b620000
Erasing at 0xffe0000 -- 100% complete.
OK

NAND write: device 0 offset 0x500000, size 0x200000
 2097152 bytes written: OK

reset</pre>

</p>

</div>

<h4 id="flashing_images_ubifs">6.4 Flashing images (ubifs)</h4>
<div class="level4">

<p>
It&#039;s <strong>important</strong> that you reset u-boot before flashing otherwise it will most likely fail to boot.
</p>

<p>
<pre class="code">nand erase 0x200000 0x1fe00000
ubi part root ; ubi remove rootfs ; ubi create rootfs
tftpboot 0x800000 openwrt-kirkwood-iconnect-rootfs.ubifs ; ubi write 0x800000 rootfs ${filesize} ; reset</pre>

</p>

</div>

<h4 id="first_boot_jffs2">6.5 First boot (jffs2)</h4>
<div class="level4">

<p>
This is a bootlog from first start of OpenWRT:
<pre class="code">U-Boot 2012.10 (Feb 12 2013 - 18:24:56) Iomega iConnect

SoC:   Kirkwood 88F6281_A0
DRAM:  256 MiB
WARNING: Caches not enabled
NAND:  512 MiB
In:    serial
Out:   serial
Err:   serial
Net:   egiga0
Hit any key to stop autoboot:  0

NAND read: device 0 offset 0x100000, size 0x400000
 4194304 bytes read: OK
## Booting kernel from Legacy Image at 06400000 ...
   Image Name:   Linux-3.3.8
   Image Type:   ARM Linux Kernel Image (uncompressed)
   Data Size:    1264640 Bytes = 1.2 MiB
   Load Address: 00008000
   Entry Point:  00008000
   Verifying Checksum ... OK
   Loading Kernel Image ... OK
OK
Using machid 0xb36 from environment

Starting kernel ...

Uncompressing Linux... done, booting the kernel.
[    0.000000] Booting Linux on physical CPU 0
[    0.000000] Linux version 3.3.8 (openwrt@OpenWRTBuild) (gcc version 4.6.4 20121210 (prerelease) (Linaro GCC 4.6-2012.12) ) #1 Wed Jan 30 08:21:48 MST 2013
[    0.000000] CPU: Feroceon 88FR131 [56251311] revision 1 (ARMv5TE), cr=00053977
[    0.000000] CPU: VIVT data cache, VIVT instruction cache
[    0.000000] Machine: Iomega iConnect Wireless

/* A lot of other lines */

[   14.512806] NAND device: Manufacturer ID: 0xad, Chip ID: 0xdc (Hynix NAND 512MiB 3,3V 8-bit)
[   14.521316] Scanning device for bad blocks
[   14.633823] Bad eraseblock 1453 at 0x00000b5a0000
[   14.638673] Bad eraseblock 1455 at 0x00000b5e0000
[   14.643509] Bad eraseblock 1457 at 0x00000b620000
[   14.768850] Bad eraseblock 3075 at 0x000018060000
[   14.773689] Bad eraseblock 3077 at 0x0000180a0000
[   14.854509] Creating 4 MTD partitions on &quot;orion_nand&quot;:
[   14.859696] 0x000000000000-0x000000100000 : &quot;u-boot&quot;
[   14.865801] 0x000000100000-0x000000400000 : &quot;uImage&quot;
[   14.871789] 0x000000400000-0x000002400000 : &quot;rootfs&quot;
[   14.877811] 0x000002400000-0x000020000000 : &quot;data&quot;

/* A lot of other lines */

[   16.409415] jffs2_scan_eraseblock(): End of filesystem marker found at 0x260000
[   16.416814] jffs2_build_filesystem(): unlocking the mtd device... done.
[   16.423471] jffs2_build_filesystem(): erasing all blocks after the end marker... done.
[   22.954602] JFFS2 notice: (1) jffs2_build_xattr_subsystem: complete building xattr subsystem, 0 of xdatum (0 unchecked, 0 orphan) and 0 of xref (0 dead, 0 orphan) found.
[   22.974126] VFS: Mounted root (jffs2 filesystem) on device 31:2.
[   22.980637] Freeing init memory: 124K
- preinit -
Press the [f] key and hit [enter] to enter failsafe mode
- regular preinit -
- init -

Please press Enter to activate this console. 

[Enter]

BusyBox v1.19.4 (2013-02-12 18:25:46 UTC) built-in shell (ash)
Enter &#039;help&#039; for a list of built-in commands.

  _______                     ________        __
 |       |.-----.-----.-----.|  |  |  |.----.|  |_
 |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|
 |_______||   __|_____|__|__||________||__|  |____|
          |__| W I R E L E S S   F R E E D O M
 -----------------------------------------------------
 BARRIER BREAKER (Bleeding Edge, r35572)
 -----------------------------------------------------
  * 1/2 oz Galliano         Pour all ingredients into
  * 4 oz cold Coffee        an irish coffee mug filled
  * 1 1/2 oz Dark Rum       with crushed ice. Stir.
  * 2 tsp. Creme de Cacao
 -----------------------------------------------------
root@OpenWrt:/#</pre>

</p>

<p>
We have working OpenWRT.
</p>

</div>

<h4 id="first_boot_ubifs">6.6 First boot (ubifs)</h4>
<div class="level4">

<p>
This is a bootlog from first start of OpenWRT:
<pre class="code">U-Boot 2014.04 (Jun 23 2014 - 12:47:24) Iomega iConnect

SoC:   Kirkwood 88F6281_A0
DRAM:  256 MiB
WARNING: Caches not enabled
NAND:  512 MiB
In:    serial
Out:   serial
Err:   serial
Net:   egiga0
Hit any key to stop autoboot:  0
UBI: attaching mtd1 to ubi0
UBI: physical eraseblock size:   131072 bytes (128 KiB)
UBI: logical eraseblock size:    129024 bytes
UBI: smallest flash I/O unit:    2048
UBI: sub-page size:              512
UBI: VID header offset:          512 (aligned 512)
UBI: data offset:                2048
UBI: attached mtd1 to ubi0
UBI: MTD device name:            &quot;mtd=3&quot;
UBI: MTD device size:            510 MiB
UBI: number of good PEBs:        4080
UBI: number of bad PEBs:         0
UBI: max. allowed volumes:       128
UBI: wear-leveling threshold:    4096
UBI: number of internal volumes: 1
UBI: number of user volumes:     1
UBI: available PEBs:             0
UBI: total number of reserved PEBs: 4080
UBI: number of PEBs reserved for bad PEB handling: 40
UBI: max/mean erase counter: 4/1
UBIFS: mounted UBI device 0, volume 0, name &quot;rootfs&quot;
UBIFS: mounted read-only
UBIFS: file system size:   519321600 bytes (507150 KiB, 495 MiB, 4025 LEBs)
UBIFS: journal size:       9033728 bytes (8822 KiB, 8 MiB, 71 LEBs)
UBIFS: media format:       w4/r0 (latest is w4/r0)
UBIFS: default compressor: LZO
UBIFS: reserved for root:  0 bytes (0 KiB)
Loading file &#039;/boot/zImage&#039; to addr 0x00800000 with size 1535068 (0x00176c5c)...
Done
Loading file &#039;/boot/iconnect.dtb&#039; to addr 0x00700000 with size 8674 (0x000021e2)...
Done
Unmounting UBIFS volume rootfs!
Kernel image @ 0x800000 [ 0x000000 - 0x176c58 ]
## Flattened Device Tree blob at 00700000
   Booting using the fdt blob at 0x700000
   reserving fdt memory region: addr=700000 size=3000
   Loading Device Tree to 0fb13000, end 0fb18fff ... OK

Starting kernel ...

Uncompressing Linux... done, booting the kernel.
[    0.000000] Booting Linux on physical CPU 0x0
[    0.000000] Linux version 3.10.36 (root@devbox) (gcc version 4.8.3 (OpenWrt/Linaro GCC 4.8-2014.04 r41029) ) #3 Mon Jun 23 15:37:45 CEST 2014
[    0.000000] CPU: Feroceon 88FR131 [56251311] revision 1 (ARMv5TE), cr=00053977
[    0.000000] CPU: VIVT data cache, VIVT instruction cache
[    0.000000] Machine: Marvell Kirkwood (Flattened Device Tree), model: Iomega Iconnect
[    0.000000] Memory policy: ECC disabled, Data cache writeback
[    0.000000] Built 1 zonelists in Zone order, mobility grouping on.  Total pages: 65024
[    0.000000] Kernel command line: console=ttyS0,115200 mtdparts=orion_nand:0xe0000@0x0(uboot),0x20000@0xe0000(uboot_env),0x100000@0x100000(second_stage_uboot),-@0x200000(root) ubi.mtd=3 root=ubi0:rootfs rootfstype=ubifs rw
[    0.000000] PID hash table entries: 1024 (order: 0, 4096 bytes)
[    0.000000] Dentry cache hash table entries: 32768 (order: 5, 131072 bytes)
[    0.000000] Inode-cache hash table entries: 16384 (order: 4, 65536 bytes)
[    0.000000] Memory: 256MB = 256MB total
[    0.000000] Memory: 252296k/252296k available, 9848k reserved, 0K highmem
[    0.000000] Virtual kernel memory layout:
[    0.000000]     vector  : 0xffff0000 - 0xffff1000   (   4 kB)
[    0.000000]     fixmap  : 0xfff00000 - 0xfffe0000   ( 896 kB)
[    0.000000]     vmalloc : 0xd0800000 - 0xff000000   ( 744 MB)
[    0.000000]     lowmem  : 0xc0000000 - 0xd0000000   ( 256 MB)
[    0.000000]     modules : 0xbf000000 - 0xc0000000   (  16 MB)
[    0.000000]       .text : 0xc0008000 - 0xc03e2d64   (3948 kB)
[    0.000000]       .init : 0xc03e3000 - 0xc040427c   ( 133 kB)
[    0.000000]       .data : 0xc0406000 - 0xc042a69c   ( 146 kB)
[    0.000000]        .bss : 0xc042a69c - 0xc045676c   ( 177 kB)
[    0.000000] NR_IRQS:114
[    0.000000] sched_clock: 32 bits at 200MHz, resolution 5ns, wraps every 21474ms
[   12.340147] Calibrating delay loop... 990.41 BogoMIPS (lpj=4952064)
[   12.380122] pid_max: default: 32768 minimum: 301
[   12.380256] Mount-cache hash table entries: 512
[   12.382629] CPU: Testing write buffer coherency: ok
[   12.383014] Setting up static identity map for 0xc0010390 - 0xc00103cc
[   12.384671] pinctrl core: initialized pinctrl subsystem
[   12.385733] regulator-dummy: no parameters
[   12.386266] NET: Registered protocol family 16
[   12.386728] DMA: preallocated 256 KiB pool for atomic coherent allocations
[   12.389621] Kirkwood: MV88F6281-A0, TCLK=200000000.
[   12.389645] Feroceon L2: Enabling L2
[   12.389690] Feroceon L2: Cache support initialised.
[   12.402763] bio: create slab &lt;bio-0&gt; at 0
[   12.403299] mvebu-pcie pcie-controller.1: PCIe0.0: link down
[   12.403552] mvebu-pcie pcie-controller.1: PCI host bridge to bus 0000:00
[   12.403573] pci_bus 0000:00: root bus resource [io  0x1000-0xfffff]
[   12.403587] pci_bus 0000:00: root bus resource [mem 0xe0000000-0xe7ffffff]
[   12.403601] pci_bus 0000:00: root bus resource [bus 00-ff]
[   12.403912] PCI: bus0: Fast back to back transfers disabled
[   12.403931] pci 0000:00:01.0: bridge configuration invalid ([bus 00-00]), reconfiguring
[   12.404152] PCI: bus1: Fast back to back transfers enabled
[   12.404214] pci 0000:00:01.0: PCI bridge to [bus 01]
[   12.404235] PCI: enabling device 0000:00:01.0 (0140 -&gt; 0143)
[   12.405353] SCSI subsystem initialized
[   12.406095] usbcore: registered new interface driver usbfs
[   12.406262] usbcore: registered new interface driver hub
[   12.406463] usbcore: registered new device driver usb
[   12.408047] Switching to clocksource orion_clocksource
[   12.410025] NET: Registered protocol family 2
[   12.410536] TCP established hash table entries: 2048 (order: 2, 16384 bytes)
[   12.410603] TCP bind hash table entries: 2048 (order: 1, 8192 bytes)
[   12.410639] TCP: Hash tables configured (established 2048 bind 2048)
[   12.410703] TCP: reno registered
[   12.410717] UDP hash table entries: 256 (order: 0, 4096 bytes)
[   12.410747] UDP-Lite hash table entries: 256 (order: 0, 4096 bytes)
[   12.410946] NET: Registered protocol family 1
[   12.411198] Unpacking initramfs...
[   12.411213] Initramfs unpacking failed: junk in compressed archive
[   12.421530] Freeing initrd memory: 3068K (c4501000 - c4800000)
[   12.423119] squashfs: version 4.0 (2009/01/31) Phillip Lougher
[   12.423136] jffs2: version 2.2 (NAND) (SUMMARY) (LZMA) (RTIME) (CMODE_PRIORITY) (c) 2001-2006 Red Hat, Inc.
[   12.423383] msgmni has been set to 498
[   12.423790] io scheduler noop registered
[   12.423802] io scheduler deadline registered (default)
[   12.424790] kirkwood-pinctrl f1010000.pinctrl: registered pinctrl driver
[   12.506810] Serial: 8250/16550 driver, 2 ports, IRQ sharing disabled
[   12.508327] f1012000.serial: ttyS0 at MMIO 0xf1012000 (irq = 33) is a 16550A
[   12.934469] console [ttyS0] enabled
[   12.940258] NAND device: Manufacturer ID: 0xad, Chip ID: 0xdc (Hynix NAND 512MiB 3,3V 8-bit), 512MiB, page size: 2048, OOB size: 64
[   12.952181] Scanning device for bad blocks
[   13.262706] 4 cmdlinepart partitions found on MTD device orion_nand
[   13.269012] Creating 4 MTD partitions on &quot;orion_nand&quot;:
[   13.274175] 0x000000000000-0x0000000e0000 : &quot;uboot&quot;
[   13.280185] 0x0000000e0000-0x000000100000 : &quot;uboot_env&quot;
[   13.286452] 0x000000100000-0x000000200000 : &quot;second_stage_uboot&quot;
[   13.293478] 0x000000200000-0x000020000000 : &quot;root&quot;
[   13.300542] libphy: orion_mdio_bus: probed
[   13.305424] mv643xx_eth: MV-643xx 10/100/1000 ethernet driver version 1.4
[   13.313588] mv643xx_eth_port mv643xx_eth_port.0 eth0: port 0 with MAC address 00:d0:b8:0d:99:d3
[   13.322527] ehci_hcd: USB 2.0 &#039;Enhanced&#039; Host Controller (EHCI) Driver
[   13.329106] ehci-pci: EHCI PCI platform driver
[   13.333733] ehci-platform: EHCI generic platform driver
[   13.339198] ehci-orion: EHCI orion driver
[   13.343328] orion-ehci f1050000.ehci: EHCI Host Controller
[   13.348887] orion-ehci f1050000.ehci: new USB bus registered, assigned bus number 1
[   13.356689] orion-ehci f1050000.ehci: irq 19, io mem 0xf1050000
[   13.378089] orion-ehci f1050000.ehci: USB 2.0 started, EHCI 1.00
[   13.384810] hub 1-0:1.0: USB hub found
[   13.388622] hub 1-0:1.0: 1 port detected
[   13.393209] usbcore: registered new interface driver usb-storage
[   13.399747] cpuidle: using governor ladder
[   13.404642] leds-gpio gpio-leds.2: pins are not configured from the driver
[   13.413818] TCP: cubic registered
[   13.417153] NET: Registered protocol family 17
[   13.421902] 8021q: 802.1Q VLAN Support v1.8
[   13.427255] regulator-dummy: disabling
[   13.431526] UBI: attaching mtd3 to ubi0
[   13.708290] usb 1-1: new high-speed USB device number 2 using orion-ehci
[   13.898279] hub 1-1:1.0: USB hub found
[   13.902335] hub 1-1:1.0: 4 ports detected
[   14.246031] UBI: scanning is finished
[   14.264588] UBI warning: print_rsvd_warning: cannot reserve enough PEBs for bad PEB handling, reserved 40, need 80
[   14.276801] UBI: attached mtd3 (name &quot;root&quot;, size 510 MiB) to ubi0
[   14.283046] UBI: PEB size: 131072 bytes (128 KiB), LEB size: 129024 bytes
[   14.289880] UBI: min./max. I/O unit sizes: 2048/2048, sub-page size 512
[   14.296520] UBI: VID header offset: 512 (aligned 512), data offset: 2048
[   14.303263] UBI: good PEBs: 4080, bad PEBs: 0, corrupted PEBs: 0
[   14.309314] UBI: user volume: 1, internal volumes: 1, max. volumes count: 128
[   14.316481] UBI: max/mean erase counter: 4/1, WL threshold: 4096, image sequence number: 0
[   14.324805] UBI: available PEBs: 0, total reserved PEBs: 4080, PEBs reserved for bad PEB handling: 40
[   14.334085] drivers/rtc/hctosys.c: unable to open rtc device (rtc0)
[   14.341108] UBI: background thread &quot;ubi_bgt0d&quot; started, PID 748
[   14.377820] UBIFS: background thread &quot;ubifs_bgt0_0&quot; started, PID 750
[   14.410442] UBIFS: start fixing up free space
[   17.118001] UBIFS: free space fixup complete
[   17.179311] UBIFS: mounted UBI device 0, volume 0, name &quot;rootfs&quot;
[   17.185355] UBIFS: LEB size: 129024 bytes (126 KiB), min./max. I/O unit sizes: 2048 bytes/2048 bytes
[   17.194560] UBIFS: FS size: 519321600 bytes (495 MiB, 4025 LEBs), journal size 9033728 bytes (8 MiB, 71 LEBs)
[   17.204531] UBIFS: reserved for root: 0 bytes (0 KiB)
[   17.209622] UBIFS: media format: w4/r0 (latest is w4/r0), UUID 776A9DD4-F13A-4884-ACFA-A71ECCBAAC6E, small LPT model
[   17.269677] VFS: Mounted root (ubifs filesystem) on device 0:10.
[   17.276181] Freeing unused kernel memory: 132K (c03e3000 - c0404000)
procd: Console is alive
[   17.737666] Button Hotplug driver version 0.4.1
procd: - preinit -
Press the [f] key and hit [enter] to enter failsafe mode
Press the [1], [2], [3] or [4] key and hit [enter] to select the debug level
mounting /dev/root
procd: - early -
procd: - ubus -
procd: - init -
Please press Enter to activate this console.
[   25.216079] NET: Registered protocol family 10
[   25.266254] RPC: Registered named UNIX socket transport module.
[   25.272250] RPC: Registered udp transport module.
[   25.276978] RPC: Registered tcp transport module.
[   25.281719] RPC: Registered tcp NFSv4.1 backchannel transport module.
[   25.361168] tun: Universal TUN/TAP device driver, 1.6
[   25.366246] tun: (C) 1999-2004 Max Krasnyansky &lt;maxk@qualcomm.com&gt;
[   25.434358] Installing knfsd (copyright (C) 1996 okir@monad.swb.de).
[   25.456325] nf_conntrack version 0.5.0 (3992 buckets, 15968 max)
[   25.468764] ip6_tables: (C) 2000-2006 Netfilter Core Team
[   25.504973] hidraw: raw HID events driver (C) Jiri Kosina
[   25.516603] ip_tables: (C) 2000-2006 Netfilter Core Team
[   25.540339] rtc-mv f1010300.rtc: rtc core: registered f1010300.rtc as rtc0
[   25.558819] usbcore: registered new interface driver usbhid
[   25.564424] usbhid: USB HID core driver
[   25.580701] xt_time: kernel timezone is -0000
[   28.151391] IPv6: ADDRCONF(NETDEV_UP): eth0: link is not ready
procd: - init complete -
[   30.401641] mv643xx_eth_port mv643xx_eth_port.0 eth0: link up, 1000 Mb/s, full duplex, flow control disabled
[   30.411873] IPv6: ADDRCONF(NETDEV_CHANGE): eth0: link becomes ready



BusyBox v1.22.1 (2014-06-23 01:37:36 CEST) built-in shell (ash)
Enter &#039;help&#039; for a list of built-in commands.

  _______                     ________        __
 |       |.-----.-----.-----.|  |  |  |.----.|  |_
 |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|
 |_______||   __|_____|__|__||________||__|  |____|
          |__| W I R E L E S S   F R E E D O M
 -----------------------------------------------------
 BARRIER BREAKER (Bleeding Edge, r41029)
 -----------------------------------------------------
  * 1/2 oz Galliano         Pour all ingredients into
  * 4 oz cold Coffee        an irish coffee mug filled
  * 1 1/2 oz Dark Rum       with crushed ice. Stir.
  * 2 tsp. Creme de Cacao
 -----------------------------------------------------
root@OpenWrt:/#</pre>

</p>

</div>

<h3 class="sectionedit18" id="accessing_iconnect_with_ssh">7. Accessing iConnect with SSH</h3>
<div class="level3">

<p>
To activate SSH you must first login with telnet.
</p>

<p>
In PuTTY set:
<pre class="code">IP: 192.168.1.1
Port: 23
Connection type: Telnet</pre>

</p>

<p>
when logged in type:
<pre class="code">passwd root

Changing password for root
New password:
Retype password:
Password for root changed by root</pre>

</p>

<p>
Telnet access will be disabled, SsH will be enabled.
</p>

</div>

<h3 class="sectionedit19" id="setting_up_internet_access">8. Setting up Internet access</h3>
<div class="level3">

<p>
By default in OpenWRT network address is set to static 192.168.1.1 which may cause conflicts if you have router with the same address. We can change it.
</p>

<p>
Using WinSCP (or vi) open file /etc/config/network
</p>

<p>
If you want to keep it static just change ipaddr value.
</p>

<p>
If you want to use DHCP in local network set it to:
<pre class="code">config interface &#039;lan&#039;
        option ifname &#039;eth0&#039;
        option proto &#039;dhcp&#039;</pre>

</p>

<p>
If you want to use Internet connection from your provider change it to:
<pre class="code">config interface &#039;wan&#039;
        option ifname &#039;eth0&#039;
        option proto &#039;dhcp&#039;
        #option macaddr &#039;00:30:##:##:##:##&#039; #Optional</pre>

</p>

<p>
WAN or <abbr title="Local Area Network">LAN</abbr> names make different from firewall point of view.
</p>

<p>
Save it and reset iConnect.
</p>

<p>
More about network configuration: <a href="../../doc/uci/network" class="urlextern" title="http://wiki.openwrt.org/doc/uci/network"  rel="nofollow">Network Wiki</a>
</p>

</div>

<h3 class="sectionedit20" id="setting_up_the_wireless_adapter_access">9. Setting up the Wireless Adapter access</h3>
<div class="level3">

<p>
To install the RT3090 driver you need to install the kmod-rt2800-pci package:
</p>

<p>
<pre class="code">opkg update
opkg install kmod-rt2800-pci
opkg install iw</pre>

</p>

<p>
Then you should see the options to enable the wireless adapter in luci.
</p>

</div>

<h2 class="sectionedit21" id="flashing_u-boot_with_jtag_unbricking_bootloader">Flashing U-Boot with JTAG (unbricking bootloader)</h2>
<div class="level2">

</div>

<h3 class="sectionedit22" id="introduction">1. Introduction</h3>
<div class="level3">

<p>
This tutorial will show how to flash U-Boot on Iomega iConnect using JTAG.<br/>

It is based on my own experience as I broke U-Boot by improper flashing using serial cable and tftp server.<br/>

<br/>

You might found already one tutorial here <a href="http://hardsoftmix.blogspot.com/2011/07/jtag-on-iconnect.html" class="urlextern" title="http://hardsoftmix.blogspot.com/2011/07/jtag-on-iconnect.html"  rel="nofollow">http://hardsoftmix.blogspot.com/2011/07/jtag-on-iconnect.html</a>, it is written for OpenOCD 0.40
 and works fine if you will use this version and your JTAG interface is working with it like <a href="http://www.amontec.com/jtagkey-tiny.shtml" class="urlextern" title="http://www.amontec.com/jtagkey-tiny.shtml"  rel="nofollow">Amontec JTAGkey-Tiny</a>.<br/>

<br/>

Since I bought my own JTAG interface <a href="http://www.distortec.com/jtag-lock-pick-tiny-2" class="urlextern" title="http://www.distortec.com/jtag-lock-pick-tiny-2"  rel="nofollow">JTAG-lock-pick Tiny 2</a>, which support is included since OpenOCD 0.61 and this version has some
changes in command names which makes it incompatible with old scripts, I decided to write my own tutorial. Additionally I will use
OpenOCD on Windows.
</p>

</div>

<h3 class="sectionedit23" id="hardware_and_software_used">2. Hardware and software used</h3>
<div class="level3">

<p>
Serial Interface based on board PL-2303 which originally was an USB cable for some old Nokia phone.<br/>

<br/>

JTAG interface used:<br/>

- <a href="http://www.distortec.com/jtag-lock-pick-tiny-2" class="urlextern" title="http://www.distortec.com/jtag-lock-pick-tiny-2"  rel="nofollow">JTAG-lock-pick Tiny 2</a> (<a href="http://www.freddiechopin.pl/pl/download/category/5-jtag-lock-pick" class="urlextern" title="http://www.freddiechopin.pl/pl/download/category/5-jtag-lock-pick"  rel="nofollow">manual, drivers, eeprom</a>) - based on latest high speed version of <a href="http://www.ftdichip.com/Products/ICs/FT232H.htm" class="urlextern" title="http://www.ftdichip.com/Products/ICs/FT232H.htm"  rel="nofollow">FT232HL</a> chip, works with OpenOCD 0.61 and higher<br/>

- <a href="http://www.amontec.com/jtagkey-tiny.shtml" class="urlextern" title="http://www.amontec.com/jtagkey-tiny.shtml"  rel="nofollow">Amontec JTAGkey-Tiny</a> - based on <a href="http://www.ftdichip.com/Products/ICs/FT2232D.htm" class="urlextern" title="http://www.ftdichip.com/Products/ICs/FT2232D.htm"  rel="nofollow">FT2232L</a>, works with OpenOCD 0.40 and higher<br/>

- <a href="http://www.kamami.pl/index.php?ukey=product&amp;productID=68017" class="urlextern" title="http://www.kamami.pl/index.php?ukey=product&amp;productID=68017"  rel="nofollow">ZL30PRG</a> (copy of ST-Link v1) - works with OpenOCD 0.61 and higher but only with ST ARMs so it is useless for iConnect (checked)<br/>

- see also <a href="http://openocd.sourceforge.net/doc/html/Debug-Adapter-Hardware.html#Debug-Adapter-Hardware" class="urlextern" title="http://openocd.sourceforge.net/doc/html/Debug-Adapter-Hardware.html#Debug-Adapter-Hardware"  rel="nofollow">supported hardware list</a> on OpenOCD page<br/>

<br/>

Software: OpenOCD <a href="http://openocd.sourceforge.net/" class="urlextern" title="http://openocd.sourceforge.net/"  rel="nofollow">Linux</a> / <a href="http://www.freddiechopin.pl/pl/download/category/4-openocd" class="urlextern" title="http://www.freddiechopin.pl/pl/download/category/4-openocd"  rel="nofollow">Windows</a><br/>

</p>

</div>

<h3 class="sectionedit24" id="installing_jtag_inteface_in_windows">3. Installing JTAG inteface in Windows</h3>
<div class="level3">

<p>
For FTDI chips there are at least four drivers avaliable. You may use:<br/>

<br/>

- FTDI <a href="http://www.ftdichip.com/Drivers/D2XX.htm" class="urlextern" title="http://www.ftdichip.com/Drivers/D2XX.htm"  rel="nofollow">D2XX Direct drivers</a><br/>

- FTDI <a href="http://www.ftdichip.com/Drivers/VCP.htm" class="urlextern" title="http://www.ftdichip.com/Drivers/VCP.htm"  rel="nofollow">Virtual COM Port (VCP) drivers</a><br/>

- <a href="http://libusbx.org/" class="urlextern" title="http://libusbx.org/"  rel="nofollow">WinUSB</a> (libusbx.org)<br/>

- <a href="http://sourceforge.net/apps/trac/libusb-win32/" class="urlextern" title="http://sourceforge.net/apps/trac/libusb-win32/"  rel="nofollow">libusb-win32</a><br/>

<br/>

It is quite confusing which one to choose.<br/>

As I read in manual for JTAG-lock-pick Tiny 2 best option is to use WinUSB drivers so I will use that one.<br/>

Amontec JTAGkey-Tiny works with libusb-win32.<br/>

<br/>

Instalation is simple, just connect JTAG to usb wait till system inform you that cannot find a drivers, then install it manually by device manager providing a patch to WinUSB drivers.<br/>

<br/>

In case that you have a problems with installing drivers or want to replace it use <a href="http://sourceforge.net/projects/libwdi/files/zadig/" class="urlextern" title="http://sourceforge.net/projects/libwdi/files/zadig/"  rel="nofollow">Zadig</a>.<br/>

</p>

</div>

<h3 class="sectionedit25" id="installing_openocd_in_windows">4. Installing OpenOCD in Windows</h3>
<div class="level3">

<p>
Get latest stable version from <a href="http://www.freddiechopin.pl/pl/download/category/4-openocd" class="urlextern" title="http://www.freddiechopin.pl/pl/download/category/4-openocd"  rel="nofollow">www.freddiechopin.pl</a> page, 0.61 is current at this moment (February 2013) and will be used in this article.<br/>

Unzip it to C: and open openocd-0.6.1 folder.<br/>

Download <a href="http://wiki.openwrt.org/_media/media/toh/iomega/iconnect/openocd.config.files.zip" class="media mediafile mf_zip" title="media:toh:iomega:iconnect:openocd.config.files.zip (2.8 KB)">board configuration files</a> for OpenOCD:<br/>

- copy iconnect.cfg  to openocd\scripts\board<br/>

- copy iconnect_connection.cfg to openocd\bin or \openocd\bin-x64<br/>

</p>

<p>
I have 64bit Windows 7 and will use bin-x64 since now.<br/>

</p>

</div>

<h3 class="sectionedit26" id="configuration">5. Configuration</h3>
<div class="level3">

<p>
Open openocd_iconnect.cfg find the line:<br/>

<pre class="code"># Specify JTAG interface configuration file
source [find interface/ftdi/jtag-lock-pick_tiny_2.cfg]</pre>

browse C:\openocd-0.6.1\scripts\interface and find a cfg file whch describes yours interface and replace name.<br/>

</p>

</div>

<h3 class="sectionedit27" id="connecting_with_openocd_to_board">6. Connecting with OpenOCD to board</h3>
<div class="level3">

<p>
Hold &quot;Shift&quot; button and right click on bin-x64 folder and choose &quot;Open command line here&quot;.<br/>

<br/>

Run:<br/>

<pre class="code">openocd-x64-0.6.1.exe -f openocd_iconnect.cfg</pre>

You should see output similar to this:
</p>

<p>
<pre class="code">C:\openocd-0.6.1\bin-x64&gt;openocd-x64-0.6.1.exe -f openocd_iconnect.cfg
Open On-Chip Debugger 0.6.1 (2012-10-07-10:39)
Licensed under GNU GPL v2
For bug reports, read
        http://openocd.sourceforge.net/doc/doxygen/bugs.html
Info : only one transport option; autoselect &#039;jtag&#039;
trst_and_srst separate srst_gates_jtag trst_push_pull srst_open_drain
adapter_nsrst_delay: 200
jtag_ntrst_delay: 200
adapter speed: 6000 kHz
adapter_nsrst_assert_width: 1000
adapter_nsrst_delay: 200
debug_level: 1
    TargetName         Type       Endian TapName            State
--  ------------------ ---------- ------ ------------------ ------------
 0* feroceon.cpu       feroceon   little feroceon.cpu       running
target state: halted
target halted in ARM state due to debug-request, current mode: Supervisor
cpsr: 0x000000d3 pc: 0xffff0000
MMU: disabled, D-Cache: disabled, I-Cache: disabled
background polling: on
TAP: feroceon.cpu (enabled)
target state: halted
target halted in ARM state due to debug-request, current mode: Supervisor
cpsr: 0x000000d3 pc: 0xffff0000
MMU: disabled, D-Cache: disabled, I-Cache: disabled</pre>

</p>

<p>
in case that you have got an error like this below, try again.
<pre class="code">TARGET: feroceon.cpu - Not halted

Runtime Error: openocd_iconnect.cfg:40:
in procedure &#039;script&#039;
at file &quot;embedded:startup.tcl&quot;, line 58
in procedure &#039;reset&#039; called at file &quot;openocd_iconnect.cfg&quot;, line 40</pre>

</p>

<p>
If still not working go to <em>openocd_iconnect.cfg</em> and comment line <em>reset halt</em>, uncomment <em>reset run</em> and <em>soft_reset_halt</em>.<br/>

In case of further problems refer to OpenOCD manual section Reset Configuration.
</p>

</div>

<h3 class="sectionedit28" id="connect_to_openocd_telnet_interface">7. Connect to OpenOCD telnet interface.</h3>
<div class="level3">

<p>
You may use <a href="http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html" class="urlextern" title="http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html"  rel="nofollow">PuTTY</a> for that.<br/>

<br/>

Configure as follow:
<pre class="code">Host Name: 127.0.0.1
Port: 4444
Connection type: Telnet</pre>

You may want to save configuration for future usage.<br/>

<br/>

Now click &quot;Open&quot; button, you should see welcome message:<br/>

<pre class="code">Open On-Chip Debugger
&gt;</pre>

</p>

</div>

<h3 class="sectionedit29" id="first_method_-_direct_flash_u-boot">8. First method - direct flash U-Boot</h3>
<div class="level3">

<p>
Download U-Boot image openwrt-kirkwood-iconnect-u-boot.kwb from:<br/>

- OpenWRT trunk <a href="http://downloads.openwrt.org/snapshots/trunk/kirkwood/uboot-kirkwood-iconnect/" class="urlextern" title="http://downloads.openwrt.org/snapshots/trunk/kirkwood/uboot-kirkwood-iconnect/"  rel="nofollow">http://downloads.openwrt.org/snapshots/trunk/kirkwood/uboot-kirkwood-iconnect/</a><br/>

- or from stable branch <a href="http://downloads.openwrt.org/attitude_adjustment/" class="urlextern" title="http://downloads.openwrt.org/attitude_adjustment/"  rel="nofollow">http://downloads.openwrt.org/attitude_adjustment/</a> if already relased.<br/>

<br/>

Save it to C:\openocd-0.6.1\bin-x64<br/>

<br/>

Go to PuTTY session and execute:<br/>

<pre class="code">iconnect_reflash_uboot</pre>

</p>

<p>
If it works you are lucky, unfortunately it does not work for me. I keep getting error:
<pre class="code">nand write 0 openwrt-kirkwood-iconnect-u-boot.kwb 0 oob_softecc_kw
timed out while waiting for target halted
error executing hosted NAND write
Unable to write data to NAND device
failed writing file openwrt-kirkwood-iconnect-u-boot.kwb to NAND flash 0 at offset 0x00000000</pre>

So I found second option.
</p>

</div>

<h3 class="sectionedit30" id="second_method_-_booting_u-boot_in_ram_and_flashing_image_using_it">9. Second method - booting U-Boot in RAM and flashing image using it.</h3>
<div class="level3">

<p>
Download U-Boot image openwrt-kirkwood-iconnect-u-boot.kwb from:<br/>

- OpenWRT trunk <a href="http://downloads.openwrt.org/snapshots/trunk/kirkwood/uboot-kirkwood-iconnect/" class="urlextern" title="http://downloads.openwrt.org/snapshots/trunk/kirkwood/uboot-kirkwood-iconnect/"  rel="nofollow">http://downloads.openwrt.org/snapshots/trunk/kirkwood/uboot-kirkwood-iconnect/</a><br/>

- or from stable branch <a href="http://downloads.openwrt.org/attitude_adjustment/" class="urlextern" title="http://downloads.openwrt.org/attitude_adjustment/"  rel="nofollow">http://downloads.openwrt.org/attitude_adjustment/</a> if already relased.<br/>

<br/>

This is alternative to direct flashing which is not working in my case.<br/>

We will run U-Boot in RAM and flash it&#039;s image using U-Boot itself and tftp server.<br/>

<br/>

You need:<br/>

- serial cable installed and connected to board serial port<br/>

- download tftpd server ZIP file from here <a href="http://tftpd32.jounin.net/" class="urlextern" title="http://tftpd32.jounin.net/"  rel="nofollow">http://tftpd32.jounin.net/</a><br/>

</p>

</div>

<h4 id="prepare_network_card_settings">9.1 Prepare network card settings</h4>
<div class="level4">

<p>
Go to Start → Control Pannel → Network and Sharing Center → Local Area connection → Properties → Internet Protocol Version 4(TCP/IPv4)
</p>

<p>
Choose &quot;Use the following IP address&quot; and set:
</p>

<p>
IP address: 192.168.1.5
Sybnet mask: 255.255.255.0
</p>

<p>
Confirm by clicking OK.
</p>

</div>

<h4 id="prepare_tftpd_server">9.2 Prepare tftpd server</h4>
<div class="level4">

<p>
Extract tftpd zip to <em>c:\tftpd</em>, create folder <em>c:\tftpd\files</em>.
</p>

<p>
Copy downloaded <em>openwrt-kirkwood-iconnect-u-boot.kwb</em> to <em>c:\tftpd\files</em>.
</p>

<p>
Run tftpd, click &quot;Settings&quot; button, choose TFTP tab and set &quot;Base Directory&quot; to <em>c:\tftpd\files</em>, click OK button.
</p>

<p>
Check if Server interface is 192.168.1.5, if not choose it from the list.
</p>

</div>

<h4 id="runing_u-boot_from_ram">9.3 Runing U-Boot from RAM.</h4>
<div class="level4">

<p>
Establish Connection with board as described in point 6 and 7.
</p>

<p>
Using PuTTY connect to your serial cable, put window in visible area and monitor it.
</p>

<p>
In OpenOCD telnet connection (established in point 7) run:
<pre class="code">Open On-Chip Debugger
&gt; iconnect_load_uboot_bin</pre>

</p>

<p>
you should see this:
<pre class="code">target state: halted
target halted in ARM state due to debug-request, current mode: Supervisor
cpsr: 0x000000d3 pc: 0xffff0000
MMU: disabled, D-Cache: disabled, I-Cache: disabled
use of EmbeddedICE dbgrq instead of breakpoint for target halt disabled
400620 bytes written at address 0x00600000
downloaded 400620 bytes in 18.702635s (20.918 KiB/s)
&gt;</pre>

Then on serial console you will see booting U-Boot:
<pre class="code">U-Boot 2012.10 (Feb 12 2013 - 18:24:56) Iomega iConnect

SoC:   Kirkwood 88F6281_A0
DRAM:  128 MiB
WARNING: Caches not enabled
NAND:  512 MiB
*** Warning - bad CRC, using default environment

In:    serial
Out:   serial
Err:   serial
Net:   egiga0
Warning: failed to set MAC address

Hit any key to stop autoboot:  0 
iconnect =&gt;</pre>

Press enter key as soon as you will see &quot;Hit any key to stop autoboot&quot;.
</p>

</div>

<h4 id="configure_basic_env_variables">9.4 Configure basic env variables</h4>
<div class="level4">

<p>
We need to set server address and iConnect address to establish communication.
</p>

<p>
In Serial console execute:
<pre class="code">setenv ethaddr &#039;00:D0:01:01:01:01&#039;
setenv serverip 192.168.1.5
setenv ipaddr 192.168.1.200</pre>

then:
<pre class="code">mw 0x0800000 0xffff 0x100000 
nand erase 0x0 0x100000
tftp 0x0800000 openwrt-kirkwood-iconnect-u-boot.kwb
nand write 0x0800000 0x0 0x100000</pre>

Here is an output which you will see:
<pre class="code">iconnect =&gt; setenv ethaddr &#039;00:D0:01:01:01:01&#039;
iconnect =&gt; setenv serverip 192.168.1.5
iconnect =&gt; setenv ipaddr 192.168.1.200
iconnect =&gt; mw 0x0800000 0xffff 0x100000
iconnect =&gt; nand erase 0x0 0x100000

NAND erase: device 0 offset 0x0, size 0x100000
Erasing at 0xe0000 -- 100% complete.
OK

iconnect =&gt; tftp 0x0800000 openwrt-kirkwood-iconnect-u-boot.kwb
Using egiga0 device
TFTP from server 192.168.1.5; our IP address is 192.168.1.200
Filename &#039;openwrt-kirkwood-iconnect-u-boot.kwb&#039;.
Load address: 0x800000
Loading: ############################
done
Bytes transferred = 401136 (61ef0 hex)

iconnect =&gt; nand write 0x0800000 0x0 0x100000

NAND write: device 0 offset 0x0, size 0x100000
 1048576 bytes written: OK</pre>

Now reset it by executing:
<pre class="code">reset</pre>

After reset the blue LED should start blinking and on serial console you will see U-Boot boot messages.
</p>

<p>
That&#039;s all your iConnect is unbricked.
</p>

</div>

<h3 class="sectionedit31" id="post_rescue_procedure">10. Post rescue procedure.</h3>
<div class="level3">

<p>
You should set basic env settings by executing:
<pre class="code">setenv ethaddr &#039;00:D0:##:##:##:##&#039; #Put here your real MAC address
setenv serverip 192.168.1.5
setenv ipaddr 192.168.1.200
saveenv</pre>

For OpenWRT installation instructions see above.
</p>

</div>

                    <!-- wikipage stop -->
                                    </div>

                <div class="docInfo"><bdi>toh/iomega/iconnect.txt</bdi> · Last modified: 2014/06/24 23:55 by <bdi>diizzy</bdi></div>

                            </div></div><!-- /content -->

            <hr class="a11y" />

            <!-- PAGE ACTIONS -->
            <div id="dokuwiki__pagetools">
                <h3 class="a11y">Page Tools</h3>
                <div class="tools">
                    <ul>
                        <li><a href="http://wiki.openwrt.org/toh/iomega/iconnect?do=edit"  class="action source" accesskey="v" rel="nofollow" title="Show pagesource [V]"><span>Show pagesource</span></a></li><li><a href="http://wiki.openwrt.org/toh/iomega/iconnect?do=revisions"  class="action revs" accesskey="o" rel="nofollow" title="Old revisions [O]"><span>Old revisions</span></a></li><li><a href="http://wiki.openwrt.org/toh/iomega/iconnect?do=backlink"  class="action backlink" rel="nofollow" title="Backlinks"><span>Backlinks</span></a></li><li><a href="iconnect#dokuwiki__top"  class="action top" accesskey="t" rel="nofollow" title="Back to top [T]"><span>Back to top</span></a></li>                    </ul>
                </div>
            </div>
        </div><!-- /wrapper -->

        
<!-- ********** FOOTER ********** -->
<div id="dokuwiki__footer"><div class="pad">
    <div class="license">Except where otherwise noted, content on this wiki is licensed under the following license: <bdi><a href="http://creativecommons.org/licenses/by-nc-sa/3.0/" rel="license" class="urlextern">CC Attribution-Noncommercial-Share Alike 3.0 Unported</a></bdi></div>
    <div class="buttons">
        <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/" rel="license"><img src="../../lib/images/license/button/cc-by-nc-sa.png" alt="CC Attribution-Noncommercial-Share Alike 3.0 Unported" /></a>        <a href="http://www.dokuwiki.org/donate" title="Donate" ><img
            src="../../lib/tpl/openwrt/images/button-donate.gif" width="80" height="15" alt="Donate" /></a>
        <a href="http://www.php.net" title="Powered by PHP" ><img
            src="../../lib/tpl/openwrt/images/button-php.gif" width="80" height="15" alt="Powered by PHP" /></a>
        <a href="http://validator.w3.org/check/referer" title="Valid HTML5" ><img
            src="../../lib/tpl/openwrt/images/button-html5.png" width="80" height="15" alt="Valid HTML5" /></a>
        <a href="http://jigsaw.w3.org/css-validator/check/referer?profile=css3" title="Valid CSS" ><img
            src="../../lib/tpl/openwrt/images/button-css.png" width="80" height="15" alt="Valid CSS" /></a>
        <a href="http://dokuwiki.org/" title="Driven by DokuWiki" ><img
            src="../../lib/tpl/openwrt/images/button-dw.png" width="80" height="15" alt="Driven by DokuWiki" /></a>
    </div>
</div></div><!-- /footer -->

    </div></div><!-- /site -->

    <div class="no"><img src="http://wiki.openwrt.org/lib/exe/indexer.php?id=toh%3Aiomega%3Aiconnect&amp;1432287319" width="2" height="1" alt="" /></div>
    <div id="screen__mode" class="no"></div>    <!--[if ( lte IE 7 | IE 8 ) ]></div><![endif]-->
</body>
</html>
