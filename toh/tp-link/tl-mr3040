<!DOCTYPE html>
<html lang="en" dir="ltr" class="no-js">
<head>
    <meta charset="utf-8" />
    <title>TP-Link TL-MR3040 [OpenWrt Wiki]</title>
    <script>(function(H){H.className=H.className.replace(/\bno-js\b/,'js')})(document.documentElement)</script>
    <meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="keywords" content="fastethernet,1nic,1wnic,no switch,serial,integrated,1ant,1usb,802.11bgn,ar9331,ath9k,32ram,4flash,mips,mips32,24k,ap121,portable router,rechargeable battery"/>
<link rel="search" type="application/opensearchdescription+xml" href="../../lib/exe/opensearch.php" title="OpenWrt Wiki"/>
<link rel="start" href="../../index.html"/>
<link rel="contents" href="tl-mr3040?do=index" title="Sitemap"/>
<link rel="alternate" type="application/rss+xml" title="Recent changes" href="../../feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Current namespace" href="../../feed.php?mode=list&amp;ns=toh:tp-link"/>
<link rel="alternate" type="text/html" title="Plain HTML" href="../../_export/xhtml/toh/tp-link/tl-mr3040"/>
<link rel="alternate" type="text/plain" title="Wiki Markup" href="../../_export/raw/toh/tp-link/tl-mr3040"/>
<link rel="canonical" href="tl-mr3040"/>
<link rel="stylesheet" type="text/css" href="../../lib/exe/css.php?t=openwrt&amp;tseed=6f44f363dc87908d905dc56ff3acbfc4"/>
<script type="text/javascript">/*<![CDATA[*/var NS='toh:tp-link';var JSINFO = {"id":"toh:tp-link:tl-mr3040","namespace":"toh:tp-link"};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="../../lib/exe/js.php?tseed=6f44f363dc87908d905dc56ff3acbfc4"></script>
<script type="text/javascript" charset="utf-8">/*<![CDATA[*/jQuery(function(){
	for ( i=0; i < document.forms.length; i++ ) {
		if (document.forms[i].method == 'post') {
			var myElement = document.createElement('input');
			myElement.setAttribute('type', 'hidden');
			myElement.name = 'bb2_screener_';
			myElement.value = '1432278345 166.182.3.85';
			document.forms[i].appendChild(myElement);
		}
	}
});
/*!]]>*/</script>
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <link rel="shortcut icon" href="../../lib/tpl/openwrt/images/favicon.ico" />
<link rel="apple-touch-icon" href="../../lib/tpl/openwrt/images/apple-touch-icon.png" />
    </head>

<body>
    <!--[if lte IE 7 ]><div id="IE7"><![endif]--><!--[if IE 8 ]><div id="IE8"><![endif]-->
    <div id="dokuwiki__site"><div id="dokuwiki__top" class="site dokuwiki mode_show tpl_openwrt     ">

        
<!-- ********** HEADER ********** -->
<div id="dokuwiki__header"><div class="pad group">

    
    <div class="headings group">
        <ul class="a11y skip">
            <li><a href="tl-mr3040#dokuwiki__content">skip to content</a></li>
        </ul>

        <h1><a href="../../start"  accesskey="h" title="[H]"><img src="../../lib/tpl/openwrt/images/logo.png" width="386" height="98" alt="" /> <span>OpenWrt Wiki</span></a></h1>
            </div>

    <div class="tools group">
        <!-- USER TOOLS -->
                    <div id="dokuwiki__usertools">
                <h3 class="a11y">User Tools</h3>
                <ul>
                    <li><a href="tl-mr3040?do=register"  class="action register" rel="nofollow" title="Register">Register</a></li><li><a href="tl-mr3040?do=login&amp;sectok=382740b13d95f946eed36caa57076b4a"  class="action login" rel="nofollow" title="Login">Login</a></li>                </ul>
            </div>
        
        <!-- SITE TOOLS -->
        <div id="dokuwiki__sitetools">
            <h3 class="a11y">Site Tools</h3>
            <form action="../../start" accept-charset="utf-8" class="search" id="dw__search" method="get" role="search"><div class="no"><input type="hidden" name="do" value="search" /><input type="text" id="qsearch__in" accesskey="f" name="id" class="edit" title="[F]" /><input type="submit" value="Search" class="button" title="Search" /><div id="qsearch__out" class="ajax_qsearch JSpopup"></div></div></form>            <div class="mobileTools">
                <form action="../../doku.php" method="get" accept-charset="utf-8"><div class="no"><input type="hidden" name="id" value="toh:tp-link:tl-mr3040" /><select name="do" class="edit quickselect" title="Tools"><option value="">Tools</option><optgroup label="Page Tools"><option value="edit">Show pagesource</option><option value="revisions">Old revisions</option><option value="backlink">Backlinks</option></optgroup><optgroup label="Site Tools"><option value="recent">Recent changes</option><option value="media">Media Manager</option><option value="index">Sitemap</option></optgroup><optgroup label="User Tools"><option value="login">Login</option><option value="register">Register</option></optgroup></select><input type="submit" value="&gt;" /></div></form>            </div>
            <ul>
                <li><a href="tl-mr3040?do=recent"  class="action recent" accesskey="r" rel="nofollow" title="Recent changes [R]">Recent changes</a></li><li><a href="tl-mr3040?do=media&amp;ns=toh%253Atp-link"  class="action media" rel="nofollow" title="Media Manager">Media Manager</a></li><li><a href="tl-mr3040?do=index"  class="action index" accesskey="x" rel="nofollow" title="Sitemap [X]">Sitemap</a></li>            </ul>
        </div>

    </div>

    <!-- BREADCRUMBS -->
            <div class="breadcrumbs">
                            <div class="youarehere"><span class="bchead">You are here: </span><span class="home"><bdi><a href="../../start" class="wikilink1" title="start">OpenWrt Wiki</a></bdi></span> » <bdi><a href="../start" class="wikilink1" title="toh:start">Table of Hardware</a></bdi> » <bdi><a href="start" class="wikilink1" title="toh:tp-link:start">TP-Link</a></bdi> » <bdi><span class="curid"><a href="tl-mr3040" class="wikilink1" title="toh:tp-link:tl-mr3040">TP-Link TL-MR3040</a></span></bdi></div>
                                    <div class="plugin_multilingual">
        <ul>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/cz/toh/tp-link/tl-mr3040" class="media" title="cz:toh:tp-link:tl-mr3040"><img src="../../lib/exe/fetch.php?cache=&amp;tok=aff589&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fcz.gif" class="media" title="Čeština (Czech)" alt="Čeština (Czech)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/de/toh/tp-link/tl-mr3040" class="media" title="de:toh:tp-link:tl-mr3040"><img src="../../lib/exe/fetch.php?cache=&amp;tok=e24010&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fde.gif" class="media" title="Deutsch (German)" alt="Deutsch (German)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <span class="curid"><a href="tl-mr3040" class="media" title="toh:tp-link:tl-mr3040"><img src="../../lib/exe/fetch.php?cache=&amp;tok=2a37ae&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fgb.gif" class="media" title="English" alt="English" /></a></span>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/es/toh/tp-link/tl-mr3040" class="media" title="es:toh:tp-link:tl-mr3040"><img src="../../lib/exe/fetch.php?cache=&amp;tok=46c004&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fmx.gif" class="media" title="Español (Spanish, Mexico)" alt="Español (Spanish, Mexico)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/fr/toh/tp-link/tl-mr3040" class="media" title="fr:toh:tp-link:tl-mr3040"><img src="../../lib/exe/fetch.php?cache=&amp;tok=a5beba&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Ffr.gif" class="media" title="Français (French)" alt="Français (French)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/hu/toh/tp-link/tl-mr3040" class="media" title="hu:toh:tp-link:tl-mr3040"><img src="../../lib/exe/fetch.php?cache=&amp;tok=6b5470&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fhu.gif" class="media" title="Magyar (Hungarian)" alt="Magyar (Hungarian)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/jp/toh/tp-link/tl-mr3040" class="media" title="jp:toh:tp-link:tl-mr3040"><img src="../../lib/exe/fetch.php?cache=&amp;tok=f999fc&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fjp.gif" class="media" title="日本語 (Japanese)" alt="日本語 (Japanese)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/pl/toh/tp-link/tl-mr3040" class="media" title="pl:toh:tp-link:tl-mr3040"><img src="../../lib/exe/fetch.php?cache=&amp;tok=c805c0&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fpl.gif" class="media" title="Poliski (Polish)" alt="Poliski (Polish)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/pt-br/toh/tp-link/tl-mr3040" class="media" title="pt-br:toh:tp-link:tl-mr3040"><img src="../../lib/exe/fetch.php?cache=&amp;tok=13127d&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fbr.gif" class="media" title="Português brasileiro (Portuguese, Brasil)" alt="Português brasileiro (Portuguese, Brasil)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/ru/toh/tp-link/tl-mr3040" class="media" title="ru:toh:tp-link:tl-mr3040"><img src="../../lib/exe/fetch.php?cache=&amp;tok=66ab5e&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fru.gif" class="media" title="Русский (Russsian)" alt="Русский (Russsian)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/tr/toh/tp-link/tl-mr3040" class="media" title="tr:toh:tp-link:tl-mr3040"><img src="../../lib/exe/fetch.php?cache=&amp;tok=f4beed&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Ftr.gif" class="media" title="Tϋrkçe (Turkish)" alt="Tϋrkçe (Turkish)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/zh-cn/toh/tp-link/tl-mr3040" class="media" title="zh-cn:toh:tp-link:tl-mr3040"><img src="../../lib/exe/fetch.php?cache=&amp;tok=93625a&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fzh-cn.gif" class="media" title="官話/官话 (Chinese)" alt="官話/官话 (Chinese)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/zh-tw/toh/tp-link/tl-mr3040" class="media" title="zh-tw:toh:tp-link:tl-mr3040"><img src="../../lib/exe/fetch.php?cache=&amp;tok=b56198&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fzh-tw.gif" class="media" title="臺灣華語 (Taiwanese)" alt="臺灣華語 (Taiwanese)" /></a>
              </div>
            </div>
          </li>
        </ul>
      </div>
        </div>
    
    
    <hr class="a11y" />
</div></div><!-- /header -->

        <div class="wrapper group">

            
            <!-- ********** CONTENT ********** -->
            <div id="dokuwiki__content"><div class="pad group">

                <div class="pageId"><span>toh:tp-link:tl-mr3040</span></div>

                <div class="page group">
                                                            <!-- wikipage start -->
                    <!-- TOC START -->
<div id="dw__toc">
<h3 class="toggle">Table of Contents</h3>
<div>

<ul class="toc">
<li class="level1"><div class="li"><a href="tl-mr3040#supported_versions">Supported Versions</a></div></li>
<li class="level1"><div class="li"><a href="tl-mr3040#hardware_highlights">Hardware Highlights</a></div></li>
<li class="level1"><div class="li"><a href="tl-mr3040#tl-mr3040_and_tl-mr11u_differences">TL-MR3040 and TL-MR11U differences</a></div></li>
<li class="level1"><div class="li"><a href="tl-mr3040#installation">Installation</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="tl-mr3040#version_10">Version 1.0</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="tl-mr3040#method_using_web_gui_recommended">Method Using Web GUI (Recommended)</a></div></li>
<li class="level3"><div class="li"><a href="tl-mr3040#manual_flash_under_u-boot_serial_console">Manual Flash under U-Boot Serial Console</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="tl-mr3040#version_2x">Version 2.x</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="tl-mr3040#method_using_web_gui_recommended1">Method Using Web GUI (Recommended)</a></div></li>
<li class="level3"><div class="li"><a href="tl-mr3040#manual_flash_under_u-boot_serial_console1">Manual Flash under U-Boot Serial Console</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="tl-mr3040#upgrading_openwrt">Upgrading OpenWrt</a></div></li>
<li class="level2"><div class="li"><a href="tl-mr3040#failsafe_mode">Failsafe Mode</a></div></li>
</ul>
</li>
<li class="level1"><div class="li"><a href="tl-mr3040#restoring_original_firmware">Restoring Original Firmware</a></div></li>
<li class="level1"><div class="li"><a href="tl-mr3040#basic_configuration">Basic Configuration</a></div></li>
<li class="level1"><div class="li"><a href="tl-mr3040#original_flash_layout">Original Flash Layout</a></div></li>
<li class="level1"><div class="li"><a href="tl-mr3040#hardware">Hardware</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="tl-mr3040#opening_the_device">Opening the device</a></div></li>
<li class="level2"><div class="li"><a href="tl-mr3040#info">Info</a></div></li>
<li class="level2"><div class="li"><a href="tl-mr3040#serial_console">Serial Console</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="tl-mr3040#u-boot_bootloader_console">U-Boot Bootloader Console</a></div></li>
<li class="level3"><div class="li"><a href="tl-mr3040#linux_console">Linux Console</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="tl-mr3040#photos_v10">Photos (v1.0)</a></div></li>
<li class="level2"><div class="li"><a href="tl-mr3040#photos_v21">Photos (v2.1)</a></div></li>
<li class="level2"><div class="li"><a href="tl-mr3040#hardware_info_v21">Hardware info (v2.1)</a></div></li>
<li class="level2"><div class="li"><a href="tl-mr3040#tl-mr3040_reverse_engineering">TL-MR3040 Reverse Engineering</a></div></li>
<li class="level2"><div class="li"><a href="tl-mr3040#gpios">GPIOs</a></div></li>
<li class="level2"><div class="li"><a href="tl-mr3040#leds">LEDs</a></div></li>
<li class="level2"><div class="li"><a href="tl-mr3040#usb_port">USB Port</a></div></li>
<li class="level2"><div class="li"><a href="tl-mr3040#hardware_slide_switch_v2">Hardware slide switch (v2)</a></div></li>
</ul>
</li>
<li class="level1"><div class="li"><a href="tl-mr3040#bootloader_mods">Bootloader Mods</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="tl-mr3040#u-boot_114_modification_for_routers">U-Boot 1.1.4 modification for routers</a></div></li>
</ul>
</li>
<li class="level1"><div class="li"><a href="tl-mr3040#bootlog">Bootlog</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="tl-mr3040#factory_bootlog">Factory BootLog</a></div></li>
</ul>
</li>
<li class="level1"><div class="li"><a href="tl-mr3040#resources">Resources</a></div></li>
<li class="level1"><div class="li"><a href="tl-mr3040#custom_openwrt_image_with_luci_integrated">Custom OpenWrt image with LuCi integrated</a></div></li>
<li class="level1"><div class="li"><a href="tl-mr3040#tags">Tags</a></div></li>
</ul>
</div>
</div>
<!-- TOC END -->

<h1 class="sectionedit1" id="tp-link_tl-mr3040">TP-Link TL-MR3040</h1>
<div class="level1">

<p>
A portable router with an onboard 2000mAh <a href="tl-mr3040#tags" title="toh:tp-link:tl-mr3040 ↵" class="wikilink1">rechargeable_battery</a>. See also <a href="tl-mr10u" class="wikilink1" title="toh:tp-link:tl-mr10u">TP-Link TL-MR10U</a>, <a href="tl-mr11u" class="wikilink1" title="toh:tp-link:tl-mr11u">TP-Link TL-MR11U</a>, <a href="tl-mr12u" class="wikilink1" title="toh:tp-link:tl-mr12u">TP-Link TL-MR12U</a>, <a href="tl-mr13u" class="wikilink1" title="toh:tp-link:tl-mr13u">TP-Link TL-MR13U</a> and <a href="tl-mr3020" class="wikilink1" title="toh:tp-link:tl-mr3020">TP-Link TL-MR3020</a>, <a href="tl-wr703n" class="wikilink1" title="toh:tp-link:tl-wr703n">TP-Link TL-WR703N</a>.<br/>

Although it is marketed as a &quot;3G/4G router&quot;, the TL-MR3040 does not include a 3G/4G modem. It simply means that the OEM firmware and <abbr title="Graphical User Interface">GUI</abbr> support a certain range of USB 3G modems, but, OpenWrt supports 3G modems too.
</p>

</div>

<h2 class="sectionedit2" id="supported_versions">Supported Versions</h2>
<div class="level2">
<div class="table sectionedit3"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0"> Version/Model </th><th class="col1"> Launch Date </th><th class="col2"> OpenWrt Version Supported </th><th class="col3"> Model Specific Notes </th><th class="col4"> Hardware differences </th>
	</tr>
	</thead>
	<tr class="row1">
		<td class="col0 leftalign"> v1.0          </td><td class="col1 leftalign"> May 2012    </td><td class="col2"> <a href="https://dev.openwrt.org/changeset/31845" class="urlextern" title="https://dev.openwrt.org/changeset/31845"  rel="nofollow">Trunk R31845</a> </td><td class="col3"> Confirmed working </td><td class="col4">-</td>
	</tr>
	<tr class="row2">
		<td class="col0 leftalign"> v2.0          </td><td class="col1"> January 2013</td><td class="col2"> <a href="https://dev.openwrt.org/changeset/37964" class="urlextern" title="https://dev.openwrt.org/changeset/37964"  rel="nofollow">Trunk R37964</a> </td><td class="col3"> Confirmed working on v2.1 hardware </td><td class="col4"> Mode Switch button </td>
	</tr>
	<tr class="row3">
		<td class="col0 leftalign"> v2.2          </td><td class="col1"> October 2013</td><td class="col2 leftalign">  </td><td class="col3"> Confirmed working on v2.2 hardware </td><td class="col4"> Mode Switch button </td>
	</tr>
	<tr class="row4">
		<td class="col0 leftalign"> v2.3          </td><td class="col1 leftalign"> 2014        </td><td class="col2 leftalign">  </td><td class="col3"> Confirmed working on v2.3 hardware </td><td class="col4 leftalign">  </td>
	</tr>
	<tr class="row5">
		<td class="col0 leftalign"> v2.4          </td><td class="col1 leftalign"> Dec 2014    </td><td class="col2"> Barrier Breaker </td><td class="col3"> Confirmed working on v2.4 hardware </td><td class="col4"> B.A.T.M.A.N. -adv also supported</td>
	</tr>
</table></div>

</div>

<h2 class="sectionedit4" id="hardware_highlights">Hardware Highlights</h2>
<div class="level2">
<div class="table sectionedit5"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0 centeralign">  CPU                  </th><th class="col1 centeralign">  Ram   </th><th class="col2 centeralign">  Flash  </th><th class="col3 centeralign">  Network   </th><th class="col4 centeralign">  USB   </th><th class="col5 rightalign">  Serial </th><th class="col6 centeralign">  JTag  </th>
	</tr>
	</thead>
	<tr class="row1">
		<td class="col0"> Atheros AR7240 @ 400MHz </td><td class="col1"> 32 MiB </td><td class="col2 leftalign"> 4 MiB   </td><td class="col3"> 1x 100MBit </td><td class="col4"> 1x 2.0 </td><td class="col5 leftalign"> YES     </td><td class="col6 leftalign"> NO     </td>
	</tr>
</table></div>
<ul>
<li class="level1"><div class="li"> SoC: Atheros AR9331 rev1</div>
</li>
<li class="level1"><div class="li"> 802.11 b/g/n 150Mbps</div>
</li>
<li class="level1"><div class="li"> Powered via mini-USB (5V) or Li-ion Battery included (4-5 hours)</div>
</li>
<li class="level1"><div class="li"> Only 94g<br/>
</div>
</li>
</ul>

</div>

<h2 class="sectionedit6" id="tl-mr3040_and_tl-mr11u_differences">TL-MR3040 and TL-MR11U differences</h2>
<div class="level2">

<p>
Althought MR3040 and MR11U seem similar on the outside, the inside isn´t that similar. Here are the differences:
</p>
<ul>
<li class="level1"><div class="li"> MR11U is chinese only</div>
</li>
<li class="level1"><div class="li"> MR3040(v1.0/v2.0) doesn´t have QSS button</div>
</li>
<li class="level1"><div class="li"> USP_POWER GPIO is diferrent</div>
</li>
<li class="level1"><div class="li"> Some buttons are on different sides with different looks</div>
</li>
<li class="level1"><div class="li"> Also the layers printed on the PCB are different and also some connections</div>
</li>
<li class="level1"><div class="li"> <a href="../../_media/media/mr3040.mr11u.jpg" class="urlextern" title="http://wiki.openwrt.org/_media/media/mr3040.mr11u.jpg"  rel="nofollow">MR3040 compared to MR11U photo</a><br/>
</div>
</li>
</ul>

</div>

<h2 class="sectionedit7" id="installation">Installation</h2>
<div class="level2">

</div>

<h3 class="sectionedit8" id="version_10">Version 1.0</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"> Download the Barrier Breaker stable release from <a href="http://downloads.openwrt.org/barrier_breaker/14.07/ar71xx/generic/openwrt-ar71xx-generic-tl-mr3040-v1-squashfs-factory.bin" class="urlextern" title="http://downloads.openwrt.org/barrier_breaker/14.07/ar71xx/generic/openwrt-ar71xx-generic-tl-mr3040-v1-squashfs-factory.bin"  rel="nofollow">here</a></div>
</li>
</ul>

</div>

<h4 id="method_using_web_gui_recommended">Method Using Web GUI (Recommended)</h4>
<div class="level4">

<p>
As with most TP-Link Routers this one can be flashed using the TP-Link Webinterface.
Connect to the TL-MR3040 router via Ethernet cable at IP address 192.168.0.1, login to the router&#039;s web <abbr title="Graphical User Interface">GUI</abbr> (default login/password: admin / admin), and overwrite the factory firmware by installing the <strong>openwrt-ar71xx-generic-tl-mr3040-v1-squashfs-factory.bin</strong>  like a regular firmware update.
</p>

<p>
Wait for the progress bar to finish twice (the device will reset itself in the process), and proceed with basic configuration as with any fresh OpenWRT install.
</p>

</div>

<h4 id="manual_flash_under_u-boot_serial_console">Manual Flash under U-Boot Serial Console</h4>
<div class="level4">
<ul>
<li class="level1"><div class="li"> To install OpenWrt from the U-Boot console, you need to install a TFTP server on your computer.</div>
</li>
<li class="level1"><div class="li"> By default the server is set to 192.168.0.100, you can check detail by &#039;printenv&#039;</div>
</li>
<li class="level1"><div class="li"> The serial layout is <strong>p1</strong>: →<span class="curid"><a href="tl-mr3040#serial_console" class="wikilink1" title="toh:tp-link:tl-mr3040">serial_console</a></span></div>
</li>
<li class="level1"><div class="li"> Setup serial console 115200 8n1, for example: <strong>screen /dev/ttyUSB0 115200 ixoff</strong></div>
</li>
</ul>

<p>
Power up the TL-MR3040, after a 1-2 seconds U-Boot announces &quot;Autobooting in 1 seconds&quot;, when displaying this enter tpl immediately.
</p>

<p>
<pre class="code">Autobooting in 1 seconds
[type tpl here]</pre>

</p>

<p>
You will get a U-Boot-console, it shows as <strong>hornet&gt;</strong>, and you must enter the following commands:
</p>

<p>
<pre class="code">hornet&gt; tftpboot 0x81000000 openwrt-ar71xx-generic-tl-mr3040-v1-squashfs-factory.bin
Using eth0 device
TFTP from server 192.168.0.100; our IP address is 192.168.0.1
Filename &#039;openwrt-ar71xx-generic-tl-mr3040-v1-squashfs-factory.bin&#039;.
Load address: 0x81000000
Loading: #################################################################
         #################################################################
         #################################################################
         #################################################################
         #################################################################
         #################################################################
         #################################################################
         #################################################################
         #################################################################
         #################################################################
         #################################################################
         ######################################################
done
Bytes transferred = 3932160 (3c0000 hex)
hornet&gt; erase 0x9f020000 +0x3c0000

First 0x2 last 0x3d sector size 0x10000                                                                                                        61
Erased 60 sectors
hornet&gt; cp.b 0x81000000 0x9f020000 0x3c0000
Copy to Flash... write addr: 9f020000

done
hornet&gt; bootm 9f020000</pre>

</p>

</div>

<h3 class="sectionedit9" id="version_2x">Version 2.x</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"> Download the Barrier Breaker stable release from <a href="http://downloads.openwrt.org/barrier_breaker/14.07/ar71xx/generic/openwrt-ar71xx-generic-tl-mr3040-v2-squashfs-factory.bin" class="urlextern" title="http://downloads.openwrt.org/barrier_breaker/14.07/ar71xx/generic/openwrt-ar71xx-generic-tl-mr3040-v2-squashfs-factory.bin"  rel="nofollow">here</a></div>
</li>
</ul>

</div>

<h4 id="method_using_web_gui_recommended1">Method Using Web GUI (Recommended)</h4>
<div class="level4">

<p>
Same as for v1.0 (that is, log into the OEM web interface, usually at <a href="http://192.168.0.1/" class="urlextern" title="http://192.168.0.1/"  rel="nofollow">http://192.168.0.1/</a>, and update the firmware via this interface), <strong>but remember to use the v2 firmware image (<a href="http://downloads.openwrt.org/barrier_breaker/14.07/ar71xx/generic/openwrt-ar71xx-generic-tl-mr3040-v2-squashfs-factory.bin" class="urlextern" title="http://downloads.openwrt.org/barrier_breaker/14.07/ar71xx/generic/openwrt-ar71xx-generic-tl-mr3040-v2-squashfs-factory.bin"  rel="nofollow">openwrt-ar71xx-generic-tl-mr3040-v2-squashfs-factory.bin</a>) instead of the v1 image</strong>. Default username/password: admin/admin
</p>

</div>

<h4 id="manual_flash_under_u-boot_serial_console1">Manual Flash under U-Boot Serial Console</h4>
<div class="level4">

<p>
Same as for v1.0, <strong>but remember to use the v2 firmware image (<a href="http://downloads.openwrt.org/barrier_breaker/14.07/ar71xx/generic/openwrt-ar71xx-generic-tl-mr3040-v2-squashfs-factory.bin" class="urlextern" title="http://downloads.openwrt.org/barrier_breaker/14.07/ar71xx/generic/openwrt-ar71xx-generic-tl-mr3040-v2-squashfs-factory.bin"  rel="nofollow">openwrt-ar71xx-generic-tl-mr3040-v2-squashfs-factory.bin</a>) instead of the v1 image</strong>.
</p>

</div>

<h3 class="sectionedit10" id="upgrading_openwrt">Upgrading OpenWrt</h3>
<div class="level3">

<p>
→<a href="../../doc/howto/generic.sysupgrade" class="wikilink1" title="doc:howto:generic.sysupgrade">generic.sysupgrade</a><br/>

</p>

</div>

<h3 class="sectionedit11" id="failsafe_mode">Failsafe Mode</h3>
<div class="level3">
<ol>
<li class="level1"><div class="li"> Switch on the router </div>
</li>
<li class="level1"><div class="li"> Wait almost 5 sec </div>
</li>
<li class="level1"><div class="li"> Press the &quot;Reset&quot; for ~3sec</div>
</li>
<li class="level1"><div class="li"> The device is now in Failsafe-Mode</div>
</li>
<li class="level1"><div class="li"> You may access it by using telnet 192.168.1.1/24 or serial</div>
</li>
</ol>

<p>
Keep in mind: <strong>The LEDs won&#039;t flash in Failsafe Mode!</strong><br/>

</p>

</div>

<h2 class="sectionedit12" id="restoring_original_firmware">Restoring Original Firmware</h2>
<div class="level2">

<p>
<strong>If you have SSH access:</strong>
</p>
<ul>
<li class="level1"><div class="li"> It is possible to flash factory firmware (or other firmware like DD-WRT) via the &quot;mtd&quot; command as documented in the generic instructions:</div>
<ul>
<li class="level3"><div class="li"> The firmware <strong>must</strong> be 3,932,160 bytes</div>
</li>
<li class="level3"><div class="li"> Get the file into /tmp on the router via wget from the web or scp from your PC</div>
</li>
<li class="level3"><div class="li"> Command is:  &quot;mtd -r write /tmp/filename.bin firmware&quot;  </div>
</li>
<li class="level3"><div class="li"> <a href="../../doc/howto/generic.uninstall#via.openwrt.cli" class="urlextern" title="http://wiki.openwrt.org/doc/howto/generic.uninstall#via.openwrt.cli"  rel="nofollow">http://wiki.openwrt.org/doc/howto/generic.uninstall#via.openwrt.cli</a></div>
</li>
</ul>
</li>
<li class="level1"><div class="li"> <strong>HOWEVER</strong>, some of the firmware downloaded from TP-LINK are too big (4,063,744 bytes) as they include the &quot;boot&quot; along with the firmware (usually the filename says &quot;boot&quot;, e.g. <em>mr3040v2_en_3_14_4_up_<strong>boot</strong>(121017).bin</em>).  </div>
<ul>
<li class="level3"><div class="li"> Those extra bytes can be removed before flashing with: <pre class="code">dd if=original_filename.bin of=modified_filename.bin skip=257 bs=512</pre>
Afterwards, the file should be the correct size for flashing.</div>
</li>
<li class="level3"><div class="li"> This command removes the first 128.5KB (0x20200) from the file.  <strong>Please note:</strong> There is a <em>risk</em> that&#039;s not the proper location for all files.  You can double check by viewing address 0x20200 in a hex editor:  Just prior to 0x20200 you should see a large block of 00&#039;s.  At 0x20200 you should have a &quot;01&quot; followed by a few 00&#039;s and then &quot;TP-LINK&quot;). On Linux, use the following command to view the data just prior to and at 0x20200: <pre class="code">hexdump -C original_filename.bin | grep 00020200 -B 3</pre>
 Example output:<pre class="code">0000bcb0  61 0a ff ff ff ff ff ff  ff ff ff ff ff ff ff ff  |a...............|
0000bcc0  ff ff ff ff ff ff ff ff  ff ff ff ff ff ff ff ff  |................|
*
00020200  01 00 00 00 54 50 2d 4c  49 4e 4b 20 54 65 63 68  |....TP-LINK Tech|</pre>
</div>
</li>
<li class="level3"><div class="li"> references: </div>
<ul>
<li class="level4"><div class="li"> <a href="https://forum.openwrt.org/viewtopic.php?pid=213398#p213398" class="urlextern" title="https://forum.openwrt.org/viewtopic.php?pid=213398#p213398"  rel="nofollow">https://forum.openwrt.org/viewtopic.php?pid=213398#p213398</a></div>
</li>
<li class="level4"><div class="li"> <a href="tl-wr741nd#back.to.original.firmware" class="urlextern" title="http://wiki.openwrt.org/toh/tp-link/tl-wr741nd#back.to.original.firmware"  rel="nofollow">http://wiki.openwrt.org/toh/tp-link/tl-wr741nd#back.to.original.firmware</a></div>
</li>
</ul>
</li>
</ul>
</li>
<li class="level1"><div class="li"> When flashing with mtd, if you receive an error such as &quot;failed to erase block&quot;, then DO NOT REBOOT your router.  Instead, flash a known good firmware of the proper size (e.g. flash the sysupgrade bin for the OpenWrt version you most recently had)</div>
</li>
</ul>

<p>
<strong>If you don&#039;t have SSH access (router bricked, etc):</strong>
</p>
<ul>
<li class="level1"><div class="li"> The process is similar to flash OpenWRT with U-boot serial console</div>
</li>
<li class="level1"><div class="li"> Download the original image</div>
<ul>
<li class="level3"><div class="li"> v1: <a href="http://www.tp-link.com/Resources/software/TL-MR3040_V1_120328.zip" class="urlextern" title="http://www.tp-link.com/Resources/software/TL-MR3040_V1_120328.zip"  rel="nofollow">http://www.tp-link.com/Resources/software/TL-MR3040_V1_120328.zip</a></div>
</li>
<li class="level3"><div class="li"> v2: <a href="http://www.tp-link.com/Resources/software/TL-MR3040_V2_121017.zip" class="urlextern" title="http://www.tp-link.com/Resources/software/TL-MR3040_V2_121017.zip"  rel="nofollow">http://www.tp-link.com/Resources/software/TL-MR3040_V2_121017.zip</a></div>
</li>
</ul>
</li>
<li class="level1"><div class="li"> Don´t forget to enter &quot;tpl&quot; as soon as U-Boot announces &quot;Autobooting in 1 seconds&quot;</div>
</li>
</ul>

<p>
<pre class="code">hornet&gt; tftpboot 0x81000000 mr3040v1_en_3_12_11_up(120328).bin
...
hornet&gt; erase 0x9f020000 +0x3c0000
...
hornet&gt; cp.b 0x81000000 0x9f020000 0x3c0000
...
hornet&gt; bootm 9f020000</pre>

</p>

</div>

<h2 class="sectionedit13" id="basic_configuration">Basic Configuration</h2>
<div class="level2">

<p>
Since this part is identical to generic devices, see <a href="../../doc/howto/configuration" class="wikilink1" title="doc:howto:basic.config">Basic configuration</a>.<br/>

</p>

</div>

<h2 class="sectionedit14" id="original_flash_layout">Original Flash Layout</h2>
<div class="level2">

<p>
Please read the article <a href="../../doc/techref/flash.layout" class="wikilink1" title="doc:techref:flash.layout">Flash Layout</a> for a better understanding. It contains a couple of explanations. Then let&#039;s have a view at flash layout of this particular device:
</p>
<div class="table sectionedit15"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0 centeralign" colspan="6">   TP-Link MR3040  Flash Layout stock firmware           </th>
	</tr>
	</thead>
	<tr class="row1">
		<th class="col0 leftalign"> Layer0       </th><td class="col1 centeralign" colspan="5">                        spi0.0:            4096KiB          </td>
	</tr>
	<tr class="row2">
		<th class="col0 leftalign"> Layer1       </th><td class="col1 centeralign">  mtd0            </td><td class="col2 centeralign">  mtd1              </td><td class="col3 centeralign">    mtd2           </td><td class="col4 centeralign">  mtd3            </td><td class="col5 centeralign">  mtd4         </td>
	</tr>
	<tr class="row3">
		<th class="col0 leftalign"> Size in KiB  </th><td class="col1 centeralign">  128KiB          </td><td class="col2 centeralign">  1024KiB           </td><td class="col3 centeralign">   2816 KiB        </td><td class="col4 centeralign">  64KiB           </td><td class="col5 centeralign">  64KiB        </td>
	</tr>
	<tr class="row4">
		<th class="col0 leftalign"> Name         </th><td class="col1 centeralign">  <strong><em>u-boot</em></strong>  </td><td class="col2 centeralign">  <strong><em>kernel</em></strong>    </td><td class="col3 centeralign">  <strong><em>rootfs</em></strong>   </td><td class="col4 centeralign">  <strong><em>config</em></strong>  </td><td class="col5 centeralign">  <strong><em>art</em></strong>  </td>
	</tr>
	<tr class="row5">
		<th class="col0 leftalign"> mountpoint   </th><td class="col1 centeralign">  none            </td><td class="col2 centeralign">  none              </td><td class="col3 leftalign"> /                 </td><td class="col4 centeralign">  none            </td><td class="col5 centeralign">  none         </td>
	</tr>
	<tr class="row6">
		<th class="col0 leftalign"> filesystem   </th><td class="col1 centeralign">  none            </td><td class="col2 centeralign">  none              </td><td class="col3 leftalign"> SquashFS          </td><td class="col4 centeralign">  none            </td><td class="col5 centeralign">  none         </td>
	</tr>
</table></div>

<p>
ART = Atheros Radio Test - it contains RF calibration data for the wifi. If it is missing or corrupt, wireless won&#039;t come up anymore.<br/>

</p>

</div>

<h2 class="sectionedit16" id="hardware">Hardware</h2>
<div class="level2">

</div>

<h3 class="sectionedit17" id="opening_the_device">Opening the device</h3>
<div class="level3">

<p>
Remove back cover, remove battery. Unscrew two screws, open case in the corner next to the ethernet port (there is a small triangle here). Push a screwdriver into the hole next to the battery (closest to ethernet port) and pull cover until it snaps open. Next push in the screwdriver in the next corner next to the battery.
</p>

</div>

<h3 class="sectionedit18" id="info">Info</h3>
<div class="level3">
<div class="table sectionedit19"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0 leftalign">  </th><th class="col1"> IC </th><th class="col2" colspan="2"> Datasheet </th>
	</tr>
	</thead>
	<tr class="row1">
		<td class="col0">Processor</td><td class="col1"> AR7240 </td><td class="col2"> <a href="../../_media/toh/tp-link/atheros.ar7240.pdf" class="media mediafile mf_pdf" title="toh:tp-link:atheros.ar7240.pdf (914.5 KB)">atheros.ar7240.pdf</a> </td><td class="col3"></td><td class="col4"></td>
	</tr>
	<tr class="row2">
		<td class="col0">Flash ROM</td><td class="col1"> Spansion S25FL032P </td><td class="col2"> <a href="http://www.spansion.com/Support/Datasheets/S25FL032P_00.pdf" class="urlextern" title="http://www.spansion.com/Support/Datasheets/S25FL032P_00.pdf"  rel="nofollow">http://www.spansion.com/Support/Datasheets/S25FL032P_00.pdf</a> </td><td class="col3"></td><td class="col4"></td>
	</tr>
	<tr class="row3">
		<td class="col0">SDRAM</td><td class="col1"> Zentel A3S56D40FTP </td><td class="col2"> <a href="http://www.kean.com.au/oshw/WR703N/teardown/Zentel%20A3S56D40FTP%20DDR%20256Mb%20SDRAM.pdf" class="urlextern" title="http://www.kean.com.au/oshw/WR703N/teardown/Zentel%20A3S56D40FTP%20DDR%20256Mb%20SDRAM.pdf"  rel="nofollow">http://www.kean.com.au/oshw/WR703N/teardown/Zentel%20A3S56D40FTP%20DDR%20256Mb%20SDRAM.pdf</a> </td><td class="col3"></td><td class="col4"></td>
	</tr>
	<tr class="row4">
		<td class="col0">Chipset (Wi-Fi controller)</td><td class="col1"> AR9331 </td><td class="col2"> <a href="http://see.sl088.com/w/images/6/69/AR9331.pdf" class="urlextern" title="http://see.sl088.com/w/images/6/69/AR9331.pdf"  rel="nofollow">http://see.sl088.com/w/images/6/69/AR9331.pdf</a> </td><td class="col3"></td><td class="col4"></td>
	</tr>
</table></div>

</div>

<h3 class="sectionedit20" id="serial_console">Serial Console</h3>
<div class="level3">

</div>

<h5 id="pinout">Pinout</h5>
<div class="level5">
<div class="table sectionedit21"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0">1 </th><th class="col1">2 </th><th class="col2">3 </th><th class="col3">4</th><td class="col4"></td><td class="col5"></td>
	</tr>
	</thead>
	<tr class="row1">
		<td class="col0">TX</td><td class="col1">RX</td><td class="col2">GND</td><td class="col3" colspan="2">VCC</td><td class="col5">P1</td>
	</tr>
</table></div>

<p>
Pin 1 is clearly marked on the board.
</p>

<p>
The right settings for accessing the serial console are as follows:
</p>

<p>
Bits per second: <strong>115200</strong><br/>

Data bits: <strong>8</strong><br/>

Stop bits: <strong>1</strong><br/>

Parity: <strong>None</strong><br/>

Flow control: <strong>None</strong><br/>

</p>

</div>

<h4 id="u-boot_bootloader_console">U-Boot Bootloader Console</h4>
<div class="level4">

<p>
The password to get the U-Boot prompt is <strong>tpl</strong>. You must type it quickly while the serial console is displaying:
<pre class="code">[...]
ag7240_phy_setup
eth1 up
eth0, eth1
Autobooting in 1 seconds
[type tpl here]</pre>

</p>

<p>
U-Boot accepts several commands. Type <strong>help</strong> to display the list of available commands.
</p>

</div>

<h4 id="linux_console">Linux Console</h4>
<div class="level4">

<p>
Once the original firmware has booted up completely, you can press <strong>return</strong> to activate the Linux login prompt.
<pre class="code">TL-MR3040 login: root
password: 5up</pre>
<br/>

</p>

</div>

<h3 class="sectionedit22" id="photos_v10">Photos (v1.0)</h3>
<div class="level3">

<p>
<a href="http://imageshack.us/a/img23/9454/mr3040front.jpg" class="urlextern" title="http://imageshack.us/a/img23/9454/mr3040front.jpg"  rel="nofollow">Bigger front image, for better view</a>.
</p>

<p>
<a href="../../_detail/toh/tp-link/tl-mr3040-v11_small.jpg?id=toh%253Atp-link%253Atl-mr3040" class="media" title="toh:tp-link:tl-mr3040-v11_small.jpg"><img src="../../_media/toh/tp-link/tl-mr3040-v11_small.jpg?w=800&amp;tok=ca2ed0" class="media" title="Version 1.1 Main board" alt="Version 1.1 Main board" width="800" /></a>
</p>

<p>
<a href="../../_detail/media/mr3040_back.jpg?id=toh%253Atp-link%253Atl-mr3040" class="media" title="media:mr3040_back.jpg"><img src="../../_media/media/mr3040_back.jpg?w=800&amp;tok=b3e0f1" class="media" title="Version 1.1 back" alt="Version 1.1 back" width="800" /></a>
</p>

<p>
<a href="../../_detail/media/mr3040_battery.jpg?id=toh%253Atp-link%253Atl-mr3040" class="media" title="media:mr3040_battery.jpg"><img src="../../_media/media/mr3040_battery.jpg?w=800&amp;tok=cf29f9" class="media" title="mr3040_battery.jpg" alt="mr3040_battery.jpg" width="800" /></a><br/>

</p>

</div>

<h3 class="sectionedit23" id="photos_v21">Photos (v2.1)</h3>
<div class="level3">

<p>
<a href="../../_detail/media/mr3040_v2.1-front1.jpg?id=toh%253Atp-link%253Atl-mr3040" class="media" title="media:mr3040_v2.1-front1.jpg"><img src="../../_media/media/mr3040_v2.1-front1.jpg?w=800&amp;tok=5d076f" class="media" title="mr3040_v2.1-front1.jpg" alt="mr3040_v2.1-front1.jpg" width="800" /></a>
</p>

<p>
<a href="../../_detail/media/mr3040_v2.1-back.jpg?id=toh%253Atp-link%253Atl-mr3040" class="media" title="media:mr3040_v2.1-back.jpg"><img src="../../_media/media/mr3040_v2.1-back.jpg?w=800&amp;tok=69ac46" class="media" alt="" width="800" /></a>
</p>

</div>

<h3 class="sectionedit24" id="hardware_info_v21">Hardware info (v2.1)</h3>
<div class="level3">

<p>
The stock firmware has a web-based command line interface (located at <a href="http://192.168.0.1/userRpmNatDebugRpm26525557/linux_cmdline.html" class="urlextern" title="http://192.168.0.1/userRpmNatDebugRpm26525557/linux_cmdline.html"  rel="nofollow">http://192.168.0.1/userRpmNatDebugRpm26525557/linux_cmdline.html</a> - username/password is osteam/5up). The following info was obtained via this web interface.
</p>

<p>
<pre class="code"># cat /proc/version&amp;
Linux version 2.6.31--LSDK-9.2.0.312 (root@localhost.localdomain) (gcc version 4.3.3 (GCC) ) #45 Wed Oct 17 17:14:17 CST 2012</pre>

<pre class="code"># cat /proc/cpuinfo &amp;
system type		: Atheros AR9330 (Hornet)
processor		: 0
cpu model		: MIPS 24Kc V7.4
BogoMIPS		: 266.24
wait instruction	: yes
microsecond timers	: yes
tlb_entries		: 16
extra interrupt vector	: yes
hardware watchpoint	: yes, count: 4, address/irw mask: [0x0000, 0x0ff8, 0x0ff8, 0x0ffb]
ASEs implemented	: mips16
shadow register sets	: 1
core			: 0
VCED exceptions		: not available
VCEI exceptions		: not available</pre>

<pre class="code"># cat /proc/interrupts&amp;
           CPU0       
  2:     226967           dummy  wifi0
  3:          0            MIPS  ehci_hcd:usb1
  4:          0            MIPS  eth1
  5:      26826            MIPS  eth0
  6:          0            MIPS  cascade
  7:     886122            MIPS  timer
 18:          0     AR7240 MISC  cascade
 19:         48     AR7240 MISC  serial
 28:         37     AR7240 MISC  gmac link intr
 43:          0     AR7240 GPIO  RESTORE_FACTORY_DEFAULT
 53:          0     AR7240 GPIO  Watchdog Reset

ERR:          0</pre>

<pre class="code"># ls /proc
1              42             533            diskstats      pagetypeinfo
147            43             534            driver         partitions
150            44             535            execdomains    self
151            45             538            filesystems    simple_config
152            5              542            fs             slabinfo
155            505            549            interrupts     softirqs
156            506            572            iomem          stat
16             507            66             ioports        sys
162            508            8              irq            sysvipc
165            511            93             kallsyms       timer_list
168            512            ath_gmac_stat  kmsg           tty
2              515            athdebug       loadavg        uptime
25             516            athversion     locks          version
3              527            buddyinfo      meminfo        vmallocinfo
324            528            bus            misc           vmstat
361            529            cmdline        modules        zoneinfo
384            530            cpuinfo        mounts
385            531            crypto         mtd
4              532            devices        net</pre>

<pre class="code"># cat /proc/meminfo&amp;
MemTotal:          29992 kB
MemFree:           11060 kB
Buffers:            2236 kB
Cached:             6860 kB
SwapCached:            0 kB
Active:             4364 kB
Inactive:           6932 kB
Active(anon):       2200 kB
Inactive(anon):        0 kB
Active(file):       2164 kB
Inactive(file):     6932 kB
Unevictable:           0 kB
Mlocked:               0 kB
SwapTotal:             0 kB
SwapFree:              0 kB
Dirty:                 0 kB
Writeback:             0 kB
AnonPages:          2224 kB
Mapped:             1952 kB
Slab:               4908 kB
SReclaimable:        456 kB
SUnreclaim:         4452 kB
PageTables:          232 kB
NFS_Unstable:          0 kB
Bounce:                0 kB
WritebackTmp:          0 kB
CommitLimit:       14996 kB
Committed_AS:       5600 kB
VmallocTotal:    1048404 kB
VmallocUsed:        2116 kB
VmallocChunk:    1037128 kB</pre>

<pre class="code"># cat /proc/softirqs&amp;
                CPU0       
      HI:          0
   TIMER:     894576
  NET_TX:       1114
  NET_RX:      30910
   BLOCK:          0
 TASKLET:     194810
   SCHED:          0
 HRTIMER:          0
     RCU:      29923</pre>

<pre class="code"># cat /proc/devices&amp;
Character devices:
  1 mem
  4 ttyS
  5 /dev/tty
  5 /dev/console
  5 /dev/ptmx
 10 misc
 13 input
 21 sg
 77 AR7240_GPIOC
 90 mtd
108 ppp
128 ptm
136 pts
180 usb
189 usb_device
238 ar7240_gpio_chrdev
239 ar7240_flash_chrdev

Block devices:
259 blkext
  8 sd
 31 mtdblock
 65 sd
 66 sd
 67 sd
 68 sd
 69 sd
 70 sd
 71 sd
128 sd
129 sd
130 sd
131 sd
132 sd
133 sd
134 sd
135 sd</pre>

<pre class="code"># cat /proc/timer_list&amp;
Timer List Version: v0.4
HRTIMER_MAX_CLOCK_BASES: 2
now at 3623494191688 nsecs

cpu: 0
 clock 0:
  .base:       80247490
  .index:      0
  .resolution: 4000250 nsecs
  .get_time:   ktime_get_real
active timers:
 clock 1:
  .base:       802474b8
  .index:      1
  .resolution: 4000250 nsecs
  .get_time:   ktime_get
active timers:
 #0: &lt;80ddfea0&gt;, hrtimer_wakeup, S:01
 # expires at 3623587145038-3623587195038 nsecs [in 92953350 to 93003350 nsecs]
 #1: &lt;80ec3ea0&gt;, hrtimer_wakeup, S:01
 # expires at 3623592058218-3623592108218 nsecs [in 97866530 to 97916530 nsecs]
 #2: &lt;80dcfea0&gt;, hrtimer_wakeup, S:01
 # expires at 3623692053433-3623692103433 nsecs [in 197861745 to 197911745 nsecs]
 #3: &lt;81c63ea0&gt;, hrtimer_wakeup, S:01
 # expires at 3623692078218-3623692128218 nsecs [in 197886530 to 197936530 nsecs]
 #4: &lt;81c87ea0&gt;, hrtimer_wakeup, S:01
 # expires at 3623776060908-3623776110908 nsecs [in 281869220 to 281919220 nsecs]
 #5: &lt;81c89ea0&gt;, hrtimer_wakeup, S:01
 # expires at 3623776082598-3623776132598 nsecs [in 281890910 to 281940910 nsecs]
 #6: &lt;80eabea0&gt;, hrtimer_wakeup, S:01
 # expires at 3623776449078-3623776499078 nsecs [in 282257390 to 282307390 nsecs]
 #7: &lt;80dd7ea0&gt;, hrtimer_wakeup, S:01
 # expires at 3624452067673-3624452117673 nsecs [in 957875985 to 957925985 nsecs]
 #8: &lt;80eadea0&gt;, hrtimer_wakeup, S:01
 # expires at 3624452094108-3624452144108 nsecs [in 957902420 to 957952420 nsecs]
 #9: &lt;80e9fea0&gt;, hrtimer_wakeup, S:01
 # expires at 3624452139538-3624452189538 nsecs [in 957947850 to 957997850 nsecs]
 #10: &lt;80ec1ea0&gt;, hrtimer_wakeup, S:01
 # expires at 3624456056338-3624456106338 nsecs [in 961864650 to 961914650 nsecs]
 #11: &lt;81c29ad8&gt;, hrtimer_wakeup, S:01
 # expires at 3625300039373-3625302039369 nsecs [in 1805847685 to 1807847681 nsecs]
 #12: &lt;80c21ea0&gt;, hrtimer_wakeup, S:01
 # expires at 3625356006158-3625356056158 nsecs [in 1861814470 to 1861864470 nsecs]
 #13: &lt;80e89ea0&gt;, hrtimer_wakeup, S:01
 # expires at 3626220007808-3626220057808 nsecs [in 2725816120 to 2725866120 nsecs]
 #14: &lt;81c49ea0&gt;, hrtimer_wakeup, S:01
 # expires at 3629000002848-3629000052848 nsecs [in 5505811160 to 5505861160 nsecs]
 #15: &lt;80cdfa40&gt;, hrtimer_wakeup, S:01
 # expires at 3632620073878-3632630073853 nsecs [in 9125882190 to 9135882165 nsecs]
 #16: &lt;80edfa40&gt;, hrtimer_wakeup, S:01
 # expires at 3634616067468-3634646067446 nsecs [in 11121875780 to 11151875758 nsecs]
 #17: &lt;81c5fea0&gt;, hrtimer_wakeup, S:01
 # expires at 3678339169738-3678339219738 nsecs [in 54844978050 to 54845028050 nsecs]
 #18: &lt;81c6bea0&gt;, hrtimer_wakeup, S:01
 # expires at 3678680084893-3678680134893 nsecs [in 55185893205 to 55185943205 nsecs]
 #19: &lt;81c53a40&gt;, hrtimer_wakeup, S:01
 # expires at 7217260376833-7217260426833 nsecs [in 3593766185145 to 3593766235145 nsecs]


Tick Device: mode:     0
Per CPU device: 0
Clock Event Device: MIPS
 max_delta_ns:   2147483647
 min_delta_ns:   3840
 mult:           858993459
 shift:          32
 mode:           3
 next_event:     3623496000000 nsecs
 set_next_event: mips_next_event
 set_mode:       mips_set_clock_mode
 event_handler:  tick_handle_periodic</pre>

<pre class="code"># /sbin/lsmod
Module                  Size  Used by
umac 630496 0 - Live 0xc0a5e000
ath_dev 214688 1 umac, Live 0xc094a000 (P)
ath_rate_atheros 32512 1 ath_dev, Live 0xc08f3000 (P)
ath_hal 369264 2 umac,ath_dev, Live 0xc0886000 (P)
asf 9376 3 umac,ath_dev,ath_hal, Live 0xc080e000 (P)
adf 14512 3 umac,ath_dev,ath_hal, Live 0xc07ff000
nf_nat_rtsp 5328 0 - Live 0xc073d000
nf_conntrack_rtsp 7136 1 nf_nat_rtsp, Live 0xc0731000
nf_nat_h323 6720 0 - Live 0xc0720000
nf_nat_tftp 1280 0 - Live 0xc0715000
nf_conntrack_tftp 4192 1 nf_nat_tftp, Live 0xc070b000
nf_nat_ftp 2768 0 - Live 0xc0701000
nf_conntrack_ftp 7216 1 nf_nat_ftp, Live 0xc06f6000
nf_nat_pptp 2576 0 - Live 0xc06eb000
nf_conntrack_pptp 5904 1 nf_nat_pptp, Live 0xc06e0000
tp_domain 4352 0 - Live 0xc06c1000
athrs_gmac 54048 0 - Live 0xc02a3000
statistics 87056 0 - Live 0xc0273000
wlan_warn 2976 0 - Live 0xc0268000
pptp 10432 0 - Live 0xc025f000
pppol2tp 27760 0 - Live 0xc024d000
br_filter 1232 0 - Live 0xc023b000
ts_kmp 2208 1 - Live 0xc0232000
cls_fw 5088 0 - Live 0xc0227000
cls_basic 4944 0 - Live 0xc021b000
sch_sfq 6384 0 - Live 0xc020f000
sch_prio 5360 0 - Live 0xc0203000
sch_htb 18000 0 - Live 0xc01f4000
ipt_TRIGGER 3872 0 - Live 0xc01e5000
ipt_REJECT 2992 0 - Live 0xc01db000
ipt_REDIRECT 1520 0 - Live 0xc01d1000
ipt_MASQUERADE 2400 3 - Live 0xc01c8000
iptable_nat 4720 1 - Live 0xc01bd000
iptable_filter 2352 1 - Live 0xc01b2000
ip_tables 11824 2 iptable_nat,iptable_filter, Live 0xc01a6000
nf_nat_proto_gre 1984 1 nf_nat_pptp, Live 0xc0199000
nf_nat 15904 10 nf_nat_rtsp,nf_nat_h323,nf_nat_tftp,nf_nat_ftp,nf_nat_pptp,ipt_TRIGGER,ipt_REDIRECT,ipt_MASQUERADE,iptable_nat,nf_nat_proto_gre, Live 0xc018d000
nf_conntrack_ipv4 13184 9 iptable_nat,nf_nat, Live 0xc017c000
nf_defrag_ipv4 1648 1 nf_conntrack_ipv4, Live 0xc016e000
xt_state 1856 6 - Live 0xc0165000
xt_conntrack 4544 0 - Live 0xc015b000
nf_conntrack_h323 47328 1 nf_nat_h323, Live 0xc0146000
nf_conntrack_proto_gre 4976 1 nf_conntrack_pptp, Live 0xc012f000
nf_conntrack 59008 18 nf_nat_rtsp,nf_conntrack_rtsp,nf_nat_h323,nf_nat_tftp,nf_conntrack_tftp,nf_nat_ftp,nf_conntrack_ftp,nf_nat_pptp,nf_conntrack_pptp,ipt_TRIGGER,ipt_MASQUERADE,iptable_nat,nf_nat,nf_conntrack_ipv4,xt_state,xt_conntrack,nf_conntrack_h323,nf_conntrack_proto_gre, Live 0xc0116000
ipt_multiurl 1936 0 - Live 0xc00fa000
xt_time 2704 0 - Live 0xc00f1000
xt_string 2208 0 - Live 0xc00e7000
xt_multiport 2848 0 - Live 0xc00dd000
xt_mac 1376 0 - Live 0xc00d3000
xt_iprange 2128 0 - Live 0xc00ca000
xt_comment 1296 1 - Live 0xc00c1000
xt_TCPMSS 3264 1 - Live 0xc00b8000
xt_MARK 1888 0 - Live 0xc00ae000
xt_tcpudp 2784 14 - Live 0xc00a5000
x_tables 16480 19 wlan_warn,ipt_TRIGGER,ipt_REJECT,ipt_REDIRECT,ipt_MASQUERADE,iptable_nat,ip_tables,xt_state,xt_conntrack,ipt_multiurl,xt_time,xt_string,xt_multiport,xt_mac,xt_iprange,xt_comment,xt_TCPMSS,xt_MARK,xt_tcpudp, Live 0xc0097000</pre>

<pre class="code"># cat /proc/modules&amp;
umac 630496 0 - Live 0xc0a5e000
ath_dev 214688 1 umac, Live 0xc094a000 (P)
ath_rate_atheros 32512 1 ath_dev, Live 0xc08f3000 (P)
ath_hal 369264 2 umac,ath_dev, Live 0xc0886000 (P)
asf 9376 3 umac,ath_dev,ath_hal, Live 0xc080e000 (P)
adf 14512 3 umac,ath_dev,ath_hal, Live 0xc07ff000
nf_nat_rtsp 5328 0 - Live 0xc073d000
nf_conntrack_rtsp 7136 1 nf_nat_rtsp, Live 0xc0731000
nf_nat_h323 6720 0 - Live 0xc0720000
nf_nat_tftp 1280 0 - Live 0xc0715000
nf_conntrack_tftp 4192 1 nf_nat_tftp, Live 0xc070b000
nf_nat_ftp 2768 0 - Live 0xc0701000
nf_conntrack_ftp 7216 1 nf_nat_ftp, Live 0xc06f6000
nf_nat_pptp 2576 0 - Live 0xc06eb000
nf_conntrack_pptp 5904 1 nf_nat_pptp, Live 0xc06e0000
tp_domain 4352 0 - Live 0xc06c1000
athrs_gmac 54048 0 - Live 0xc02a3000
statistics 87056 0 - Live 0xc0273000
wlan_warn 2976 0 - Live 0xc0268000
pptp 10432 0 - Live 0xc025f000
pppol2tp 27760 0 - Live 0xc024d000
br_filter 1232 0 - Live 0xc023b000
ts_kmp 2208 1 - Live 0xc0232000
cls_fw 5088 0 - Live 0xc0227000
cls_basic 4944 0 - Live 0xc021b000
sch_sfq 6384 0 - Live 0xc020f000
sch_prio 5360 0 - Live 0xc0203000
sch_htb 18000 0 - Live 0xc01f4000
ipt_TRIGGER 3872 0 - Live 0xc01e5000
ipt_REJECT 2992 0 - Live 0xc01db000
ipt_REDIRECT 1520 0 - Live 0xc01d1000
ipt_MASQUERADE 2400 3 - Live 0xc01c8000
iptable_nat 4720 1 - Live 0xc01bd000
iptable_filter 2352 1 - Live 0xc01b2000
ip_tables 11824 2 iptable_nat,iptable_filter, Live 0xc01a6000
nf_nat_proto_gre 1984 1 nf_nat_pptp, Live 0xc0199000
nf_nat 15904 10 nf_nat_rtsp,nf_nat_h323,nf_nat_tftp,nf_nat_ftp,nf_nat_pptp,ipt_TRIGGER,ipt_REDIRECT,ipt_MASQUERADE,iptable_nat,nf_nat_proto_gre, Live 0xc018d000
nf_conntrack_ipv4 13184 9 iptable_nat,nf_nat, Live 0xc017c000
nf_defrag_ipv4 1648 1 nf_conntrack_ipv4, Live 0xc016e000
xt_state 1856 6 - Live 0xc0165000
xt_conntrack 4544 0 - Live 0xc015b000
nf_conntrack_h323 47328 1 nf_nat_h323, Live 0xc0146000
nf_conntrack_proto_gre 4976 1 nf_conntrack_pptp, Live 0xc012f000
nf_conntrack 59008 18 nf_nat_rtsp,nf_conntrack_rtsp,nf_nat_h323,nf_nat_tftp,nf_conntrack_tftp,nf_nat_ftp,nf_conntrack_ftp,nf_nat_pptp,nf_conntrack_pptp,ipt_TRIGGER,ipt_MASQUERADE,iptable_nat,nf_nat,nf_conntrack_ipv4,xt_state,xt_conntrack,nf_conntrack_h323,nf_conntrack_proto_gre, Live 0xc0116000
ipt_multiurl 1936 0 - Live 0xc00fa000
xt_time 2704 0 - Live 0xc00f1000
xt_string 2208 0 - Live 0xc00e7000
xt_multiport 2848 0 - Live 0xc00dd000
xt_mac 1376 0 - Live 0xc00d3000
xt_iprange 2128 0 - Live 0xc00ca000
xt_comment 1296 1 - Live 0xc00c1000
xt_TCPMSS 3264 1 - Live 0xc00b8000
xt_MARK 1888 0 - Live 0xc00ae000
xt_tcpudp 2784 14 - Live 0xc00a5000
x_tables 16480 19 wlan_warn,ipt_TRIGGER,ipt_REJECT,ipt_REDIRECT,ipt_MASQUERADE,iptable_nat,ip_tables,xt_state,xt_conntrack,ipt_multiurl,xt_time,xt_string,xt_multiport,xt_mac,xt_iprange,xt_comment,xt_TCPMSS,xt_MARK,xt_tcpudp, Live 0xc0097000</pre>

<pre class="code"># ls /dev
ar7100_flash_chrdev  ram0                 ttyS1
ar7100_gpio_chrdev   random               ttyS2
caldata              tty                  ttyUSB0
console              tty0                 ttyUSB1
dk0                  tty1                 ttyUSB10
kmem                 tty2                 ttyUSB11
mem                  ttyACM0              ttyUSB12
mtd0                 ttyACM1              ttyUSB13
mtdblock0            ttyACM10             ttyUSB14
mtdblock1            ttyACM11             ttyUSB15
mtdblock2            ttyACM12             ttyUSB2
mtdblock3            ttyACM13             ttyUSB3
mtdblock4            ttyACM14             ttyUSB4
mtdblock5            ttyACM15             ttyUSB5
mtdblock6            ttyACM2              ttyUSB6
mtdr0                ttyACM3              ttyUSB7
null                 ttyACM4              ttyUSB8
ppp                  ttyACM5              ttyUSB9
ptmx                 ttyACM6              ttyp0
pts                  ttyACM7              ttyp1
ptyp0                ttyACM8              ttyp2
ptyp1                ttyACM9              urandom
ptyp2                ttyS0                zero</pre>

<pre class="code"># /sbin/ifconfig
ath0      Link encap:Ethernet  HWaddr F8:1A:67:5B:D9:7C  
          UP BROADCAST RUNNING MULTICAST  MTU:2290  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:456 errors:0 dropped:2656 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:0 (0.0 B)  TX bytes:200184 (195.4 KiB)

br0       Link encap:Ethernet  HWaddr F8:1A:67:5B:D9:7C  
          inet addr:192.168.0.1  Bcast:192.168.0.255  Mask:255.255.255.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:22657 errors:0 dropped:0 overruns:0 frame:0
          TX packets:26997 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:2368073 (2.2 MiB)  TX bytes:19011533 (18.1 MiB)

eth0      Link encap:Ethernet  HWaddr F8:1A:67:5B:D9:7B  
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:22683 errors:0 dropped:4 overruns:0 frame:0
          TX packets:29239 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:2779389 (2.6 MiB)  TX bytes:19273038 (18.3 MiB)

eth1      Link encap:Ethernet  HWaddr F8:1A:67:5B:D9:7D  
          UP BROADCAST MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)

lo        Link encap:Local Loopback  
          inet addr:127.0.0.1  Mask:255.0.0.0
          UP LOOPBACK RUNNING  MTU:16436  Metric:1
          RX packets:2004 errors:0 dropped:0 overruns:0 frame:0
          TX packets:2004 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:156312 (152.6 KiB)  TX bytes:156312 (152.6 KiB)

wifi0     Link encap:Ethernet  HWaddr F8:1A:67:5B:D9:7C  
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:174 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)
          Interrupt:2 Memory:b8100000-b811ffff </pre>

<pre class="code"># cat /proc/partitions&amp;
major minor  #blocks  name

  31        0        128 mtdblock0
  31        1       1024 mtdblock1
  31        2       2816 mtdblock2
  31        3         64 mtdblock3
  31        4         64 mtdblock4</pre>

<pre class="code"># cat /proc/diskstats&amp;
  31       0 mtdblock0 0 0 0 0 0 0 0 0 0 0 0
  31       1 mtdblock1 0 0 0 0 0 0 0 0 0 0 0
  31       2 mtdblock2 82 2127 4418 1028 0 0 0 0 0 1028 1028
  31       3 mtdblock3 0 0 0 0 0 0 0 0 0 0 0
  31       4 mtdblock4 1 0 8 0 0 0 0 0 0 0 0</pre>

<pre class="code"># df
Filesystem           1k-blocks      Used Available Use% Mounted on
/dev/mtdblock2            2688      2688         0 100% /</pre>

<pre class="code"># cat /proc/pagetypeinfo&amp;
Page block order: 10
Pages per block:  1024

Free pages count per migrate type at order       0      1      2      3      4      5      6      7      8      9     10 
Node    0, zone   Normal, type    Unmovable      3      2      2      0      1      1      1      1      0      0      0 
Node    0, zone   Normal, type  Reclaimable      0      1      1      1      0      0      0      1      1      1      0 
Node    0, zone   Normal, type      Movable      1      1      1      1      0      1      1      0      0      1      0 
Node    0, zone   Normal, type      Reserve      0      0      0      0      0      0      0      0      0      0      1 
Node    0, zone   Normal, type      Isolate      0      0      0      0      0      0      0      0      0      0      0 

Number of blocks type     Unmovable  Reclaimable      Movable      Reserve      Isolate 
Node 0, zone   Normal            2            1            4            1            0 </pre>

<pre class="code"># cat /proc/vmstat&amp;
nr_free_pages 2807
nr_inactive_anon 0
nr_active_anon 521
nr_inactive_file 1733
nr_active_file 541
nr_unevictable 0
nr_mlock 0
nr_anon_pages 527
nr_mapped 488
nr_file_pages 2274
nr_dirty 0
nr_writeback 0
nr_slab_reclaimable 114
nr_slab_unreclaimable 1108
nr_page_table_pages 52
nr_unstable 0
nr_bounce 0
nr_vmscan_write 0
nr_writeback_temp 0
pgpgin 2213
pgpgout 0
pswpin 0
pswpout 0
pgalloc_normal 75985
pgalloc_movable 0
pgfree 78792
pgactivate 542
pgdeactivate 0
pgfault 71708
pgmajfault 78
pgrefill_normal 0
pgrefill_movable 0
pgsteal_normal 0
pgsteal_movable 0
pgscan_kswapd_normal 0
pgscan_kswapd_movable 0
pgscan_direct_normal 0
pgscan_direct_movable 0
pginodesteal 0
slabs_scanned 0
kswapd_steal 0
kswapd_inodesteal 0
pageoutrun 0
allocstall 0
pgrotated 0
unevictable_pgs_culled 0
unevictable_pgs_scanned 0
unevictable_pgs_rescued 0
unevictable_pgs_mlocked 0
unevictable_pgs_munlocked 0
unevictable_pgs_cleared 0
unevictable_pgs_stranded 0
unevictable_pgs_mlockfreed 0</pre>

<pre class="code"># cat /proc/zoneinfo&amp;
Node 0, zone   Normal
  pages free     2771
        min      180
        low      225
        high     270
        scanned  0
        spanned  8192
        present  8128
    nr_free_pages 2771
    nr_inactive_anon 0
    nr_active_anon 550
    nr_inactive_file 1733
    nr_active_file 541
    nr_unevictable 0
    nr_mlock     0
    nr_anon_pages 556
    nr_mapped    488
    nr_file_pages 2274
    nr_dirty     0
    nr_writeback 0
    nr_slab_reclaimable 114
    nr_slab_unreclaimable 1107
    nr_page_table_pages 58
    nr_unstable  0
    nr_bounce    0
    nr_vmscan_write 0
    nr_writeback_temp 0
        protection: (0, 0)
  pagesets
    cpu: 0
              count: 0
              high:  0
              batch: 1
  all_unreclaimable: 0
  prev_priority:     12
  start_pfn:         0
  inactive_ratio:    1</pre>

</p>

</div>

<h3 class="sectionedit25" id="tl-mr3040_reverse_engineering">TL-MR3040 Reverse Engineering</h3>
<div class="level3">

<p>
The TL-MR3040 has been <a href="https://forum.openwrt.org/viewtopic.php?id=41714" class="urlextern" title="https://forum.openwrt.org/viewtopic.php?id=41714"  rel="nofollow">torn down</a> by Jarocks, which was very useful to check the pinout. The investigation was complete thanks to doiga, also check the <a href="https://forum.openwrt.org/viewtopic.php?id=42466" class="urlextern" title="https://forum.openwrt.org/viewtopic.php?id=42466"  rel="nofollow">forum</a><br/>

</p>

</div>

<h3 class="sectionedit26" id="gpios">GPIOs</h3>
<div class="level3">

<p>
→ <a href="../../doc/hardware/port.gpio" class="wikilink1" title="doc:hardware:port.gpio">port.GPIO</a>
</p>

<p>
The AR933x platform provides 28 GPIOs, some of them are used by the router for status LEDs, buttons and other stuff.
</p>

<p>
<strong>The TL-MR3040 provides 3 free GPIOs.</strong>
</p>

<p>
The table below shows the results of the investigation, based on the AR9331 datasheet:
</p>
<div class="table sectionedit27"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0 centeralign">  GPIO  </th><th class="col1"> Available </th><th class="col2 rightalign">  AR9331 Pin </th><th class="col3 centeralign">  Description                    </th><th class="col4"> desc.(tested on a V2 board) </th>
	</tr>
	</thead>
	<tr class="row1">
		<td class="col0 rightalign">      0 </td><td class="col1 leftalign"> R8        </td><td class="col2 leftalign"> A78   </td><td class="col3 leftalign"> Must have 0 value during bootstrap*    </td><td class="col4 leftalign">                            </td>
	</tr>
	<tr class="row2">
		<td class="col0 rightalign">      1 </td><td class="col1 leftalign"> R11       </td><td class="col2 leftalign"> A77   </td><td class="col3 leftalign"> Must have 1 value during bootstrap    </td><td class="col4 leftalign">                             </td>
	</tr>
	<tr class="row3">
		<td class="col0 rightalign">      2 </td><td class="col1 leftalign"> SPI_CS_0  </td><td class="col2 leftalign"> B49   </td><td class="col3 leftalign"> Used by SPI Flash                     </td><td class="col4"></td>
	</tr>
	<tr class="row4">
		<td class="col0 rightalign">      3 </td><td class="col1 leftalign"> SPI_CLK   </td><td class="col2 leftalign"> B51   </td><td class="col3 leftalign"> Used by SPI Flash                     </td><td class="col4"></td>
	</tr>
	<tr class="row5">
		<td class="col0 rightalign">      4 </td><td class="col1 leftalign"> SPI_MOSI  </td><td class="col2 leftalign"> B50   </td><td class="col3 leftalign"> Used by SPI Flash                     </td><td class="col4"></td>
	</tr>
	<tr class="row6">
		<td class="col0 rightalign">      5 </td><td class="col1 leftalign"> SPI_MISO  </td><td class="col2 leftalign"> A57   </td><td class="col3 leftalign"> Used by SPI Flash                     </td><td class="col4"></td>
	</tr>
	<tr class="row7">
		<td class="col0 rightalign">      6 </td><td class="col1 leftalign"> NC        </td><td class="col2 leftalign">       </td><td class="col3 leftalign">                                       </td><td class="col4"></td>
	</tr>
	<tr class="row8">
		<td class="col0 rightalign">      7 </td><td class="col1 leftalign"> NC        </td><td class="col2 leftalign">       </td><td class="col3 leftalign">                                       </td><td class="col4"></td>
	</tr>
	<tr class="row9">
		<td class="col0 rightalign">      8 </td><td class="col1 leftalign"> NC        </td><td class="col2 leftalign">       </td><td class="col3 leftalign">                                       </td><td class="col4"></td>
	</tr>
	<tr class="row10">
		<td class="col0 rightalign">      9 </td><td class="col1 leftalign"> SIN       </td><td class="col2 leftalign"> B68   </td><td class="col3 leftalign"> Serial INPUT (Rx)                     </td><td class="col4"></td>
	</tr>
	<tr class="row11">
		<td class="col0 rightalign">     10 </td><td class="col1 leftalign"> SOUT      </td><td class="col2 leftalign"> A79   </td><td class="col3 leftalign"> Serial OUTPUT (Tx)                    </td><td class="col4"></td>
	</tr>
	<tr class="row12">
		<td class="col0 rightalign">     11 </td><td class="col1 leftalign"> RESET SW  </td><td class="col2 leftalign"> B48   </td><td class="col3 leftalign"> Soft Reset Switch                     </td><td class="col4"></td>
	</tr>
	<tr class="row13">
		<td class="col0 rightalign">     12 </td><td class="col1 leftalign"> R84       </td><td class="col2 leftalign"> A56   </td><td class="col3 leftalign"> Must have 0 value during bootstrap    </td><td class="col4"></td>
	</tr>
	<tr class="row14">
		<td class="col0 rightalign">     13 </td><td class="col1 leftalign"> R12       </td><td class="col2 leftalign"> B66   </td><td class="col3 leftalign"> Must have 1 value during bootstrap    </td><td class="col4"></td>
	</tr>
	<tr class="row15">
		<td class="col0 rightalign">     14 </td><td class="col1 leftalign"> R9        </td><td class="col2 leftalign"> A76   </td><td class="col3 leftalign"> <strong>unused</strong> Pulled to ground           </td><td class="col4"></td>
	</tr>
	<tr class="row16">
		<td class="col0 rightalign">     15 </td><td class="col1 leftalign"> R10       </td><td class="col2 leftalign"> B65   </td><td class="col3 leftalign"> <strong>unused</strong> Pulled to ground           </td><td class="col4"></td>
	</tr>
	<tr class="row17">
		<td class="col0 rightalign">     16 </td><td class="col1 leftalign"> R13       </td><td class="col2 leftalign"> A75   </td><td class="col3 leftalign"> Must have 0 value during bootstrap    </td><td class="col4"></td>
	</tr>
	<tr class="row18">
		<td class="col0 rightalign">     17 </td><td class="col1 leftalign"> LED2      </td><td class="col2 leftalign"> B64   </td><td class="col3 leftalign"> <abbr title="Local Area Network">LAN</abbr> LED                               </td><td class="col4"></td>
	</tr>
	<tr class="row19">
		<td class="col0 rightalign">     18 </td><td class="col1"> USB_POWER </td><td class="col2 leftalign"> A28   </td><td class="col3 leftalign"> Control USB Host Power                </td><td class="col4"></td>
	</tr>
	<tr class="row20">
		<td class="col0 rightalign">     19 </td><td class="col1 leftalign"> NC        </td><td class="col2 leftalign">       </td><td class="col3 leftalign">                                       </td><td class="col4"> slide switch partA </td>
	</tr>
	<tr class="row21">
		<td class="col0 rightalign">     20 </td><td class="col1 leftalign"> R15       </td><td class="col2 leftalign"> A27   </td><td class="col3 leftalign"> <strong>unused</strong> Pulled to ground           </td><td class="col4"> slide switch partB </td>
	</tr>
	<tr class="row22">
		<td class="col0 rightalign">     21 </td><td class="col1 leftalign"> NC        </td><td class="col2 leftalign">       </td><td class="col3 leftalign">                                       </td><td class="col4"></td>
	</tr>
	<tr class="row23">
		<td class="col0 rightalign">     22 </td><td class="col1 leftalign"> NC        </td><td class="col2 leftalign">       </td><td class="col3 leftalign">                                       </td><td class="col4"></td>
	</tr>
	<tr class="row24">
		<td class="col0 rightalign">     23 </td><td class="col1 leftalign"> NC        </td><td class="col2 leftalign">       </td><td class="col3 leftalign">                                       </td><td class="col4"></td>
	</tr>
	<tr class="row25">
		<td class="col0 rightalign">     24 </td><td class="col1 leftalign"> NC        </td><td class="col2 leftalign">       </td><td class="col3 leftalign">                                       </td><td class="col4"></td>
	</tr>
	<tr class="row26">
		<td class="col0 rightalign">     26 </td><td class="col1 leftalign"> LED3      </td><td class="col2 leftalign"> A51   </td><td class="col3 leftalign"> Wireless <abbr title="Local Area Network">LAN</abbr>  LED                     </td><td class="col4"></td>
	</tr>
	<tr class="row27">
		<td class="col0 rightalign">     27 </td><td class="col1 leftalign"> LED1      </td><td class="col2 leftalign"> B44   </td><td class="col3 leftalign"> 3G LED                                </td><td class="col4"></td>
	</tr>
	<tr class="row28">
		<td class="col0 rightalign">     28 </td><td class="col1 leftalign"> N/A       </td><td class="col2 leftalign"> A74   </td><td class="col3 leftalign"> Must have 0 value during bootstrap    </td><td class="col4"></td>
	</tr>
</table></div>

<p>
*GPIO_0 can be floating (i.e. resistors removed) during boostrap and the router still boots! <em>TESTED!!!</em>
</p>

<p>
<strong>how to use GPIO 19,20</strong><br/>

</p>
<ul>
<li class="level1"><div class="li"> R27 &amp; R17 are 10k pullup resistors, should be desoldered in order to use GPIO19,20 as output</div>
</li>
<li class="level1"><div class="li"> if you don&#039;t want to desolder the switch, then disassemble it, and solder a pin header on the solder side of pcb</div>
</li>
<li class="level1"><div class="li"> truth table for slide sw1 and slide sw 2 <br/>
</div>
</li>
</ul>
<div class="table sectionedit28"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0 leftalign">pin 19  </th><th class="col1 leftalign"> pin 20    </th><th class="col2 leftalign"> sw state  </th>
	</tr>
	</thead>
	<tr class="row1">
		<td class="col0 centeralign">     0  </td><td class="col1 centeralign">      1    </td><td class="col2 leftalign"> 3G/4G     </td>
	</tr>
	<tr class="row2">
		<td class="col0 centeralign">     1  </td><td class="col1 centeralign">      0    </td><td class="col2 centeralign">  WISP     </td>
	</tr>
	<tr class="row3">
		<td class="col0 centeralign">     1  </td><td class="col1 centeralign">       1   </td><td class="col2 centeralign">   AP      </td>
	</tr>
</table></div>

<p>
 <br/>

</p>

<p>
To make the GPIOs available via sysfs, the required ones have to be exported to userspace, as it is explained on a page of the <a href="http://squidge.sourceforge.net/gpio/" class="urlextern" title="http://squidge.sourceforge.net/gpio/"  rel="nofollow">Squidge-Project</a>.
<br/>

</p>

</div>

<h3 class="sectionedit29" id="leds">LEDs</h3>
<div class="level3">

<p>
How to configure LEDs in general, see the LED section in the <a href="../../doc/uci/system" class="wikilink1" title="doc:uci:system">system</a>.
</p>

<p>
The TL-MR3040 has 5 LEDs:
</p>
<div class="table sectionedit30"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0 leftalign"> LED name       </th><th class="col1 leftalign"> LED color  </th><th class="col2 leftalign"> LED print      </th><th class="col3 leftalign"> Internal name       </th><th class="col4 leftalign"> Trigger         </th>
	</tr>
	</thead>
	<tr class="row1">
		<td class="col0"> Power (2 LEDs) </td><td class="col1 leftalign"> Green/Red  </td><td class="col2 leftalign"> Power/Charge symbol   </td><td class="col3 leftalign"> N/A (fixed supply)  </td><td class="col4 leftalign"> N/A      </td>
	</tr>
	<tr class="row2">
		<td class="col0 leftalign"> <abbr title="Local Area Network">LAN</abbr>            </td><td class="col1 leftalign"> Green      </td><td class="col2 leftalign"> <abbr title="Local Area Network">LAN</abbr> symbol     </td><td class="col3 leftalign"> tp-link:green:lan   </td><td class="col4"> <code>netdev:eth0</code> </td>
	</tr>
	<tr class="row3">
		<td class="col0 leftalign"> Wireless <abbr title="Local Area Network">LAN</abbr>   </td><td class="col1 leftalign"> Green      </td><td class="col2 leftalign"> WLAN symbol    </td><td class="col3 leftalign"> tp-link:green:wlan  </td><td class="col4 leftalign"> <code>phy0tpt</code>     </td>
	</tr>
	<tr class="row4">
		<td class="col0 leftalign"> 3G             </td><td class="col1 leftalign"> Green      </td><td class="col2"> Internet symbol</td><td class="col3 leftalign"> tp-link:green:3g    </td><td class="col4 leftalign"> <code>USB:1-1</code>     </td>
	</tr>
</table></div>

</div>

<h3 class="sectionedit31" id="usb_port">USB Port</h3>
<div class="level3">

<p>
Like other <strong>devices using the ar933x platform</strong>, this model suffers from problems when directly connecting USB 1.1 devices (specified for low speed or full speed; normally serial adapters). These problems can be circumvented by using a (passive) hub between the router and the USB devices. More information in the <a href="https://forum.openwrt.org/viewtopic.php?id=39956" class="urlextern" title="https://forum.openwrt.org/viewtopic.php?id=39956"  rel="nofollow">forum</a>.
</p>

<p>
<strong>This problem can also be circumvented</strong> by using an external powered USB HUB 2.0 <em>HIGH-SPEED</em>.
<br/>

</p>

</div>

<h3 class="sectionedit32" id="hardware_slide_switch_v2">Hardware slide switch (v2)</h3>
<div class="level3">

<p>
→ <a href="http://wiki.openwrt.org/doc/howto/hardware.buttons" class="wikilink2" title="doc:howto:hardware.buttons" rel="nofollow">hardware.buttons</a>
The TP-Link TL-MR3040 has a slide switch with three positions:
</p>
<div class="table sectionedit33"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0"> BUTTON </th><th class="col1"> Event </th>
	</tr>
	</thead>
	<tr class="row1">
		<td class="col0"> Slide switch </td><td class="col1"> BTN_0 and BTN_1 </td>
	</tr>
</table></div>

<p>
The three postitions are labeld with &quot;3G/4G&quot;, &quot;WISP&quot; and &quot;AP&quot;.
</p>

<p>
Sample script: <a href="https://forum.openwrt.org/viewtopic.php?pid=189097#p189097" class="urlextern" title="https://forum.openwrt.org/viewtopic.php?pid=189097#p189097"  rel="nofollow">https://forum.openwrt.org/viewtopic.php?pid=189097#p189097</a>
</p>

<p>
<pre class="code">mkdir -p /etc/hotplug.d/button</pre>

</p>

<p>
<pre class="code">vi /etc/hotplug.d/button/10-slider</pre>

</p>

<p>
<pre class="code">#!/bin/sh
sleep 1
logger &quot;log: $BUTTON -- $ACTION&quot;

if [ $ACTION == &quot;released&quot; ] ; then
	if [ $BUTTON == &quot;BTN_1&quot; ] ; then
		logger &quot;Slider WISP&quot;
		#some actions here
	elif [ $BUTTON == &quot;BTN_0&quot; ] &amp;&amp; grep -qe &quot;sw1.*in  lo&quot; /sys/kernel/debug/gpio ; then
		logger &quot;Slider 3G 4G&quot;
		#some action here
	fi
elif [ $BUTTON == &quot;BTN_0&quot; ] || [ $BUTTON == &quot;BTN_1&quot; ] ; then
	if grep -qe &quot;sw1.*in  hi&quot; /sys/kernel/debug/gpio ; then
		if grep -qe &quot;sw2.*in  hi&quot; /sys/kernel/debug/gpio ; then
			logger &quot;Slider AP&quot;
			#some action here
		fi                  
	fi
fi</pre>

</p>

</div>

<h2 class="sectionedit34" id="bootloader_mods">Bootloader Mods</h2>
<div class="level2">
<ol>
<li class="level1"><div class="li"> you could read about <a href="../../doc/techref/bootloader.1" class="wikilink1" title="doc:techref:bootloader">bootloader</a> in general and about <a href="../../doc/techref/bootloader/uboot" class="wikilink1" title="doc:techref:bootloader:uboot">Das U-Boot</a> in particular.</div>
</li>
</ol>

</div>

<h3 class="sectionedit35" id="u-boot_114_modification_for_routers">U-Boot 1.1.4 modification for routers</h3>
<div class="level3">

<p>
Forum member <a href="https://forum.openwrt.org/profile.php?id=72549" class="urlextern" title="https://forum.openwrt.org/profile.php?id=72549"  rel="nofollow">pepe2k</a> made a modification of <strong>U-Boot 1.1.4</strong> for <strong>Qualcomm Atheros</strong> SoCs based devices (the project is still being developed, so new devices and SoCs will be supported in the future). Up to date information, binary images and sources can be found on official <a href="https://github.com/pepe2k/u-boot_mod" class="urlextern" title="https://github.com/pepe2k/u-boot_mod"  rel="nofollow">GitHub repository</a>.
</p>

<p>
This modification started from <a href="http://code.google.com/p/wr703n-uboot-with-web-failsafe/" class="urlextern" title="http://code.google.com/p/wr703n-uboot-with-web-failsafe/"  rel="nofollow">wr703n-uboot-with-web-failsafe</a> project, but supports more devices, all modern web browsers, has a lot of improvements and other modifications (like U-Boot NetConsole, custom commands, overclocking possibilities etc.).
</p>

<p>
More information:
</p>
<ul>
<li class="level1"><div class="li"> Official repository on GitHub: <a href="https://github.com/pepe2k/u-boot_mod" class="urlextern" title="https://github.com/pepe2k/u-boot_mod"  rel="nofollow">U-Boot 1.1.4 modification for routers</a></div>
</li>
<li class="level1"><div class="li"> Discussion about this project on <a href="https://forum.openwrt.org/viewtopic.php?id=43237" class="urlextern" title="https://forum.openwrt.org/viewtopic.php?id=43237"  rel="nofollow">OpenWrt forum</a></div>
</li>
<li class="level1"><div class="li"> An article (in Polish) about one of the first version of this project on <a href="http://www.tech-blog.pl/2013/03/29/zmodyfikowany-u-boot-dla-routerow-tp-link-z-atheros-ar9331-z-trybem-aktualizacji-oprogramowania-przez-www-i-konsola-sieciowa-netconsole/" class="urlextern" title="http://www.tech-blog.pl/2013/03/29/zmodyfikowany-u-boot-dla-routerow-tp-link-z-atheros-ar9331-z-trybem-aktualizacji-oprogramowania-przez-www-i-konsola-sieciowa-netconsole/"  rel="nofollow">www.tech-blog.pl</a></div>
</li>
</ul>

</div>

<h2 class="sectionedit36" id="bootlog">Bootlog</h2>
<div class="level2">

</div>

<h3 class="sectionedit37" id="factory_bootlog">Factory BootLog</h3>
<div class="level3">

<div style="height:600px;font:10px/14px Georgia, Garamond, Serif;overflow:Auto;background-color:#FFFFFF">
<p style="margin: 5px;padding:5px">
<code>
U-Boot 1.1.4 (Mar 28 2012 - 17:31:23)

AP121 (ar9330) U-boot

DRAM:  32 MB
led turning on for 1s...
id read 0x100000ff
flash size 4194304, sector count = 64
Flash:  4 MB
Using default environment

In:    serial
Out:   serial
Err:   serial
Net:   ag7240_enet_initialize...
No valid address in Flash. Using fixed address
No valid address in Flash. Using fixed address
: cfg1 0x5 cfg2 0x7114
eth0:
ag7240_phy_setup
eth0 up
:
eth1:
athrs26_reg_init_lan
ATHRS26: resetting s26
ATHRS26: s26 reset done
ag7240_phy_setup
eth1 up
eth0, eth1
Autobooting in 1 seconds
## Booting image at 9f020000 ...
   Uncompressing Kernel Image ... OK

Starting kernel ...

Booting AR9330(Hornet)...
Linux version 2.6.31--LSDK-9.2.0.312 (root@local) (gcc version 4.3.3 (GCC) ) #22 Wed Aug 22 11:18:12 CST 2012
flash_size passed from bootloader = 4
CPU revision is: 00019374 (MIPS 24Kc)
Determined physical RAM map:
 memory: 02000000 @ 00000000 (usable)
User-defined physical RAM map:
 memory: 02000000 @ 00000000 (usable)
Zone PFN ranges:
  Normal   0x00000000 -> 0x00002000
Movable zone start PFN for each node
early_node_map[1] active PFN ranges
    0: 0x00000000 -> 0x00002000
Built 1 zonelists in Zone order, mobility grouping on.  Total pages: 8128
Kernel command line: console=ttyS0,115200 root=31:02 rootfstype=squashfs init=/sbin/init mtdparts=ar7240-nor0:128k(u-boot),1024k(kernel),2816(rootfs),64k(config),64k(ART) mem=32M
PID hash table entries: 128 (order: 7, 512 bytes)
Dentry cache hash table entries: 4096 (order: 2, 16384 bytes)
Inode-cache hash table entries: 2048 (order: 1, 8192 bytes)
Primary instruction cache 64kB, VIPT, 4-way, linesize 32 bytes.
Primary data cache 32kB, 4-way, VIPT, cache aliases, linesize 32 bytes
Writing ErrCtl register=00000000
Readback ErrCtl register=00000000
Memory: 29876k/32768k available (1884k kernel code, 2892k reserved, 521k data, 116k init, 0k highmem)
Hierarchical RCU implementation.
NR_IRQS:128
plat_time_init: plat time init done
Calibrating delay loop... 266.24 BogoMIPS (lpj=532480)
Mount-cache hash table entries: 512
NET: Registered protocol family 16
===== ar7240_platform_init: 0
bio: create slab <bio-0> at 0
SCSI subsystem initialized
usbcore: registered new interface driver usbfs
usbcore: registered new interface driver hub
usbcore: registered new device driver usb
NET: Registered protocol family 2
IP route cache hash table entries: 1024 (order: 0, 4096 bytes)
TCP established hash table entries: 1024 (order: 1, 8192 bytes)
TCP bind hash table entries: 1024 (order: 0, 4096 bytes)
TCP: Hash tables configured (established 1024 bind 1024)
TCP reno registered
NET: Registered protocol family 1
AR7240 GPIOC major 0
squashfs: version 4.0 (2009/01/31) Phillip Lougher
NTFS driver 2.1.29 [Flags: R/O].
msgmni has been set to 58
alg: No test for lzma (lzma-generic)
alg: No test for stdrng (krng)
io scheduler noop registered
io scheduler anticipatory registered
io scheduler deadline registered
io scheduler cfq registered (default)
Serial: 8250/16550 driver, 1 ports, IRQ sharing disabled
ttyS0: detected caps 00000000 should be 00000100
serial8250.0: ttyS0 at MMIO 0xb8020000 (irq = 19) is a 16550A
console [ttyS0] enabled
PPP generic driver version 2.4.2
NET: Registered protocol family 24
cmdlinepart partition parsing not available
set partition boot
set partition kernel
set partition rootfs
set partition config
set partition art
set partition ÿ
Searching for RedBoot partition table
5 RedBoot partitions found on MTD device ar7240-nor0
Creating 5 MTD partitions on "ar7240-nor0":
0x000000000000-0x000000020000 : "boot"
0x000000020000-0x000000120000 : "kernel"
0x000000120000-0x0000003e0000 : "rootfs"
0x0000003e0000-0x0000003f0000 : "config"
0x0000003f0000-0x000000400000 : "art"
->Oops: flash id 0x10215 .
ehci_hcd: USB 2.0 'Enhanced' Host Controller (EHCI) Driver
Port Status 1c000004
ar7240-ehci ar7240-ehci.0: ATH EHCI
ar7240-ehci ar7240-ehci.0: new USB bus registered, assigned bus number 1
ehci_reset Intialize USB CONTROLLER in host mode: 3
ehci_reset Port Status 1c000000
ar7240-ehci ar7240-ehci.0: irq 3, io mem 0x1b000000
ehci_reset Intialize USB CONTROLLER in host mode: 3
ehci_reset Port Status 1c000000
ar7240-ehci ar7240-ehci.0: USB 2.0 started, EHCI 1.00
usb usb1: configuration #1 chosen from 1 choice
hub 1-0:1.0: USB hub found
hub 1-0:1.0: 1 port detected
TCP cubic registered
NET: Registered protocol family 17
802.1Q VLAN Support v1.8 Ben Greear <greearb@candelatech.com>
All bugs added by David S. Miller <davem@redhat.com>
ar7240wdt_init: Registering WDT success
VFS: Mounted root (squashfs filesystem) readonly on device 31:2.
Freeing unused kernel memory: 116k freed
init started:  BusyBox v1.01 (2012.08.01-03:58+0000) multi-call binary
This Board use 2.6.31
xt_time: kernel timezone is -0000
nf_conntrack version 0.5.0 (512 buckets, 5120 max)
ip_tables: (C) 2000-2006 Netfilter Core Team
insmod: cannot open module `/lib/modules/2.6.31/kernel/iptable_raw.ko': No such file or directory
insmod: cannot open module `/lib/modules/2.6.31/kernel/flashid.ko': No such file or directory
PPPoL2TP kernel driver, V1.0
PPTP driver version 0.8.3
insmod: cannot open module `/lib/modules/2.6.31/kernel/harmony.ko': No such file or directory

 (none) mips #22 Wed Aug 22 11:18:12 CST 2012 (none)
(none) login: Now flash open!
Now flash open!
ATHR_GMAC: Length per segment 1536
ATHR_GMAC: fifo cfg 3 01f00140
2
ATHR_GMAC: Max segments per packet :   1
ATHR_GMAC: Max tx descriptor count :   40
ATHR_GMAC: Max rx descriptor count :   96
ATHR_GMAC: Mac capability flags    :   4D83
1
ATHR_GMAC: Max segments per packet :   1
ATHR_GMAC: Max tx descriptor count :   40
ATHR_GMAC: Max rx descriptor count :   252
ATHR_GMAC: Mac capability flags    :   4403
athr_gmac_ring_alloc Allocated 640 at 0x81ea2800
athr_gmac_ring_alloc Allocated 4032 at 0x81d63000
Setting Drop CRC Errors, Pause Frames and Length Error frames
Setting PHY...mac 0
athr_gmac_ring_alloc Allocated 640 at 0x81ea2400
athr_gmac_ring_alloc Allocated 1536 at 0x81f2f000
athr_gmac_mii_setup: MDC check failed
Setting Drop CRC Errors, Pause Frames and Length Error frames
ATHRS26: resetting s26
ATHRS26: s26 reset done
Setting PHY...mac 1
device eth0 entered promiscuous mode
Now flash open!
ATHR_GMAC: Enet Unit:1 PHY:4 is UP GMii 100Mbps full duplex
ATHR_GMAC: done
Setting Drop CRC Errors, Pause Frames and Length Error frames
br0: port 1(eth0) entering forwarding state
nf_conntrack_rtsp v0.6.21 loading
nf_nat_rtsp v0.6.21 loading
asf: module license 'Proprietary' taints kernel.
Disabling lock debugging due to kernel taint
ath_hal: 0.9.17.1 (AR9380, DEBUG, REGOPS_FUNC, WRITE_EEPROM, 11D)
ath_rate_atheros: Copyright (c) 2001-2005 Atheros Communications, Inc, All Rights Reserved
ath_dev: Copyright (c) 2001-2007 Atheros Communications, Inc, All Rights Reserved
ath_ahb: 9.2.0_U5.508 (Atheros/multi-bss)
Boostrap clock 25MHz
ar9300RadioAttach: Need analog access recipe!!
Restoring Cal data from Flash
ath_get_caps[4735] rx chainmask mismatch actual 1 sc_chainmak 0
ath_get_caps[4710] tx chainmask mismatch actual 1 sc_chainmak 0
wifi0: Atheros 9380: mem=0xb8100000, irq=2
wlan_vap_create : enter. devhandle=0x80d202c0, opmode=IEEE80211_M_HOSTAP, flags=0x1
wlan_vap_create : exit. devhandle=0x80d202c0, opmode=IEEE80211_M_HOSTAP, flags=0x1.
VAP device ath0 created
.
.
.
br0: port 2(ath0) entering forwarding state
br0: port 2(ath0) entering disabled state

TL-MR3040 login:
</code>
</p>
</div>

<p>
<br/>

</p>

</div>

<h2 class="sectionedit38" id="resources">Resources</h2>
<div class="level2">
<ul>
<li class="level1"><div class="li"> Official TP-Link TL-MR3040 <a href="http://www.tp-link.com/en/products/details/?model=TL-MR3040" class="urlextern" title="http://www.tp-link.com/en/products/details/?model=TL-MR3040"  rel="nofollow">Website</a></div>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> The latest official firmware is available <a href="http://www.tp-link.com/en/support/download/?model=TL-MR3040" class="urlextern" title="http://www.tp-link.com/en/support/download/?model=TL-MR3040"  rel="nofollow">here</a></div>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> OEM source code available at: <a href="http://www.tp-link.com/resources/gpl/150Router.rar" class="urlextern" title="http://www.tp-link.com/resources/gpl/150Router.rar"  rel="nofollow">http://www.tp-link.com/resources/gpl/150Router.rar</a></div>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> <a href="http://www.disk91.com/2012/technology/systems/installation-of-a-piratebox-on-t-link-mr3040/" class="urlextern" title="http://www.disk91.com/2012/technology/systems/installation-of-a-piratebox-on-t-link-mr3040/"  rel="nofollow">Installation of piratebox on T-Link MR3040</a></div>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> <a href="http://www.minipwner.com/" class="urlextern" title="http://www.minipwner.com/"  rel="nofollow">MiniPwner</a> <a href="http://www.minipwner.com/index.php/forum/4-community-edition-installation/833-minipwner-based-on-tl-mr3040" class="urlextern" title="http://www.minipwner.com/index.php/forum/4-community-edition-installation/833-minipwner-based-on-tl-mr3040"  rel="nofollow">confirmed working</a></div>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> Althought <a href="tl-mr3020" class="wikilink1" title="toh:tp-link:tl-mr3020">TL-MR3020</a> and <a href="tl-wr703n" class="wikilink1" title="toh:tp-link:tl-wr703n">TL-WR703N</a> are ONLY hardware similar, most probably some modifications work, like External Antenna Hack!!! See <a href="http://minipwner.com/index.php/forum/7-hacks-and-enhancements/1892-mr3040-external-antenna-mod#1892" class="urlextern" title="http://minipwner.com/index.php/forum/7-hacks-and-enhancements/1892-mr3040-external-antenna-mod#1892"  rel="nofollow">here</a> for one example.<br/>
</div>
</li>
</ul>

</div>

<h2 class="sectionedit39" id="custom_openwrt_image_with_luci_integrated">Custom OpenWrt image with LuCi integrated</h2>
<div class="level2">

<p>
<a href="http://www.superwrt.eu/en/firmware/tp-link-mr3040/" class="urlextern" title="http://www.superwrt.eu/en/firmware/tp-link-mr3040/"  rel="nofollow">http://www.superwrt.eu/en/firmware/tp-link-mr3040/</a>
</p>

</div>

<h2 class="sectionedit40" id="tags">Tags</h2>
<div class="level2">
<hr />
<div class="tags"><span>
	<a href="../../tag/fastethernet?do=showtag&amp;tag=FastEthernet" class="wikilink1" title="tag:fastethernet" rel="tag">FastEthernet</a>,
	<a href="../../tag/1nic?do=showtag&amp;tag=1NIC" class="wikilink1" title="tag:1nic" rel="tag">1NIC</a>,
	<a href="../../tag/1wnic?do=showtag&amp;tag=1WNIC" class="wikilink1" title="tag:1wnic" rel="tag">1WNIC</a>,
	<a href="../../tag/no_switch?do=showtag&amp;tag=no_switch" class="wikilink1" title="tag:no_switch" rel="tag">no switch</a>,
	<a href="../../tag/serial?do=showtag&amp;tag=Serial" class="wikilink1" title="tag:serial" rel="tag">Serial</a>,
	<a href="../../tag/integrated?do=showtag&amp;tag=integrated" class="wikilink1" title="tag:integrated" rel="tag">integrated</a>,
	<a href="../../tag/1ant?do=showtag&amp;tag=1Ant" class="wikilink1" title="tag:1ant" rel="tag">1Ant</a>,
	<a href="../../tag/1usb?do=showtag&amp;tag=1USB" class="wikilink1" title="tag:1usb" rel="tag">1USB</a>,
	<a href="../../tag/802.11bgn?do=showtag&amp;tag=802.11bgn" class="wikilink1" title="tag:802.11bgn" rel="tag">802.11bgn</a>,
	<a href="../../tag/ar9331?do=showtag&amp;tag=AR9331" class="wikilink1" title="tag:ar9331" rel="tag">AR9331</a>,
	<a href="../../tag/ath9k?do=showtag&amp;tag=ath9k" class="wikilink1" title="tag:ath9k" rel="tag">ath9k</a>,
	<a href="../../tag/1ant?do=showtag&amp;tag=1Ant" class="wikilink1" title="tag:1ant" rel="tag">1Ant</a>,
	<a href="../../tag/32ram?do=showtag&amp;tag=32RAM" class="wikilink1" title="tag:32ram" rel="tag">32RAM</a>,
	<a href="../../tag/4flash?do=showtag&amp;tag=4Flash" class="wikilink1" title="tag:4flash" rel="tag">4Flash</a>,
	<a href="../../tag/mips?do=showtag&amp;tag=MIPS" class="wikilink1" title="tag:mips" rel="tag">MIPS</a>,
	<a href="../../tag/mips32?do=showtag&amp;tag=MIPS32" class="wikilink1" title="tag:mips32" rel="tag">MIPS32</a>,
	<a href="../../tag/24k?do=showtag&amp;tag=24k" class="wikilink1" title="tag:24k" rel="tag">24k</a>,
	<a href="../../tag/ap121?do=showtag&amp;tag=AP121" class="wikilink1" title="tag:ap121" rel="tag">AP121</a>,
	<a href="../../tag/portable_router?do=showtag&amp;tag=portable_router" class="wikilink1" title="tag:portable_router" rel="tag">portable router</a>,
	<a href="../../tag/rechargeable_battery?do=showtag&amp;tag=rechargeable_battery" class="wikilink1" title="tag:rechargeable_battery" rel="tag">rechargeable battery</a>
</span></div>

</div>

                    <!-- wikipage stop -->
                                    </div>

                <div class="docInfo"><bdi>toh/tp-link/tl-mr3040.txt</bdi> · Last modified: 2015/03/01 08:02 by <bdi>svenno</bdi></div>

                            </div></div><!-- /content -->

            <hr class="a11y" />

            <!-- PAGE ACTIONS -->
            <div id="dokuwiki__pagetools">
                <h3 class="a11y">Page Tools</h3>
                <div class="tools">
                    <ul>
                        <li><a href="tl-mr3040?do=edit"  class="action source" accesskey="v" rel="nofollow" title="Show pagesource [V]"><span>Show pagesource</span></a></li><li><a href="tl-mr3040?do=revisions"  class="action revs" accesskey="o" rel="nofollow" title="Old revisions [O]"><span>Old revisions</span></a></li><li><a href="tl-mr3040?do=backlink"  class="action backlink" rel="nofollow" title="Backlinks"><span>Backlinks</span></a></li><li><a href="tl-mr3040#dokuwiki__top"  class="action top" accesskey="t" rel="nofollow" title="Back to top [T]"><span>Back to top</span></a></li>                    </ul>
                </div>
            </div>
        </div><!-- /wrapper -->

        
<!-- ********** FOOTER ********** -->
<div id="dokuwiki__footer"><div class="pad">
    <div class="license">Except where otherwise noted, content on this wiki is licensed under the following license: <bdi><a href="http://creativecommons.org/licenses/by-nc-sa/3.0/" rel="license" class="urlextern">CC Attribution-Noncommercial-Share Alike 3.0 Unported</a></bdi></div>
    <div class="buttons">
        <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/" rel="license"><img src="../../lib/images/license/button/cc-by-nc-sa.png" alt="CC Attribution-Noncommercial-Share Alike 3.0 Unported" /></a>        <a href="http://www.dokuwiki.org/donate" title="Donate" ><img
            src="../../lib/tpl/openwrt/images/button-donate.gif" width="80" height="15" alt="Donate" /></a>
        <a href="http://www.php.net" title="Powered by PHP" ><img
            src="../../lib/tpl/openwrt/images/button-php.gif" width="80" height="15" alt="Powered by PHP" /></a>
        <a href="http://validator.w3.org/check/referer" title="Valid HTML5" ><img
            src="../../lib/tpl/openwrt/images/button-html5.png" width="80" height="15" alt="Valid HTML5" /></a>
        <a href="http://jigsaw.w3.org/css-validator/check/referer?profile=css3" title="Valid CSS" ><img
            src="../../lib/tpl/openwrt/images/button-css.png" width="80" height="15" alt="Valid CSS" /></a>
        <a href="http://dokuwiki.org/" title="Driven by DokuWiki" ><img
            src="../../lib/tpl/openwrt/images/button-dw.png" width="80" height="15" alt="Driven by DokuWiki" /></a>
    </div>
</div></div><!-- /footer -->

    </div></div><!-- /site -->

    <div class="no"><img src="../../lib/exe/indexer.php?id=toh%253Atp-link%253Atl-mr3040&amp;1432278345" width="2" height="1" alt="" /></div>
    <div id="screen__mode" class="no"></div>    <!--[if ( lte IE 7 | IE 8 ) ]></div><![endif]-->
</body>
</html>
