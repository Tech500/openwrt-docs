<!DOCTYPE html>
<html lang="en" dir="ltr" class="no-js">
<head>
    <meta charset="utf-8" />
    <title>TP-Link TL-WDR4900 [OpenWrt Wiki]</title>
    <script>(function(H){H.className=H.className.replace(/\bno-js\b/,'js')})(document.documentElement)</script>
    <meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="keywords" content="gigabitethernet,internalantenna,2usb,3x3,450mbps,usb2.0,5ghz,5port,16flash,802.11abgn,ath9k,detachableantenna,6ant,3ant,128ram,802.11abgn simultan,2wnic,soc.freescale.mpc"/>
<link rel="search" type="application/opensearchdescription+xml" href="../../lib/exe/opensearch.php" title="OpenWrt Wiki"/>
<link rel="start" href="../../index.html"/>
<link rel="contents" href="tl-wdr4900?do=index" title="Sitemap"/>
<link rel="alternate" type="application/rss+xml" title="Recent changes" href="../../feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Current namespace" href="../../feed.php?mode=list&amp;ns=toh:tp-link"/>
<link rel="alternate" type="text/html" title="Plain HTML" href="../../_export/xhtml/toh/tp-link/tl-wdr4900"/>
<link rel="alternate" type="text/plain" title="Wiki Markup" href="../../_export/raw/toh/tp-link/tl-wdr4900"/>
<link rel="canonical" href="tl-wdr4900"/>
<link rel="stylesheet" type="text/css" href="../../lib/exe/css.php?t=openwrt&amp;tseed=6f44f363dc87908d905dc56ff3acbfc4"/>
<script type="text/javascript">/*<![CDATA[*/var NS='toh:tp-link';var JSINFO = {"id":"toh:tp-link:tl-wdr4900","namespace":"toh:tp-link"};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="../../lib/exe/js.php?tseed=6f44f363dc87908d905dc56ff3acbfc4"></script>
<script type="text/javascript" charset="utf-8">/*<![CDATA[*/jQuery(function(){
	for ( i=0; i < document.forms.length; i++ ) {
		if (document.forms[i].method == 'post') {
			var myElement = document.createElement('input');
			myElement.setAttribute('type', 'hidden');
			myElement.name = 'bb2_screener_';
			myElement.value = '1432271792 166.182.3.20';
			document.forms[i].appendChild(myElement);
		}
	}
});
/*!]]>*/</script>
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <link rel="shortcut icon" href="../../lib/tpl/openwrt/images/favicon.ico" />
<link rel="apple-touch-icon" href="../../lib/tpl/openwrt/images/apple-touch-icon.png" />
    </head>

<body>
    <!--[if lte IE 7 ]><div id="IE7"><![endif]--><!--[if IE 8 ]><div id="IE8"><![endif]-->
    <div id="dokuwiki__site"><div id="dokuwiki__top" class="site dokuwiki mode_show tpl_openwrt     ">

        
<!-- ********** HEADER ********** -->
<div id="dokuwiki__header"><div class="pad group">

    
    <div class="headings group">
        <ul class="a11y skip">
            <li><a href="tl-wdr4900#dokuwiki__content">skip to content</a></li>
        </ul>

        <h1><a href="../../start"  accesskey="h" title="[H]"><img src="../../lib/tpl/openwrt/images/logo.png" width="386" height="98" alt="" /> <span>OpenWrt Wiki</span></a></h1>
            </div>

    <div class="tools group">
        <!-- USER TOOLS -->
                    <div id="dokuwiki__usertools">
                <h3 class="a11y">User Tools</h3>
                <ul>
                    <li><a href="tl-wdr4900?do=register"  class="action register" rel="nofollow" title="Register">Register</a></li><li><a href="tl-wdr4900?do=login&amp;sectok=382740b13d95f946eed36caa57076b4a"  class="action login" rel="nofollow" title="Login">Login</a></li>                </ul>
            </div>
        
        <!-- SITE TOOLS -->
        <div id="dokuwiki__sitetools">
            <h3 class="a11y">Site Tools</h3>
            <form action="../../start" accept-charset="utf-8" class="search" id="dw__search" method="get" role="search"><div class="no"><input type="hidden" name="do" value="search" /><input type="text" id="qsearch__in" accesskey="f" name="id" class="edit" title="[F]" /><input type="submit" value="Search" class="button" title="Search" /><div id="qsearch__out" class="ajax_qsearch JSpopup"></div></div></form>            <div class="mobileTools">
                <form action="../../doku.php" method="get" accept-charset="utf-8"><div class="no"><input type="hidden" name="id" value="toh:tp-link:tl-wdr4900" /><select name="do" class="edit quickselect" title="Tools"><option value="">Tools</option><optgroup label="Page Tools"><option value="edit">Show pagesource</option><option value="revisions">Old revisions</option><option value="backlink">Backlinks</option></optgroup><optgroup label="Site Tools"><option value="recent">Recent changes</option><option value="media">Media Manager</option><option value="index">Sitemap</option></optgroup><optgroup label="User Tools"><option value="login">Login</option><option value="register">Register</option></optgroup></select><input type="submit" value="&gt;" /></div></form>            </div>
            <ul>
                <li><a href="tl-wdr4900?do=recent"  class="action recent" accesskey="r" rel="nofollow" title="Recent changes [R]">Recent changes</a></li><li><a href="tl-wdr4900?do=media&amp;ns=toh%253Atp-link"  class="action media" rel="nofollow" title="Media Manager">Media Manager</a></li><li><a href="tl-wdr4900?do=index"  class="action index" accesskey="x" rel="nofollow" title="Sitemap [X]">Sitemap</a></li>            </ul>
        </div>

    </div>

    <!-- BREADCRUMBS -->
            <div class="breadcrumbs">
                            <div class="youarehere"><span class="bchead">You are here: </span><span class="home"><bdi><a href="../../start" class="wikilink1" title="start">OpenWrt Wiki</a></bdi></span> » <bdi><a href="../start" class="wikilink1" title="toh:start">Table of Hardware</a></bdi> » <bdi><a href="start" class="wikilink1" title="toh:tp-link:start">TP-Link</a></bdi> » <bdi><span class="curid"><a href="tl-wdr4900" class="wikilink1" title="toh:tp-link:tl-wdr4900">TP-Link TL-WDR4900</a></span></bdi></div>
                                    <div class="plugin_multilingual">
        <ul>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/cz/toh/tp-link/tl-wdr4900" class="media" title="cz:toh:tp-link:tl-wdr4900"><img src="../../lib/exe/fetch.php?cache=&amp;tok=aff589&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fcz.gif" class="media" title="Čeština (Czech)" alt="Čeština (Czech)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/de/toh/tp-link/tl-wdr4900" class="media" title="de:toh:tp-link:tl-wdr4900"><img src="../../lib/exe/fetch.php?cache=&amp;tok=e24010&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fde.gif" class="media" title="Deutsch (German)" alt="Deutsch (German)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <span class="curid"><a href="tl-wdr4900" class="media" title="toh:tp-link:tl-wdr4900"><img src="../../lib/exe/fetch.php?cache=&amp;tok=2a37ae&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fgb.gif" class="media" title="English" alt="English" /></a></span>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/es/toh/tp-link/tl-wdr4900" class="media" title="es:toh:tp-link:tl-wdr4900"><img src="../../lib/exe/fetch.php?cache=&amp;tok=46c004&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fmx.gif" class="media" title="Español (Spanish, Mexico)" alt="Español (Spanish, Mexico)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/fr/toh/tp-link/tl-wdr4900" class="media" title="fr:toh:tp-link:tl-wdr4900"><img src="../../lib/exe/fetch.php?cache=&amp;tok=a5beba&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Ffr.gif" class="media" title="Français (French)" alt="Français (French)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/hu/toh/tp-link/tl-wdr4900" class="media" title="hu:toh:tp-link:tl-wdr4900"><img src="../../lib/exe/fetch.php?cache=&amp;tok=6b5470&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fhu.gif" class="media" title="Magyar (Hungarian)" alt="Magyar (Hungarian)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/jp/toh/tp-link/tl-wdr4900" class="media" title="jp:toh:tp-link:tl-wdr4900"><img src="../../lib/exe/fetch.php?cache=&amp;tok=f999fc&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fjp.gif" class="media" title="日本語 (Japanese)" alt="日本語 (Japanese)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/pl/toh/tp-link/tl-wdr4900" class="media" title="pl:toh:tp-link:tl-wdr4900"><img src="../../lib/exe/fetch.php?cache=&amp;tok=c805c0&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fpl.gif" class="media" title="Poliski (Polish)" alt="Poliski (Polish)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/pt-br/toh/tp-link/tl-wdr4900" class="media" title="pt-br:toh:tp-link:tl-wdr4900"><img src="../../lib/exe/fetch.php?cache=&amp;tok=13127d&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fbr.gif" class="media" title="Português brasileiro (Portuguese, Brasil)" alt="Português brasileiro (Portuguese, Brasil)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/ru/toh/tp-link/tl-wdr4900" class="media" title="ru:toh:tp-link:tl-wdr4900"><img src="../../lib/exe/fetch.php?cache=&amp;tok=66ab5e&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fru.gif" class="media" title="Русский (Russsian)" alt="Русский (Russsian)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/tr/toh/tp-link/tl-wdr4900" class="media" title="tr:toh:tp-link:tl-wdr4900"><img src="../../lib/exe/fetch.php?cache=&amp;tok=f4beed&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Ftr.gif" class="media" title="Tϋrkçe (Turkish)" alt="Tϋrkçe (Turkish)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/zh-cn/toh/tp-link/tl-wdr4900" class="media" title="zh-cn:toh:tp-link:tl-wdr4900"><img src="../../lib/exe/fetch.php?cache=&amp;tok=93625a&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fzh-cn.gif" class="media" title="官話/官话 (Chinese)" alt="官話/官话 (Chinese)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/zh-tw/toh/tp-link/tl-wdr4900" class="media" title="zh-tw:toh:tp-link:tl-wdr4900"><img src="../../lib/exe/fetch.php?cache=&amp;tok=b56198&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fzh-tw.gif" class="media" title="臺灣華語 (Taiwanese)" alt="臺灣華語 (Taiwanese)" /></a>
              </div>
            </div>
          </li>
        </ul>
      </div>
        </div>
    
    
    <hr class="a11y" />
</div></div><!-- /header -->

        <div class="wrapper group">

            
            <!-- ********** CONTENT ********** -->
            <div id="dokuwiki__content"><div class="pad group">

                <div class="pageId"><span>toh:tp-link:tl-wdr4900</span></div>

                <div class="page group">
                                                            <!-- wikipage start -->
                    <!-- TOC START -->
<div id="dw__toc">
<h3 class="toggle">Table of Contents</h3>
<div>

<ul class="toc">
<li class="level1"><div class="li"><a href="tl-wdr4900#supported_versions">Supported Versions</a></div></li>
<li class="level1"><div class="li"><a href="tl-wdr4900#hardware">Hardware</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="tl-wdr4900#info">Info</a></div></li>
<li class="level2"><div class="li"><a href="tl-wdr4900#photos">Photos</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="tl-wdr4900#version_1x">Version 1.x</a></div></li>
<li class="level3"><div class="li"><a href="tl-wdr4900#version_20">Version 2.0</a></div></li>
</ul>
</li>
</ul>
</li>
<li class="level1"><div class="li"><a href="tl-wdr4900#serial_console">Serial console</a></div></li>
<li class="level1"><div class="li"><a href="tl-wdr4900#installation">Installation</a></div>
<ul class="toc">
<li class="clear">
<ul class="toc">
<li class="level3"><div class="li"><a href="tl-wdr4900#helpful_screenshots_for_installing_from_chinese_stock_firmware">Helpful Screenshots for installing from Chinese stock firmware</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="tl-wdr4900#vlan">VLAN</a></div></li>
</ul>
</li>
<li class="level1"><div class="li"><a href="tl-wdr4900#de-brick_or_oem_installation">De-brick or OEM installation</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="tl-wdr4900#using_tftp_serial_method">Using TFTP + Serial method</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="tl-wdr4900#pre-requisites">Pre-requisites</a></div></li>
<li class="level3"><div class="li"><a href="tl-wdr4900#v1x_flash_write_procedure">v1.x Flash Write Procedure</a></div></li>
<li class="level3"><div class="li"><a href="tl-wdr4900#v20_flash_write_procedure">v2.0 Flash Write Procedure</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="tl-wdr4900#reset_button_method_no_serial_cable_needed">Reset Button Method (no serial cable needed)</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="tl-wdr4900#pre-requisites1">Pre-requisites</a></div></li>
<li class="level3"><div class="li"><a href="tl-wdr4900#procedure">Procedure</a></div></li>
</ul>
</li>
</ul>
</li>
<li class="level1"><div class="li"><a href="tl-wdr4900#failsafereset">Failsafe / reset</a></div></li>
<li class="level1"><div class="li"><a href="tl-wdr4900#reverting_to_stock_firmware">Reverting to stock firmware</a></div></li>
<li class="level1"><div class="li"><a href="tl-wdr4900#specific_configuration">Specific Configuration</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="tl-wdr4900#port_mirroring">Port Mirroring</a></div></li>
</ul>
</li>
<li class="level1"><div class="li"><a href="tl-wdr4900#qemu_test_environment">QEMU test environment</a></div></li>
<li class="level1"><div class="li"><a href="tl-wdr4900#other_information_resources">Other Information Resources</a></div></li>
</ul>
</div>
</div>
<!-- TOC END -->

<h1 class="sectionedit1" id="tp-link_tl-wdr4900">TP-Link TL-WDR4900</h1>
<div class="level1">

<p>
<a href="../../_detail/media/toh/tp-link/tl-wdr4900.jpg?id=toh%253Atp-link%253Atl-wdr4900" class="media" title="media:toh:tp-link:tl-wdr4900.jpg"><img src="../../_media/media/toh/tp-link/tl-wdr4900.jpg?w=400&amp;tok=c0be6f" class="media" title="TP-Link TL-WDR4900 V2.x" alt="TP-Link TL-WDR4900 V2.x" width="400" /></a>
</p>

<p>
Dual Band (concurrent) and Gigabit Ethernet. Advertised as 900 Mbps it has simultaneous Triple-Stream (3x3) radios on both 2.4GHz and 5 <abbr title="Gigahertz">GHz</abbr> Bands.
</p>

<p>
<strong><span style='color:red; '>There are two very different revisions</span></strong>
</p>
<ul>
<li class="level1"><div class="li"> V1.x: target: <code>mpcC85xx</code> 800Mhz Freescale PPC P1014 CPU 3 internal antennas (2.4Ghz) and 3 external antennas (5Ghz), available world-wide </div>
</li>
<li class="level1"><div class="li"> V2.x: target: <code>ar71xx</code> 720Mhz Qualcomm/Atheros SoC and 6 external antennas, available in PRC only</div>
</li>
</ul>

<p>
Manufacturer&#039;s website:
</p>
<ul>
<li class="level1"><div class="li"> <a href="http://www.tp-link.com/en/products/details/?model=TL-WDR4900" class="urlextern" title="http://www.tp-link.com/en/products/details/?model=TL-WDR4900"  rel="nofollow">http://www.tp-link.com/en/products/details/?model=TL-WDR4900</a> (V1.x)</div>
</li>
<li class="level1"><div class="li"> <a href="http://www.tp-link.com.cn/product_double_292.html" class="urlextern" title="http://www.tp-link.com.cn/product_double_292.html"  rel="nofollow">http://www.tp-link.com.cn/product_double_292.html</a> (V2.x)</div>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> Price: AliExpress - <a href="http://www.aliexpress.com/item/-/997429375.html" class="urlextern" title="http://www.aliexpress.com/item/-/997429375.html"  rel="nofollow">about 100 USD</a></div>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> Forum <a href="https://forum.openwrt.org/viewtopic.php?id=42062" class="urlextern" title="https://forum.openwrt.org/viewtopic.php?id=42062"  rel="nofollow">https://forum.openwrt.org/viewtopic.php?id=42062</a></div>
</li>
</ul>

<p>
As of May 2014, TP-Link appear to be discontinuing the TL-WDR4900 in Great Britain.
</p>

</div>

<h2 class="sectionedit2" id="supported_versions">Supported Versions</h2>
<div class="level2">
<div class="table sectionedit3"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0"> Version/Model </th><th class="col1"> S/N </th><th class="col2"> Release Date </th><th class="col3"> OpenWrt Version Supported </th><th class="col4"> Model Specific Notes </th>
	</tr>
	</thead>
	<tr class="row1">
		<td class="col0"> v1.0 world-wide </td><td class="col1"> - </td><td class="col2"> 2013-01-22 </td><td class="col3"> Barrier Breaker 14.07 </td><td class="col4"> Freescale PPC w/2 Atheros radio chips 3 internal antennas (2.4Ghz) and 3 external antennas (5Ghz) </td>
	</tr>
	<tr class="row2">
		<td class="col0"> v1.3 world-wide </td><td class="col1"> - </td><td class="col2"> 2013 </td><td class="col3"> Barrier Breaker 14.07 </td><td class="col4"> <a href="http://downloads.openwrt.org/barrier_breaker/14.07/mpc85xx/generic/" class="urlextern" title="http://downloads.openwrt.org/barrier_breaker/14.07/mpc85xx/generic/"  rel="nofollow">http://downloads.openwrt.org/barrier_breaker/14.07/mpc85xx/generic/</a> </td>
	</tr>
	<tr class="row3">
		<td class="col0 leftalign"> v2.0 PRC only   </td><td class="col1"> - </td><td class="col2"> 2013-01-22 </td><td class="col3"> Barrier Breaker 14.07 </td><td class="col4"> 6 external antennas, available in PRC only. <a href="https://downloads.openwrt.org/barrier_breaker/14.07/ar71xx/generic/" class="urlextern" title="https://downloads.openwrt.org/barrier_breaker/14.07/ar71xx/generic/"  rel="nofollow">https://downloads.openwrt.org/barrier_breaker/14.07/ar71xx/generic/</a> </td>
	</tr>
</table></div>

</div>

<h2 class="sectionedit4" id="hardware">Hardware</h2>
<div class="level2">

</div>

<h3 class="sectionedit5" id="info">Info</h3>
<div class="level3">
<div class="table sectionedit6"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0 leftalign">  </th><th class="col1"> Version 1.x </th><th class="col2"> Versions 2.x </th>
	</tr>
	</thead>
	<tr class="row1">
		<td class="col0 leftalign"> <strong><a href="http://en.wikipedia.org/wiki/Instruction set" class="interwiki iw_wp" title="http://en.wikipedia.org/wiki/Instruction set">Instruction set</a>:</strong>  </td><td class="col1 centeralign">  <a href="http://en.wikipedia.org/wiki/PowerPC" class="interwiki iw_wp" title="http://en.wikipedia.org/wiki/PowerPC">PowerPC</a>  </td><td class="col2 centeralign">  <a href="http://en.wikipedia.org/wiki/MIPS architecture" class="interwiki iw_wp" title="http://en.wikipedia.org/wiki/MIPS architecture">MIPS</a>  </td>
	</tr>
	<tr class="row2">
		<td class="col0 leftalign"> <strong>Vendor:</strong>                                  </td><td class="col1 leftalign"> <a href="http://en.wikipedia.org/wiki/Freescale Semiconductor" class="interwiki iw_wp" title="http://en.wikipedia.org/wiki/Freescale Semiconductor">Freescale Semiconductor</a>        </td><td class="col2 leftalign"> <a href="http://en.wikipedia.org/wiki/Qualcomm Atheros" class="interwiki iw_wp" title="http://en.wikipedia.org/wiki/Qualcomm Atheros">Qualcomm Atheros</a>  </td>
	</tr>
	<tr class="row3">
		<td class="col0 leftalign"> <strong><a href="../../doc/techref/bootloader.1" class="wikilink1" title="doc:techref:bootloader">Bootloader</a>:</strong>              </td><td class="col1 leftalign"> <a href="../../doc/techref/bootloader/uboot" class="wikilink1" title="doc:techref:bootloader:uboot">U-Boot</a> 2010.12-svn15934 for PowerPC  </td><td class="col2"> <a href="../../doc/techref/bootloader/uboot" class="wikilink1" title="doc:techref:bootloader:uboot">U-Boot</a> ? fork of mainline U-Boot version 1.1.4 (2005-12-17) for MIPS ? </td>
	</tr>
	<tr class="row4">
		<td class="col0 leftalign"> <strong><a href="../../doc/hardware/soc.1" class="wikilink1" title="doc:hardware:soc">System-On-Chip</a>:</strong>     </td><td class="col1 leftalign"> <a href="http://en.wikipedia.org/wiki/PowerQUICC#PowerQUICC_III" class="interwiki iw_wp" title="http://en.wikipedia.org/wiki/PowerQUICC#PowerQUICC_III">Freescale MPC85xx</a>      </td><td class="col2 leftalign"> QCA9558-AT4A  </td>
	</tr>
	<tr class="row5">
		<td class="col0 leftalign"> <strong><a href="../../doc/hardware/cpu" class="wikilink1" title="doc:hardware:cpu">CPU</a>/Speed</strong>           </td><td class="col1"> PPC P1014@800MHz </td><td class="col2 leftalign"> MIPS 74Kc Vers. 5.0 720 <abbr title="Megahertz">MHz</abbr>  </td>
	</tr>
	<tr class="row6">
		<td class="col0 leftalign"> <strong>Flash-Chip:</strong>                              </td><td class="col1"> <a href="http://www.spansion.com/Support/Datasheets/S25FL128S_256S_00.pdf" class="urlextern" title="http://www.spansion.com/Support/Datasheets/S25FL128S_256S_00.pdf"  rel="nofollow">S25FL128S</a> </td><td class="col2"> Winbond <a href="http://www.nexflash.com/NR/rdonlyres/05A6F2FD-83D2-4748-8394-65909AC2A8E3/0/W25Q64FV.pdf" class="urlextern" title="http://www.nexflash.com/NR/rdonlyres/05A6F2FD-83D2-4748-8394-65909AC2A8E3/0/W25Q64FV.pdf"  rel="nofollow">W25Q64FVSIG</a> </td>
	</tr>
	<tr class="row7">
		<td class="col0 leftalign"> <strong>Flash size:</strong>                              </td><td class="col1 leftalign"> 16384 KiB  </td><td class="col2 leftalign"> 8192 KiB  </td>
	</tr>
	<tr class="row8">
		<td class="col0 leftalign"> <strong>RAM-Chip:</strong>                                </td><td class="col1"> <a href="http://www.skhynix.com/inc/pdfDownload.jsp?path=/datasheet/pdf/graphics/H5TQ1G63DFR(Rev1.1).pdf" class="urlextern" title="http://www.skhynix.com/inc/pdfDownload.jsp?path=/datasheet/pdf/graphics/H5TQ1G63DFR(Rev1.1).pdf"  rel="nofollow">H5TQ1G63DFR</a> </td><td class="col2"> <a href="http://www.skhynix.com/products/consumer/view.jsp?info.ramKind=03&amp;info.serialNo=H5PS5162GFR" class="urlextern" title="http://www.skhynix.com/products/consumer/view.jsp?info.ramKind=03&amp;info.serialNo=H5PS5162GFR"  rel="nofollow">H5PS5162GFR</a> </td>
	</tr>
	<tr class="row9">
		<td class="col0 leftalign"> <strong>RAM size:</strong>                                </td><td class="col1"> 128 MiB </td><td class="col2 leftalign"> 128 MiB   </td>
	</tr>
	<tr class="row10">
		<td class="col0 leftalign"> <strong>Wireless1:</strong>                               </td><td class="col1 leftalign"> Chip: AR9381-AL1A w/ 3x3 MIMO for 2.4GHz  </td><td class="col2 leftalign"> SoC: QCA9558-AT4A w/ 3x3 MIMO for 2.4Ghz           </td>
	</tr>
	<tr class="row11">
		<td class="col0 leftalign"> <strong>Wireless2:</strong>                               </td><td class="col1 leftalign"> Chip: AR9580-AR1A w/ 3x3 MIMO for 5Ghz    </td><td class="col2"> Chip: AR9580-AR1A w/ 3x3 MIMO for 5Ghz </td>
	</tr>
	<tr class="row12">
		<td class="col0 leftalign"> <strong><a href="../../doc/techref/swconfig" class="wikilink1" title="doc:techref:swconfig">Switch</a>:</strong>         </td><td class="col1 leftalign"> AR8327N-AL1A                              </td><td class="col2 leftalign"> AR8327N-BL1A  </td>
	</tr>
	<tr class="row13">
		<td class="col0 leftalign"> <strong>USB:</strong>                                     </td><td class="col1 leftalign"> 2 (USB 2.0)    </td><td class="col2"> 2 (USB 2.0) </td>
	</tr>
	<tr class="row14">
		<td class="col0 leftalign"> <strong><a href="../../OpenWrtDocs/Customizing/Hardware/Serial_Console" class="wikilink1" title="doc:hardware:port.serial">Serial</a>:</strong>     </td><td class="col1"> <a href="tl-wdr4900#serial" title="toh:tp-link:tl-wdr4900 ↵" class="wikilink1">Yes</a> </td><td class="col2"> <a href="tl-wdr4900#serial" title="toh:tp-link:tl-wdr4900 ↵" class="wikilink1">Yes</a> </td>
	</tr>
	<tr class="row15">
		<td class="col0 leftalign"> <strong><a href="../../doc/hardware/port.jtag" class="wikilink1" title="doc:hardware:port.jtag">JTAG</a>:</strong>         </td><td class="col1 leftalign"> Yes  </td><td class="col2"> <a href="tl-wdr4900#jtag" title="toh:tp-link:tl-wdr4900 ↵" class="wikilink1">Yes</a> </td>
	</tr>
</table></div>

</div>

<h3 class="sectionedit7" id="photos">Photos</h3>
<div class="level3">

</div>

<h4 id="version_1x">Version 1.x</h4>
<div class="level4">

<p>
<a href="../../_detail/media/toh/tp-link/tl-wdr4900/v1serial.jpg?id=toh%253Atp-link%253Atl-wdr4900" class="media" title="media:toh:tp-link:tl-wdr4900:v1serial.jpg"><img src="../../_media/media/toh/tp-link/tl-wdr4900/v1serial.jpg?w=400&amp;tok=497c8c" class="media" title="wdr4900v1 serial" alt="wdr4900v1 serial" width="400" /></a>
</p>

<p>
<a href="../../_detail/media/toh/tp-link/tl-wdr4900/v1bottom.jpg?id=toh%253Atp-link%253Atl-wdr4900" class="media" title="media:toh:tp-link:tl-wdr4900:v1bottom.jpg"><img src="../../_media/media/toh/tp-link/tl-wdr4900/v1bottom.jpg?w=400&amp;tok=e39dfb" class="media" title="wdr4900v1 bottom" alt="wdr4900v1 bottom" width="400" /></a>
</p>

</div>

<h4 id="version_20">Version 2.0</h4>
<div class="level4">

<p>
<a href="../../_detail/media/toh/tp-link/tl-wdr4900/v2serial.jpg?id=toh%253Atp-link%253Atl-wdr4900" class="media" title="media:toh:tp-link:tl-wdr4900:v2serial.jpg"><img src="../../_media/media/toh/tp-link/tl-wdr4900/v2serial.jpg?w=400&amp;tok=daa6fc" class="media" title="wdr4900v2 serial" alt="wdr4900v2 serial" width="400" /></a>
</p>

</div>

<h2 class="sectionedit8" id="serial_console">Serial console</h2>
<div class="level2">

<p>
Serial console is available on the JP2 (v1.x) or J1 (v2.0) connector - see PCB photos above.
</p>

<p>
<strong>DO NOT CONNECT VCC</strong>. Use only TX/RX/GND.
</p>

<p>
Baud Rate: 115200<br/>

Data Bits: 8<br/>

Parity: No<br/>

Stop Bits: 1<br/>

</p>

<p>
Factory firmware login credentials: <em>(v1.x only)</em><br/>

 * username: root<br/>

 * password: 5up
</p>

<p>
<code>Note:</code> be extremely careful when soldering a serial console on TP-Link TL-WDR4900 - the design of the PCB is not well suited for soldering and important paths/connections are near the soldering points. We have now 3 Routers which are dead, just because we used too much solder…
</p>

</div>

<h2 class="sectionedit9" id="installation">Installation</h2>
<div class="level2">

<p>
OpenWRT may be installed <a href="../../doc/howto/installing#method1viaoemfirmware" class="wikilink1" title="doc:howto:generic.flashing">via OEM firmware</a> on both versions.
</p>

<p>
v1: <a href="http://downloads.openwrt.org/barrier_breaker/14.07/mpc85xx/generic/openwrt-mpc85xx-generic-tl-wdr4900-v1-squashfs-factory.bin" class="urlextern" title="http://downloads.openwrt.org/barrier_breaker/14.07/mpc85xx/generic/openwrt-mpc85xx-generic-tl-wdr4900-v1-squashfs-factory.bin"  rel="nofollow">openwrt-mpc85xx-generic-tl-wdr4900-v1-squashfs-factory.bin </a>
</p>

<p>
v2: <a href="https://downloads.openwrt.org/barrier_breaker/14.07/ar71xx/generic/openwrt-ar71xx-generic-tl-wdr4900-v2-squashfs-factory.bin" class="urlextern" title="https://downloads.openwrt.org/barrier_breaker/14.07/ar71xx/generic/openwrt-ar71xx-generic-tl-wdr4900-v2-squashfs-factory.bin"  rel="nofollow">openwrt-ar71xx-generic-tl-wdr4900-v2-squashfs-factory.bin</a>
</p>
<ul>
<li class="level1"><div class="li"> If you do not speak chinese and are not familiar with the standard TP-Link firmware, please see the screen shots below for help.</div>
</li>
</ul>

<p>
After installation you will want to proceed with <a href="../../doc/howto/firstlogin" class="urlextern" title="http://wiki.openwrt.org/doc/howto/firstlogin"  rel="nofollow">first login</a>, <a href="../../doc/howto/configuration" class="urlextern" title="http://wiki.openwrt.org/doc/howto/basic.config"  rel="nofollow">basic configuration</a>. You may also wish to install the web user interface <a href="../../doc/luci" class="wikilink1" title="doc:howto:luci.essentials">LuCI</a>, after which you can manage your router at <a href="http://192.168.1.1" class="urlextern" title="http://192.168.1.1"  rel="nofollow">http://192.168.1.1</a>
</p>

</div>

<h4 id="helpful_screenshots_for_installing_from_chinese_stock_firmware">Helpful Screenshots for installing from Chinese stock firmware</h4>
<div class="level4">

<p>
<a href="../../_detail/media/toh/tp-link/stock-fw-upgrade-step1.jpg?id=toh%253Atp-link%253Atl-wdr4900" class="media" title="media:toh:tp-link:stock-fw-upgrade-step1.jpg"><img src="../../_media/media/toh/tp-link/stock-fw-upgrade-step1.jpg?w=500&amp;tok=cb6bef" class="media" title="Upgrading from Stock Firwmare - Step 1" alt="Upgrading from Stock Firwmare - Step 1" width="500" /></a>
</p>

<p>
<a href="../../_detail/media/toh/tp-link/stock-fw-upgrade-step2.jpg?id=toh%253Atp-link%253Atl-wdr4900" class="media" title="media:toh:tp-link:stock-fw-upgrade-step2.jpg"><img src="../../_media/media/toh/tp-link/stock-fw-upgrade-step2.jpg?w=250&amp;tok=a23001" class="media" title="Upgrading from Stock Firwmare - Step 2" alt="Upgrading from Stock Firwmare - Step 2" width="250" /></a>
</p>

</div>

<h3 class="sectionedit10" id="vlan">VLAN</h3>
<div class="level3">

<p>
To get tagged and untagged traffic working on the same port a patch for the switch driver is needed. Refer to: <a href="https://dev.openwrt.org/ticket/12181#comment:73" class="urlextern" title="https://dev.openwrt.org/ticket/12181#comment:73"  rel="nofollow">https://dev.openwrt.org/ticket/12181#comment:73</a>
</p>

</div>

<h2 class="sectionedit11" id="de-brick_or_oem_installation">De-brick or OEM installation</h2>
<div class="level2">

</div>

<h3 class="sectionedit12" id="using_tftp_serial_method">Using TFTP + Serial method</h3>
<div class="level3">

</div>

<h4 id="pre-requisites">Pre-requisites</h4>
<div class="level4">
<ul>
<li class="level1"><div class="li"> a serial connection (e.g. TTL, RS232) from your machine to the router.</div>
</li>
<li class="level1"><div class="li"> a terminal program (e.g. minicom, screen) set for 115200 Baud, 8 data bits, no parity, 1 stop bit, no flow control.</div>
<ul>
<li class="level2"><div class="li"> It is <strong>strongly recommended</strong> not to connect the 3.3V (or any) voltage line - use the router&#039;s own power supply instead.</div>
</li>
</ul>
</li>
<li class="level1"><div class="li"> a <em class="u">factory</em> OpenWrt firmware image into your TFTP server folder (see <a href="tl-wdr4900#installation" title="toh:tp-link:tl-wdr4900 ↵" class="wikilink1">Installation</a> above)</div>
</li>
<li class="level1"><div class="li"> a wired ethernet connection from your computer to one of the router&#039;s <abbr title="Local Area Network">LAN</abbr> ports.</div>
<ul>
<li class="level2"><div class="li"> IP address on this connection should be statically set to 192.168.1.x/24.</div>
</li>
</ul>
</li>
<li class="level1"><div class="li"> a TFTP server started on your local machine</div>
<ul>
<li class="level2"><div class="li"> must be listening on the same link/IP address as the wired ethernet connection to the router</div>
</li>
<li class="level2"><div class="li"> v1.x models prefer the server address 192.168.0.66, v2.0 prefers 192.168.1.100</div>
</li>
</ul>
</li>
</ul>

</div>

<h4 id="v1x_flash_write_procedure">v1.x Flash Write Procedure</h4>
<div class="level4">

<p>
<strong><span style='color:red; '>This section applies to v1.x only!</span></strong> (<a href="tl-wdr4900#v20flashwriteprocedure" title="toh:tp-link:tl-wdr4900 ↵" class="wikilink1">version 2.0 method</a>)
</p>
<ol>
<li class="level1"><div class="li"> Router should be unplugged (power off), your serial line connected, terminal open and TFTP server installed not yet running.</div>
</li>
<li class="level1"><div class="li"> Copy your desired openwrt image for the TPlink-WDR4900 into your TFTP server folder and rename it into <code>openwrt.bin</code> (to save some typing within the flash procedure).</div>
</li>
<li class="level1"><div class="li"> First goal is to get the command prompt from the U-Boot bootloader on your router.</div>
</li>
<li class="level1"><div class="li"> Plug in your router and be ready to type &quot;<code>vl</code>&quot; just after you see the line <code>Autobooting in 1 seconds</code> (Spamming &quot;<code>vl</code>&quot; around this point helps):</div>
</li>
</ol>

<p>
<pre class="code">U-Boot 2010.12-svn15934 (Dec 11 2012 - 16:23:49)

CPU:   P1014, Version: 1.0, (0x80f10110)
Core:  E500, Version: 5.1, (0x80212151)
Clock Configuration:
       CPU0:800  MHz, 
       CCB:400  MHz,
       DDR:333.333 MHz (666.667 MT/s data rate) (Asynchronous), IFC:100  MHz
L1:    D-cache 32 kB enabled
       I-cache 32 kB enabled
Board: P1014RDB 
SPI:   ready
DRAM:  128 MiB
L2:    256 KB enabled
Using default environment

PCIe1: Root Complex of mini PCIe Slot, x1, regs @ 0xffe0a000
  01:00.0     - 168c:abcd - Network controller
PCIe1: Bus 00 - 01
PCIe2: Root Complex of PCIe Slot, x1, regs @ 0xffe09000
  03:00.0     - 168c:0033 - Network controller
PCIe2: Bus 02 - 03
In:    serial
Out:   serial
Err:   serial
Net:   initialization for Atheros AR8327/AR8328
AR8327/AR8328 v1.1 is found!
eTSEC1
Autobooting in 1 seconds</pre>

</p>

<p>
In case you failed the right timing just reboot again until the prompt appears
<pre class="code">=&gt;</pre>

</p>
<ol>
<li class="level1"><div class="li"> (<em>optional</em>) Now lets check what kind of parameters the u-boot loader expects (e.g file name of firmware, IP via TFTP &amp; load address).</div>
</li>
</ol>

<p>
  Type <code>tftpboot</code> &amp; press ENTER …
<pre class="code">=&gt; tftpboot
Check for phy link status
Speed: 1000, full duplex
Using eTSEC1 device
TFTP from server 192.168.0.104; our IP address is 192.168.0.136
Filename &#039;uImage&#039;.
Load address: 0x1000000
Loading: T T T T T T T T T T 
Retry count exceeded; starting again</pre>

</p>
<ol>
<li class="level1"><div class="li"> As you can see, uboot expects a firmware image file name &quot;<code>uImage</code>&quot; at TFTP server address <code>192.168.1.104</code>,</div>
</li>
</ol>

<p>
  then, just change you local ip into <code>192.168.1.104</code> and start your TFTP server.
</p>
<ol>
<li class="level1"><div class="li"> Start the uBoot&#039;s TFTP client to download the image from your local machine by typing: <code>tftpboot 0x1000000 openwrt.bin</code> + ENTER</div>
</li>
</ol>

<p>
<pre class="code">=&gt; tftpboot 0x1000000 openwrt.bin
Check for phy link status
Speed: 1000, full duplex
Using eTSEC1 device
TFTP from server 192.168.0.104; our IP address is 192.168.0.136
Filename &#039;openwrt.bin&#039;.
Load address: 0x1000000
Loading: #################################################################
         #################################################################
         #################################################################
         #################################################################
         #################################################################
         #################################################################
         #################################################################
         #################################################################
         #################################################################
         #################################################################
         #################################################################
         #################################################################
         #################################################################
         #################################################################
         #################################################################
         #################################################################
         #################################################################
         ###
done
Bytes transferred = 16252928 (f80000 hex)</pre>

</p>
<ol>
<li class="level1"><div class="li"> The last line needs to show a size of f80000 hex, otherwise your image is unsuitable.</div>
</li>
<li class="level1"><div class="li"> To select the SPI flash memory type: sf probe 0</div>
</li>
</ol>

<p>
<pre class="code">=&gt; sf probe 0
SF: Detected S25FL128S_65k with page size 256, total 16 MiB
16384 KiB S25FL128S_64K at 0:0 is now current device</pre>

</p>
<ol>
<li class="level1"><div class="li"> Now we need to erase parts of the flash memory to be able to copy your fresh loaded firmware into it,</div>
</li>
</ol>

<p>
    just type in the prompt <code>sf erase 0x60000 0xf80000</code>:
<pre class="code">=&gt; sf erase 0x60000 0xf80000
SPI flash erase successful</pre>

</p>
<ol>
<li class="level1"><div class="li"> Now just copy the image to the right place by typing <code>sf write 0x1000000 0x60000 0xf80000</code></div>
</li>
</ol>

<p>
<pre class="code">=&gt; sf write 0x1000000 0x60000 0xf80000
SPI flash write successful</pre>

</p>
<ol>
<li class="level1"><div class="li"> So, in case your image is the correct one, you should do just a single reboot to have a working TL-WRD4900 back on your desk.</div>
</li>
</ol>

<p>
    Type <code>reset</code> or just un-plug and re-plug the power of your router and watch the boot process.
<pre class="code">=&gt; reset</pre>

</p>

</div>

<h4 id="v20_flash_write_procedure">v2.0 Flash Write Procedure</h4>
<div class="level4">

<p>
<strong><span style='color:red; '>This section applies to v2.0 only!</span></strong> (<a href="tl-wdr4900#v1xflashwriteprocedure" title="toh:tp-link:tl-wdr4900 ↵" class="wikilink1">version 1.x method</a>)
</p>
<ol>
<li class="level1"><div class="li"> Be sure the router is powered off (there&#039;s a handy power switch beside the power line).</div>
</li>
<li class="level1"><div class="li"> Connect your serial and ethernet cables to your computer.</div>
</li>
<li class="level1"><div class="li"> Open your terminal for the serial connection.</div>
</li>
<li class="level1"><div class="li"> Power on the router</div>
</li>
<li class="level1"><div class="li"> When you see <code>Autobooting in 1 seconds</code>, quickly type &quot;<code>tpl</code>&quot; to access the command line.</div>
<ul>
<li class="level2"><div class="li"> there is no harm at all typing &quot;<code>tpl</code>&quot; repeatedly from the moment you power on, I often start when I see the U-Boot bootloader header. <img src="../../lib/images/smileys/icon_wink.gif" class="icon" alt=";-)" /></div>
</li>
</ul>
</li>
<li class="level1"><div class="li"> Start the TFTP server running on your computer.</div>
</li>
<li class="level1"><div class="li"> At the <code>ap135&gt;</code> prompt, type the following commands:</div>
<ol>
<li class="level2"><div class="li"> <code>tftpboot 0x81000000 openwrt.bin</code> (where openwrt.bin is the name of your firmware image)</div>
</li>
<li class="level2"><div class="li"> <code>erase 0x9f020000 +0x7c0000</code></div>
</li>
<li class="level2"><div class="li"> <code>cp.b 0x81000000 0x9f020000 0x7c0000</code></div>
</li>
<li class="level2"><div class="li"> <code>bootm 0x9f020000</code></div>
</li>
</ol>
</li>
<li class="level1"><div class="li"> Congratulations!</div>
</li>
</ol>

</div>

<h3 class="sectionedit13" id="reset_button_method_no_serial_cable_needed">Reset Button Method (no serial cable needed)</h3>
<div class="level3">

<p>
If you want to de-brick/upgrade your router using TFTP without a serial cable follow these steps:
</p>

</div>

<h4 id="pre-requisites1">Pre-requisites</h4>
<div class="level4">
<ul>
<li class="level1"><div class="li"> Copy a working &amp; full OpenWrt sysupgrade image into your TFTP server folder (e.g: <a href="https://downloads.openwrt.org/barrier_breaker/14.07/mpc85xx/generic/openwrt-mpc85xx-generic-tl-wdr4900-v1-squashfs-sysupgrade.bin" class="urlextern" title="https://downloads.openwrt.org/barrier_breaker/14.07/mpc85xx/generic/openwrt-mpc85xx-generic-tl-wdr4900-v1-squashfs-sysupgrade.bin"  rel="nofollow">https://downloads.openwrt.org/barrier_breaker/14.07/mpc85xx/generic/openwrt-mpc85xx-generic-tl-wdr4900-v1-squashfs-sysupgrade.bin</a>) so it will be found under the path /wdr4900v1_tp_recovery.bin You can also use the image used for reverting to stock firmware if you prefer to do so, but it has to be placed under the same path.</div>
</li>
<li class="level1"><div class="li"> A TFTP server started on your local machine on <abbr title="Local Area Network">LAN</abbr> address 192.168.0.66/24.</div>
</li>
<li class="level1"><div class="li"> Connect your <abbr title="Local Area Network">LAN</abbr>-port to one of the routers <abbr title="Local Area Network">LAN</abbr> </div>
</li>
</ul>

</div>

<h4 id="procedure">Procedure</h4>
<div class="level4">
<ol>
<li class="level1"><div class="li"> Router should be unplugged (power off) and TFTP server installed not yet running.</div>
</li>
<li class="level1"><div class="li"> Copy your desired openwrt image for the TPlink-WDR4900 into your TFTP server folder and rename it into <code>wdr4900v1_tp_recovery.bin</code> (as the router will search for this file).</div>
</li>
<li class="level1"><div class="li"> Make sure your card has address 192.168.0.66.</div>
</li>
<li class="level1"><div class="li"> Start the tftp server and make sure it is listening on 192.168.0.66 </div>
</li>
<li class="level1"><div class="li"> Plug in your router and keep the WPS/Reset button pressed until the tftp server confirms the transfer is done</div>
</li>
<li class="level1"><div class="li"> Wait for the router to reboot, the new image will then be loaded</div>
</li>
<li class="level1"><div class="li"> A pack ready for doing this, containing TFTPD32 server and the latest TP-Link firmware, can be found here: <a href="https://forum.openwrt.org/viewtopic.php?pid=236428#p236428" class="urlextern" title="https://forum.openwrt.org/viewtopic.php?pid=236428#p236428"  rel="nofollow">https://forum.openwrt.org/viewtopic.php?pid=236428#p236428</a></div>
</li>
<li class="level1"><div class="li"> Also there&#039;s a video of the process: <a href="http://www.youtube.com/watch?v=54PAS0gvW2k" class="urlextern" title="http://www.youtube.com/watch?v=54PAS0gvW2k"  rel="nofollow">http://www.youtube.com/watch?v=54PAS0gvW2k</a></div>
</li>
</ol>

</div>

<h2 class="sectionedit14" id="failsafereset">Failsafe / reset</h2>
<div class="level2">

<p>
On the v1 units, the only way that I have been able to get the router into failsafe mode is to quickly and repeatedly press the WPS/Reset button <em>starting before the front panel &quot;star&quot; LED started flashing. </em>When that LED finally lit, it appeared to go directly into the rapid-flashing &quot;failsafe&quot; indication. If the WPS LED lights (rightmost, &quot;yin-yang arrows&quot;), it may be that you started clicking the button a little early in the boot sequence.
</p>

<p>
For what you can do in failsafe, go to the <a href="../../doc/howto/generic.failsafe" class="wikilink1" title="doc:howto:generic.failsafe">OpenWrt Failsafe Mode</a> page.
</p>

<p>
Another user writes: 
</p>
<blockquote><div class="no">
 After all else failed, I found <a href="http://www.binaryfriend.ru/2012/10/how-to-hard-reset-openwrt-on-tp-link-1043nd" class="urlextern" title="http://www.binaryfriend.ru/2012/10/how-to-hard-reset-openwrt-on-tp-link-1043nd"  rel="nofollow">http://www.binaryfriend.ru/2012/10/how-to-hard-reset-openwrt-on-tp-link-1043nd</a>.  Extremely simple.  Please see the original page for more info.  Summary:<br/>
<br/>
  - Power the router up;<br/>
  - After powering up track the SYS light when it starts to blink, when it does press and hold the QSS button till SYS lights starts to blink faster – router goes to recovery mode;<br/>
  - Telnet to the router on 192.168.1.1 – no password needed (if your computer doesn’t gets IP address from DHCP assign it manually for i.e. 192.168.1.200 with netmask of 255.255.255.0);<br/>
  - In telnet terminal type `mtd -r erase rootfs_data` to reset OpenWRT to it’s defaults.</div></blockquote>

</div>

<h2 class="sectionedit15" id="reverting_to_stock_firmware">Reverting to stock firmware</h2>
<div class="level2">

<p>
You can revert to stock firmware by following these steps:
</p>
<ul>
<li class="level1"><div class="li"> Download / copy with SCP this firmware to the /tmp folder of the router: <a href="https://www.dropbox.com/sh/g8dyafqrato12pc/AADtSjx_MVot7asdqeRtvVVza?dl=0" class="urlextern" title="https://www.dropbox.com/sh/g8dyafqrato12pc/AADtSjx_MVot7asdqeRtvVVza?dl=0"  rel="nofollow">https://www.dropbox.com/sh/g8dyafqrato12pc/AADtSjx_MVot7asdqeRtvVVza?dl=0</a></div>
</li>
<li class="level1"><div class="li"> Optionally check MD5 hash: 1148EFD09C6D9B07E6A01259A4EBEF72</div>
</li>
<li class="level1"><div class="li"> Rename to firmware.bin (less chance for spelling errors and unsupported characters)</div>
</li>
<li class="level1"><div class="li"> Open a SSH session to the router, cd to /tmp</div>
</li>
<li class="level1"><div class="li"> Execute the following command: mtd -r firmware.bin firmware</div>
</li>
<li class="level1"><div class="li"> Wait until the router reboots</div>
</li>
</ul>

<p>
Note: You can only flash this firmware version because it has no BOOT in the filename. This image and OpenWRT images are the exact same size. Other images from TP-Link do have BOOT in the filename and these files are also 
more bytes than this one, then to create your own flashable image, follow the below method:
</p>

<p>
In order to create your own bootable file download firmware from TP-Link and execute the following command (change the if= filename in case you downloaded a different version):
</p>
<ul>
<li class="level1"><div class="li"> dd if=wdr4900nv1_en_3_14_3_up_boot\(130320\).bin of=wdr4900nv1.bin skip=769 bs=512</div>
</li>
</ul>

<p>
You can then transfer the resulting file and flash this using the mtd method described elsewhere in this document.
</p>
<ul>
<li class="level1"><div class="li"> mtd write wdr4900nv1.bin firmware</div>
</li>
</ul>
<div class="tags"><span>
	<a href="../../tag/gigabitethernet?do=showtag&amp;tag=GigabitEthernet" class="wikilink1" title="tag:gigabitethernet" rel="tag">GigabitEthernet</a>,
	<a href="../../tag/internalantenna?do=showtag&amp;tag=internalantenna" class="wikilink1" title="tag:internalantenna" rel="tag">internalantenna</a>,
	<a href="../../tag/2usb?do=showtag&amp;tag=2usb" class="wikilink1" title="tag:2usb" rel="tag">2usb</a>,
	<a href="../../tag/3x3?do=showtag&amp;tag=3x3" class="wikilink1" title="tag:3x3" rel="tag">3x3</a>,
	<a href="../../tag/450mbps?do=showtag&amp;tag=450mbps" class="wikilink1" title="tag:450mbps" rel="tag">450mbps</a>,
	<a href="../../tag/usb2.0?do=showtag&amp;tag=usb2.0" class="wikilink1" title="tag:usb2.0" rel="tag">usb2.0</a>,
	<a href="../../tag/5ghz?do=showtag&amp;tag=5ghz" class="wikilink1" title="tag:5ghz" rel="tag">5ghz</a>,
	<a href="../../tag/5port?do=showtag&amp;tag=5port" class="wikilink1" title="tag:5port" rel="tag">5port</a>,
	<a href="../../tag/16flash?do=showtag&amp;tag=16flash" class="wikilink1" title="tag:16flash" rel="tag">16flash</a>,
	<a href="../../tag/802.11abgn?do=showtag&amp;tag=802.11abgn" class="wikilink1" title="tag:802.11abgn" rel="tag">802.11abgn</a>,
	<a href="../../tag/ath9k?do=showtag&amp;tag=ath9k" class="wikilink1" title="tag:ath9k" rel="tag">ath9k</a>,
	<a href="../../tag/detachableantenna" class="wikilink1" title="tag:detachableantenna" rel="tag">DetachableAntenna</a>,
	<a href="../../tag/6ant?do=showtag&amp;tag=6ant" class="wikilink1" title="tag:6ant" rel="tag">6ant</a>,
	<a href="../../tag/3ant?do=showtag&amp;tag=3ant" class="wikilink1" title="tag:3ant" rel="tag">3ant</a>,
	<a href="../../tag/128ram?do=showtag&amp;tag=128ram" class="wikilink1" title="tag:128ram" rel="tag">128ram</a>,
	<a href="../../tag/802.11abgn_simultan?do=showtag&amp;tag=802.11abgn_simultan" class="wikilink1" title="tag:802.11abgn_simultan" rel="tag">802.11abgn simultan</a>,
	<a href="../../tag/2wnic?do=showtag&amp;tag=2WNIC%252C" class="wikilink1" title="tag:2wnic" rel="tag">2WNIC,</a>,
	<a href="../../tag/soc.freescale.mpc?do=showtag&amp;tag=soc.freescale.mpc" class="wikilink1" title="tag:soc.freescale.mpc" rel="tag">soc.freescale.mpc</a>
</span></div>

</div>

<h2 class="sectionedit16" id="specific_configuration">Specific Configuration</h2>
<div class="level2">

<p>
==== Switch Ports (for VLANs) ==== WDR4900 v1?
</p>

<p>
Numbers 2-5 are Ethernet Ports 1-4 as labeled on the unit, number 1 is &quot;Internet&quot; (WAN) on the unit, 0 is the internal connection to the router itself.
</p>
<div class="table sectionedit17"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0"> Port </th><th class="col1"> Switch port </th>
	</tr>
	</thead>
	<tr class="row1">
		<td class="col0 leftalign"> CPU   </td><td class="col1"> 0 </td>
	</tr>
	<tr class="row2">
		<td class="col0 leftalign"> WAN   </td><td class="col1"> 1 </td>
	</tr>
	<tr class="row3">
		<td class="col0"> <abbr title="Local Area Network">LAN</abbr> 1 </td><td class="col1"> 2 </td>
	</tr>
	<tr class="row4">
		<td class="col0"> <abbr title="Local Area Network">LAN</abbr> 2 </td><td class="col1"> 3 </td>
	</tr>
	<tr class="row5">
		<td class="col0"> <abbr title="Local Area Network">LAN</abbr> 3 </td><td class="col1"> 4 </td>
	</tr>
	<tr class="row6">
		<td class="col0"> <abbr title="Local Area Network">LAN</abbr> 4 </td><td class="col1"> 5 </td>
	</tr>
	<tr class="row7">
		<td class="col0"> (not used ?) </td><td class="col1"> 6 </td>
	</tr>
</table></div>

<p>
==== Switch Ports (for VLANs) ==== WDR4900 v2
</p>

<p>
Numbers 2-5 are Ethernet Ports 1-4 as labeled on the unit, number 1 is &quot;Internet&quot; (WAN) on the unit, 6 is the internal connection to the router itself, and 0 is another CPU, because this router has two.
</p>
<div class="table sectionedit18"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0"> Port </th><th class="col1"> Switch port </th>
	</tr>
	</thead>
	<tr class="row1">
		<td class="col0"> Second CPU </td><td class="col1"> 0 </td>
	</tr>
	<tr class="row2">
		<td class="col0 leftalign"> WAN   </td><td class="col1"> 1 </td>
	</tr>
	<tr class="row3">
		<td class="col0"> <abbr title="Local Area Network">LAN</abbr> 1 </td><td class="col1"> 2 </td>
	</tr>
	<tr class="row4">
		<td class="col0"> <abbr title="Local Area Network">LAN</abbr> 2 </td><td class="col1"> 3 </td>
	</tr>
	<tr class="row5">
		<td class="col0"> <abbr title="Local Area Network">LAN</abbr> 3 </td><td class="col1"> 4 </td>
	</tr>
	<tr class="row6">
		<td class="col0"> <abbr title="Local Area Network">LAN</abbr> 4 </td><td class="col1"> 5 </td>
	</tr>
	<tr class="row7">
		<td class="col0 leftalign"> CPU   </td><td class="col1"> 6 </td>
	</tr>
</table></div>

<p>
==== Luci WDR4900v2 (Example Vlans tag for Movistar FTTH Spain)
</p>

<p>
<a href="../../_detail/media/tplink_wdr4900v2_switch_vlan_tagg.jpg?id=toh%253Atp-link%253Atl-wdr4900" class="media" title="media:tplink_wdr4900v2_switch_vlan_tagg.jpg"><img src="../../_media/media/tplink_wdr4900v2_switch_vlan_tagg.jpg?w=900&amp;tok=cd27d1" class="media" title="tplink_wdr4900v2_switch_vlan_tagg.jpg" alt="tplink_wdr4900v2_switch_vlan_tagg.jpg" width="900" /></a>
</p>

</div>

<h3 class="sectionedit19" id="port_mirroring">Port Mirroring</h3>
<div class="level3">

<p>
Hardware port mirroring is supported in v1/(v2?) <img src="../../lib/images/smileys/fixme.gif" class="icon" alt="FIXME" />
</p>

<p>
Here&#039;s an example of configuring port mirroring in /etc/config/network for mirroring port 1 to port 5
(You may need to restart the router for port mirroring changes to take effect):
<pre class="code">
config switch
	option name &#039;switch0&#039;
	option reset &#039;1&#039;
	option enable_vlan &#039;1&#039;
	option enable_mirror_rx &#039;1&#039;
	option enable_mirror_tx &#039;1&#039;
	option mirror_source_port &#039;1&#039;
	option mirror_monitor_port &#039;5&#039;
</pre>

</p>

</div>

<h2 class="sectionedit20" id="qemu_test_environment">QEMU test environment</h2>
<div class="level2">

<p>
In case you are interested to run a virtual test environment for your PPC based WDR4900 platform
QEMU is a good helper. It cannot run the downloadable kernel image but at least a slightly modfied 
version. Here are the basic steps to get a initial setup up and runnung.
</p>

<p>
Install QEMU for your Linux distribution. It should be at least 2.1.2. The process was only tested 
with that version. Create a <a href="../../about/toolchain" class="wikilink1" title="about:toolchain">buildroot environment</a>. If you do not want to read 
every single bit of information over there use these commands. We assume that we only want to
build the stable Barrier Breaker version.
</p>

<p>
<pre class="code"># cd ~
# mkdir buildroot
# cd buildroot
# git clone git://git.openwrt.org/14.07/openwrt.git
# cd openwrt
# ./scripts/feeds update -a
# ./scripts/feeds install -a</pre>

</p>

<p>
Select your target platform
</p>

<p>
<pre class="code"># make menuconfig
Target System -&gt; Freescale MPC85xx [*]</pre>

</p>

<p>
Save changes and leave setup. Create the default configuration for the platform
</p>

<p>
<pre class="code"># make defconfig</pre>

</p>

<p>
Activate some essential buildroot configuration options.
</p>

<p>
<pre class="code"># make menuconfig
Target images -&gt; ramdisk [*]
Kernel modules -&gt; filesystems -&gt; kmod-fs-ext4 [*]</pre>

</p>

<p>
Save changes and leave setup. Now head over to kernel configuration and define critical
settings that the kernel can run inside QEMU. 
</p>

<p>
<pre class="code"># make kernel_menuconfig
Platform support -&gt; Freescale machine type -&gt; qemu generic platform [*]
device drivers -&gt; character devices -&gt; serial drivers -&gt; serial port on open plaform bus [ ]</pre>

</p>

<p>
If you miss one of the two your VM will not boot or have no accessible console.
<strong>Have a look the open firmware serial bus must be disabled!</strong>. Additionally we 
should enable drivers to access QEMU disks and network cards
</p>

<p>
<pre class="code">device drivers -&gt; virtio drivers -&gt; activate all menu items [*]
device drivers -&gt; block devices -&gt; Virtio block driver [*]
device drivers -&gt; network device support -&gt; virtio network driver [*]</pre>

</p>

<p>
Create the kernel image with
</p>

<p>
<pre class="code">make -j 8</pre>

</p>

<p>
Finally we have a standalone kernel image with an initial root ramdisk included.
So we could already start the VM. To get into better shape create a separate folder 
to hold the image and create a QCOW2 disk with a single ext4 filesystem that can 
be mounted inside the VM.
</p>

<p>
<pre class="code"># cd ~
# mkdir vm
# cd vm
# cp ~/buildroot/openwrt/bin/mpc85xx/openwrt-mpc85xx-generic-zImage .
# qemu-img create -f qcow2 hdd.qcow2 4G
# su
# modprobe nbd max_part=8
# qemu-nbd --connect=/dev/nbd0 ./hdd.qcow2
# fdisk /dev/nbd0 (... create partition ...)
# mkfs.ext4 /dev/nbd0p1
# qemu-nbd --disconnect /dev/nbd0
# exit</pre>

</p>

<p>
This is what our VM folder should look like now:
</p>

<p>
<pre class="code">ls -al ~/vm
drwx------. 7 e500 e500      4096 24. Dez 10:02 .
drwxr-xr-x. 6 e500 e500      4096 18. Dez 20:31 ..
-rw-r--r--. 1 e500 e500 136839168 24. Dez 10:03 hdd.qcow2
-rw-r--r--. 1 e500 e500   4360017 24. Dez 09:46 openwrt-mpc85xx-generic-zImage</pre>

</p>

<p>
Now the VM is ready to start.
</p>

<p>
<pre class="code">qemu-system-ppc -kernel ~/vm/openwrt-mpc85xx-generic-zImage \
                -nographic -append &quot;console=ttyS0&quot; -m 1024 -M ppce500 \
                -drive file=~/vm/hdd.qcow2,if=virtio</pre>

</p>

</div>

<h2 class="sectionedit21" id="other_information_resources">Other Information Resources</h2>
<div class="level2">

<p>
<a href="https://forum.openwrt.org/viewtopic.php?id=42062&amp;p=22" class="urlextern" title="https://forum.openwrt.org/viewtopic.php?id=42062&amp;p=22"  rel="nofollow">OpenWRT Forum Thread &quot;Developing Support for TPLINK WDR4900&quot;</a>
</p>

<p>
<a href="https://wikidevi.com/wiki/TP-LINK_TL-WDR4900_v1" class="urlextern" title="https://wikidevi.com/wiki/TP-LINK_TL-WDR4900_v1"  rel="nofollow">Hardware Information at wikidevi (v1 International version)</a>
</p>

<p>
<a href="https://wikidevi.com/wiki/TP-LINK_TL-WDR4900_v2" class="urlextern" title="https://wikidevi.com/wiki/TP-LINK_TL-WDR4900_v2"  rel="nofollow">Hardware Information at wikidevi (v2 PRC-only version)</a>
</p>

</div>

                    <!-- wikipage stop -->
                                    </div>

                <div class="docInfo"><bdi>toh/tp-link/tl-wdr4900.txt</bdi> · Last modified: 2015/05/06 15:10 by <bdi>theoradicus</bdi></div>

                            </div></div><!-- /content -->

            <hr class="a11y" />

            <!-- PAGE ACTIONS -->
            <div id="dokuwiki__pagetools">
                <h3 class="a11y">Page Tools</h3>
                <div class="tools">
                    <ul>
                        <li><a href="tl-wdr4900?do=edit"  class="action source" accesskey="v" rel="nofollow" title="Show pagesource [V]"><span>Show pagesource</span></a></li><li><a href="tl-wdr4900?do=revisions"  class="action revs" accesskey="o" rel="nofollow" title="Old revisions [O]"><span>Old revisions</span></a></li><li><a href="tl-wdr4900?do=backlink"  class="action backlink" rel="nofollow" title="Backlinks"><span>Backlinks</span></a></li><li><a href="tl-wdr4900#dokuwiki__top"  class="action top" accesskey="t" rel="nofollow" title="Back to top [T]"><span>Back to top</span></a></li>                    </ul>
                </div>
            </div>
        </div><!-- /wrapper -->

        
<!-- ********** FOOTER ********** -->
<div id="dokuwiki__footer"><div class="pad">
    <div class="license">Except where otherwise noted, content on this wiki is licensed under the following license: <bdi><a href="http://creativecommons.org/licenses/by-nc-sa/3.0/" rel="license" class="urlextern">CC Attribution-Noncommercial-Share Alike 3.0 Unported</a></bdi></div>
    <div class="buttons">
        <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/" rel="license"><img src="../../lib/images/license/button/cc-by-nc-sa.png" alt="CC Attribution-Noncommercial-Share Alike 3.0 Unported" /></a>        <a href="http://www.dokuwiki.org/donate" title="Donate" ><img
            src="../../lib/tpl/openwrt/images/button-donate.gif" width="80" height="15" alt="Donate" /></a>
        <a href="http://www.php.net" title="Powered by PHP" ><img
            src="../../lib/tpl/openwrt/images/button-php.gif" width="80" height="15" alt="Powered by PHP" /></a>
        <a href="http://validator.w3.org/check/referer" title="Valid HTML5" ><img
            src="../../lib/tpl/openwrt/images/button-html5.png" width="80" height="15" alt="Valid HTML5" /></a>
        <a href="http://jigsaw.w3.org/css-validator/check/referer?profile=css3" title="Valid CSS" ><img
            src="../../lib/tpl/openwrt/images/button-css.png" width="80" height="15" alt="Valid CSS" /></a>
        <a href="http://dokuwiki.org/" title="Driven by DokuWiki" ><img
            src="../../lib/tpl/openwrt/images/button-dw.png" width="80" height="15" alt="Driven by DokuWiki" /></a>
    </div>
</div></div><!-- /footer -->

    </div></div><!-- /site -->

    <div class="no"><img src="../../lib/exe/indexer.php?id=toh%253Atp-link%253Atl-wdr4900&amp;1432271792" width="2" height="1" alt="" /></div>
    <div id="screen__mode" class="no"></div>    <!--[if ( lte IE 7 | IE 8 ) ]></div><![endif]-->
</body>
</html>
