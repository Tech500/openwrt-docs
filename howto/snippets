<!DOCTYPE html>
<html lang="en" dir="ltr" class="no-js">
<head>
    <meta charset="utf-8" />
    <title>Snippets [OpenWrt Wiki]</title>
    <script>(function(H){H.className=H.className.replace(/\bno-js\b/,'js')})(document.documentElement)</script>
    <meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="keywords" content="doc,howto,snippets"/>
<link rel="search" type="application/opensearchdescription+xml" href="../../lib/exe/opensearch.php" title="OpenWrt Wiki"/>
<link rel="start" href="../../index.html"/>
<link rel="contents" href="snippets?do=index" title="Sitemap"/>
<link rel="alternate" type="application/rss+xml" title="Recent changes" href="../../feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Current namespace" href="../../feed.php?mode=list&amp;ns=doc:howto"/>
<link rel="alternate" type="text/html" title="Plain HTML" href="../../_export/xhtml/doc/howto/snippets"/>
<link rel="alternate" type="text/plain" title="Wiki Markup" href="../../_export/raw/doc/howto/snippets"/>
<link rel="canonical" href="snippets"/>
<link rel="stylesheet" type="text/css" href="../../lib/exe/css.php?t=openwrt&amp;tseed=6f44f363dc87908d905dc56ff3acbfc4"/>
<script type="text/javascript">/*<![CDATA[*/var NS='doc:howto';var JSINFO = {"id":"doc:howto:snippets","namespace":"doc:howto"};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="../../lib/exe/js.php?tseed=6f44f363dc87908d905dc56ff3acbfc4"></script>
<script type="text/javascript" charset="utf-8">/*<![CDATA[*/jQuery(function(){
	for ( i=0; i < document.forms.length; i++ ) {
		if (document.forms[i].method == 'post') {
			var myElement = document.createElement('input');
			myElement.setAttribute('type', 'hidden');
			myElement.name = 'bb2_screener_';
			myElement.value = '1432267154 166.182.3.14';
			document.forms[i].appendChild(myElement);
		}
	}
});
/*!]]>*/</script>
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <link rel="shortcut icon" href="../../lib/tpl/openwrt/images/favicon.ico" />
<link rel="apple-touch-icon" href="../../lib/tpl/openwrt/images/apple-touch-icon.png" />
    </head>

<body>
    <!--[if lte IE 7 ]><div id="IE7"><![endif]--><!--[if IE 8 ]><div id="IE8"><![endif]-->
    <div id="dokuwiki__site"><div id="dokuwiki__top" class="site dokuwiki mode_show tpl_openwrt     ">

        
<!-- ********** HEADER ********** -->
<div id="dokuwiki__header"><div class="pad group">

    
    <div class="headings group">
        <ul class="a11y skip">
            <li><a href="snippets#dokuwiki__content">skip to content</a></li>
        </ul>

        <h1><a href="../../start"  accesskey="h" title="[H]"><img src="../../lib/tpl/openwrt/images/logo.png" width="386" height="98" alt="" /> <span>OpenWrt Wiki</span></a></h1>
            </div>

    <div class="tools group">
        <!-- USER TOOLS -->
                    <div id="dokuwiki__usertools">
                <h3 class="a11y">User Tools</h3>
                <ul>
                    <li><a href="snippets?do=register"  class="action register" rel="nofollow" title="Register">Register</a></li><li><a href="snippets?do=login&amp;sectok=382740b13d95f946eed36caa57076b4a"  class="action login" rel="nofollow" title="Login">Login</a></li>                </ul>
            </div>
        
        <!-- SITE TOOLS -->
        <div id="dokuwiki__sitetools">
            <h3 class="a11y">Site Tools</h3>
            <form action="../../start" accept-charset="utf-8" class="search" id="dw__search" method="get" role="search"><div class="no"><input type="hidden" name="do" value="search" /><input type="text" id="qsearch__in" accesskey="f" name="id" class="edit" title="[F]" /><input type="submit" value="Search" class="button" title="Search" /><div id="qsearch__out" class="ajax_qsearch JSpopup"></div></div></form>            <div class="mobileTools">
                <form action="../../doku.php" method="get" accept-charset="utf-8"><div class="no"><input type="hidden" name="id" value="doc:howto:snippets" /><select name="do" class="edit quickselect" title="Tools"><option value="">Tools</option><optgroup label="Page Tools"><option value="edit">Show pagesource</option><option value="revisions">Old revisions</option><option value="backlink">Backlinks</option></optgroup><optgroup label="Site Tools"><option value="recent">Recent changes</option><option value="media">Media Manager</option><option value="index">Sitemap</option></optgroup><optgroup label="User Tools"><option value="login">Login</option><option value="register">Register</option></optgroup></select><input type="submit" value="&gt;" /></div></form>            </div>
            <ul>
                <li><a href="snippets?do=recent"  class="action recent" accesskey="r" rel="nofollow" title="Recent changes [R]">Recent changes</a></li><li><a href="snippets?do=media&amp;ns=doc%253Ahowto"  class="action media" rel="nofollow" title="Media Manager">Media Manager</a></li><li><a href="snippets?do=index"  class="action index" accesskey="x" rel="nofollow" title="Sitemap [X]">Sitemap</a></li>            </ul>
        </div>

    </div>

    <!-- BREADCRUMBS -->
            <div class="breadcrumbs">
                            <div class="youarehere"><span class="bchead">You are here: </span><span class="home"><bdi><a href="../../start" class="wikilink1" title="start">OpenWrt Wiki</a></bdi></span> » <bdi><a href="../start" class="wikilink1" title="doc:start">Documentation</a></bdi> » <bdi><a href="start" class="wikilink1" title="doc:howto:start">HOWTOs</a></bdi> » <bdi><span class="curid"><a href="snippets" class="wikilink1" title="doc:howto:snippets">Snippets</a></span></bdi></div>
                                    <div class="plugin_multilingual">
        <ul>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/cz/doc/howto/snippets" class="media" title="cz:doc:howto:snippets"><img src="../../lib/exe/fetch.php?cache=&amp;tok=aff589&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fcz.gif" class="media" title="Čeština (Czech)" alt="Čeština (Czech)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/de/doc/howto/snippets" class="media" title="de:doc:howto:snippets"><img src="../../lib/exe/fetch.php?cache=&amp;tok=e24010&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fde.gif" class="media" title="Deutsch (German)" alt="Deutsch (German)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <span class="curid"><a href="snippets" class="media" title="doc:howto:snippets"><img src="../../lib/exe/fetch.php?cache=&amp;tok=2a37ae&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fgb.gif" class="media" title="English" alt="English" /></a></span>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/es/doc/howto/snippets" class="media" title="es:doc:howto:snippets"><img src="../../lib/exe/fetch.php?cache=&amp;tok=46c004&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fmx.gif" class="media" title="Español (Spanish, Mexico)" alt="Español (Spanish, Mexico)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/fr/doc/howto/snippets" class="media" title="fr:doc:howto:snippets"><img src="../../lib/exe/fetch.php?cache=&amp;tok=a5beba&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Ffr.gif" class="media" title="Français (French)" alt="Français (French)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/hu/doc/howto/snippets" class="media" title="hu:doc:howto:snippets"><img src="../../lib/exe/fetch.php?cache=&amp;tok=6b5470&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fhu.gif" class="media" title="Magyar (Hungarian)" alt="Magyar (Hungarian)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/jp/doc/howto/snippets" class="media" title="jp:doc:howto:snippets"><img src="../../lib/exe/fetch.php?cache=&amp;tok=f999fc&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fjp.gif" class="media" title="日本語 (Japanese)" alt="日本語 (Japanese)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/pl/doc/howto/snippets" class="media" title="pl:doc:howto:snippets"><img src="../../lib/exe/fetch.php?cache=&amp;tok=c805c0&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fpl.gif" class="media" title="Poliski (Polish)" alt="Poliski (Polish)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/pt-br/doc/howto/snippets" class="media" title="pt-br:doc:howto:snippets"><img src="../../lib/exe/fetch.php?cache=&amp;tok=13127d&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fbr.gif" class="media" title="Português brasileiro (Portuguese, Brasil)" alt="Português brasileiro (Portuguese, Brasil)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/ru/doc/howto/snippets" class="media" title="ru:doc:howto:snippets"><img src="../../lib/exe/fetch.php?cache=&amp;tok=66ab5e&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fru.gif" class="media" title="Русский (Russsian)" alt="Русский (Russsian)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/tr/doc/howto/snippets" class="media" title="tr:doc:howto:snippets"><img src="../../lib/exe/fetch.php?cache=&amp;tok=f4beed&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Ftr.gif" class="media" title="Tϋrkçe (Turkish)" alt="Tϋrkçe (Turkish)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/zh-cn/doc/howto/snippets" class="media" title="zh-cn:doc:howto:snippets"><img src="../../lib/exe/fetch.php?cache=&amp;tok=93625a&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fzh-cn.gif" class="media" title="官話/官话 (Chinese)" alt="官話/官话 (Chinese)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/zh-tw/doc/howto/snippets" class="media" title="zh-tw:doc:howto:snippets"><img src="../../lib/exe/fetch.php?cache=&amp;tok=b56198&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fzh-tw.gif" class="media" title="臺灣華語 (Taiwanese)" alt="臺灣華語 (Taiwanese)" /></a>
              </div>
            </div>
          </li>
        </ul>
      </div>
        </div>
    
    
    <hr class="a11y" />
</div></div><!-- /header -->

        <div class="wrapper group">

            
            <!-- ********** CONTENT ********** -->
            <div id="dokuwiki__content"><div class="pad group">

                <div class="pageId"><span>doc:howto:snippets</span></div>

                <div class="page group">
                                                            <!-- wikipage start -->
                    <!-- TOC START -->
<div id="dw__toc">
<h3 class="toggle">Table of Contents</h3>
<div>

<ul class="toc">
<li class="level1"><div class="li"><a href="snippets#system">System</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="snippets#generate_100_cpu_load">Generate 100% CPU load</a></div></li>
<li class="level2"><div class="li"><a href="snippets#show_command_line_with_parameters_of_a_process">Show command line with parameters of a process</a></div></li>
<li class="level2"><div class="li"><a href="snippets#prompt">Prompt</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="snippets#colors">Colors</a></div></li>
<li class="level3"><div class="li"><a href="snippets#screen_session">Screen session</a></div></li>
<li class="level3"><div class="li"><a href="snippets#red_background_if_last_command_failed">Red background if last command failed</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="snippets#paste_file_on_web_from_cli">Paste file on web from CLI</a></div></li>
<li class="level2"><div class="li"><a href="snippets#get_bridge_status">Get bridge status</a></div></li>
</ul>
</li>
<li class="level1"><div class="li"><a href="snippets#wireless">Wireless</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="snippets#toggle_button_for_wifi">Toggle button for WiFi</a></div></li>
<li class="level2"><div class="li"><a href="snippets#unlock_all_wifi_regulatory_domains_on_atheros">Unlock all WiFi regulatory domains on Atheros</a></div></li>
</ul>
</li>
<li class="level1"><div class="li"><a href="snippets#packages">Packages</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="snippets#make_local_copy_of_packages">Make local copy of packages</a></div></li>
<li class="level2"><div class="li"><a href="snippets#elliptic_curves_in_openssh">Elliptic curves in OpenSSH</a></div></li>
<li class="level2"><div class="li"><a href="snippets#reinstalling_packages_after_firmware_upgrade">Reinstalling Packages after Firmware Upgrade</a></div></li>
</ul>
</li>
<li class="level1"><div class="li"><a href="snippets#usb">USB</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="snippets#benchmark_your_drive">Benchmark your drive</a></div></li>
</ul>
</li>
<li class="level1"><div class="li"><a href="snippets#led">LED</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="snippets#ipv6_activity_led">IPv6 activity LED</a></div></li>
</ul>
</li>
<li class="level1"><div class="li"><a href="snippets#banner_customization">Banner customization</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="snippets#show_screen_sessions">Show screen sessions</a></div></li>
<li class="level2"><div class="li"><a href="snippets#show_available_entropy">Show available entropy</a></div></li>
</ul></li>
</ul>
</div>
</div>
<!-- TOC END -->

<h1 class="sectionedit1" id="snippets">Snippets</h1>
<div class="level1">

<p>
On this page you will find script and config snippets that didn&#039;t fit in other articles. Some snippets have nature of tweaks or one-line HOWTOs, while others are just fun to run.
</p>

</div>

<h2 class="sectionedit2" id="system">System</h2>
<div class="level2">

</div>

<h3 class="sectionedit3" id="generate_100_cpu_load">Generate 100% CPU load</h3>
<div class="level3">

<p>
There is bunch of reasons why you would like to stress your CPU, one of the less serious is to play with <a href="../uci/system#heartbeat" class="wikilink1" title="doc:uci:system">heartbeat trigger</a>.
<pre class="code bash"><span class="kw2">cat</span> <span class="sy0">/</span>dev<span class="sy0">/</span>urandom <span class="sy0">|</span> <span class="kw2">gzip</span> <span class="sy0">&gt;</span> <span class="sy0">/</span>dev<span class="sy0">/</span>null</pre>

Note: <em>This will compress infinite stream of random bits and discard them. The compress level can&#039;t be changed, so you may want to run more than one instance of the script to get your average CPU load high.</em>
</p>

</div>

<h3 class="sectionedit4" id="show_command_line_with_parameters_of_a_process">Show command line with parameters of a process</h3>
<div class="level3">

<p>
Traditionally you would use <code>top</code> or <code>ps</code> command to get parameters of running processes. However if the command line is too long <a href="http://www.busybox.net/" class="urlextern" title="http://www.busybox.net/"  rel="nofollow">busybox&#039;s</a> version of those commands will truncate it to fit your terminal window.
<pre class="code bash"><span class="kw2">ps</span> <span class="kw2">w</span></pre>

or
<pre class="code bash"><span class="kw2">cat</span> <span class="sy0">/</span>proc<span class="sy0">/&lt;</span>PID<span class="sy0">&gt;/</span>cmdline</pre>

Note: <em>Substitute &lt;PID&gt; with the <a href="http://en.wikipedia.org/wiki/Process_identifier" class="interwiki iw_wp" title="http://en.wikipedia.org/wiki/Process_identifier">process identifier</a> of your process.</em>
</p>

</div>

<h3 class="sectionedit5" id="prompt">Prompt</h3>
<div class="level3">

</div>

<h4 id="colors">Colors</h4>
<div class="level4">

<p>
Edit <code>PS1</code> variable in <code>/etc/profile</code> file:
</p>
<pre class="code">export PS1=&#039;\[\e[1;31m\]\u@\h:\w\$ \[\e[0m\]&#039;</pre>

<p>
<em>This gives you normal text and background color, but red prompt, which reminds you that you are root. Other users (if exist) could get green prompt.</em> <a href="https://wiki.archlinux.org/index.php/Color_Bash_Prompt#List_of_colors_for_prompt_and_Bash" class="urlextern" title="https://wiki.archlinux.org/index.php/Color_Bash_Prompt#List_of_colors_for_prompt_and_Bash"  rel="nofollow">Color codes</a>.
</p>

</div>

<h4 id="screen_session">Screen session</h4>
<div class="level4">

<p>
It may be useful to display name of <code>screen</code> session if you are in one. <em>Tip: mix some colors in.</em> In the example the <code>screen</code> session has name <code>pts-0</code>:
</p>
<pre class="code">root@tsunami/pts-0:~# </pre>

<p>
<pre class="code bash"><span class="kw3">local</span> <span class="re2">SCREEN_SESSION_NAME</span>=$<span class="br0">&#40;</span><span class="kw2">screen</span> <span class="re5">-ls</span> <span class="sy0">|</span> <span class="kw2">sed</span> <span class="re5">-n</span> <span class="st_h">'s|[^a-z]*[0-9][0-9]*\.\([a-zA-Z][a-zA-Z0-9-]*\).*Attached.*|/\1|p'</span><span class="br0">&#41;</span>
<span class="kw3">export</span> <span class="re2">PS1</span>=<span class="st0">&quot;\u@\h<span class="es3">${SCREEN_SESSION_NAME}</span>:\w\<span class="es1">\$</span> &quot;</span></pre>

</p>

</div>

<h4 id="red_background_if_last_command_failed">Red background if last command failed</h4>
<div class="level4">

<p>
Changes background color of prompt to red, when last command failed, i.e. its exit code is not equal to zero.
</p>

<p>
<pre class="code bash"><span class="kw3">export</span> <span class="re2">PS1</span>=<span class="st0">&quot;<span class="es1">\$</span>([ <span class="es1">\$</span>? -ne 0 ] &amp;&amp; echo \\\[\\\e[41m\\\])\u@\h:\w\<span class="es1">\$</span>\[\e[0m\] &quot;</span></pre>

</p>

</div>

<h3 class="sectionedit6" id="paste_file_on_web_from_cli">Paste file on web from CLI</h3>
<div class="level3">
<pre class="code">cat /etc/config/some.conf | nc paste.dyndns.org 1234</pre>

</div>

<h3 class="sectionedit7" id="get_bridge_status">Get bridge status</h3>
<div class="level3">

<p>
<pre class="code bash">devstatus br-lan</pre>

</p>

<p>
<pre class="code bash"><span class="kw2">cat</span> <span class="sy0">/</span>sbin<span class="sy0">/</span>devstatus
<span class="co0">#!/bin/sh</span>
. <span class="sy0">/</span>usr<span class="sy0">/</span>share<span class="sy0">/</span>libubox<span class="sy0">/</span>jshn.sh
<span class="re2">DEVICE</span>=<span class="st0">&quot;$1&quot;</span>
&nbsp;
<span class="br0">&#91;</span> <span class="re5">-n</span> <span class="st0">&quot;<span class="es2">$DEVICE</span>&quot;</span> <span class="br0">&#93;</span> <span class="sy0">||</span> <span class="br0">&#123;</span>
	<span class="kw3">echo</span> <span class="st0">&quot;Usage: $0 &lt;device&gt;&quot;</span>
	<span class="kw3">exit</span> <span class="nu0">1</span>
<span class="br0">&#125;</span>
&nbsp;
json_init
json_add_string name <span class="st0">&quot;<span class="es2">$DEVICE</span>&quot;</span>
ubus call network.device status <span class="st0">&quot;<span class="es4">$(json_dump)</span>&quot;</span></pre>

</p>

</div>

<h2 class="sectionedit8" id="wireless">Wireless</h2>
<div class="level2">

</div>

<h3 class="sectionedit9" id="toggle_button_for_wifi">Toggle button for WiFi</h3>
<div class="level3">
<pre class="code">[ -s /var/state/wireless ] &amp;&amp; wifi down || wifi up</pre>

</div>

<h3 class="sectionedit10" id="unlock_all_wifi_regulatory_domains_on_atheros">Unlock all WiFi regulatory domains on Atheros</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"> <a href="obtain.firmware.compile" class="urlextern" title="http://wiki.openwrt.org/doc/howto/build"  rel="nofollow">build your own image</a> and set <code>CONFIG_ATH_USER_REGD</code> flag.</div>
</li>
<li class="level1"><div class="li"> see the whole <a href="http://git.kernel.org/cgit/linux/kernel/git/linville/wireless-regdb.git/tree/db.txt?id=HEAD" class="urlextern" title="http://git.kernel.org/cgit/linux/kernel/git/linville/wireless-regdb.git/tree/db.txt?id=HEAD"  rel="nofollow">regulatory database</a> to find out what regulations apply.</div>
</li>
</ul>

</div>

<h2 class="sectionedit11" id="packages">Packages</h2>
<div class="level2">

</div>

<h3 class="sectionedit12" id="make_local_copy_of_packages">Make local copy of packages</h3>
<div class="level3">

<p>
If you use trunk version it may be useful to make local copy of packages, because new trunk version may prevent you to install kernel-related packages from official sources.
</p>
<pre class="code">wget -r -np http://downloads.openwrt.org/snapshots/trunk/ar71xx/packages/</pre>

<p>
<em>Assuming your architecture is <code>ar71xx</code>. This may require around 300 <abbr title="Megabyte">MB</abbr> of free disk space.</em>
</p>

</div>

<h3 class="sectionedit13" id="elliptic_curves_in_openssh">Elliptic curves in OpenSSH</h3>
<div class="level3">

<p>
<a href="http://en.wikipedia.org/wiki/Elliptic_curve_cryptography" class="interwiki iw_wp" title="http://en.wikipedia.org/wiki/Elliptic_curve_cryptography">ECC</a> is especially favourable on low performance system like mobile phones or routers. For example, 15360 bit <a href="http://en.wikipedia.org/wiki/RSA_(algorithm)" class="interwiki iw_wp" title="http://en.wikipedia.org/wiki/RSA_(algorithm)">RSA</a> key took 9.1 seconds to login and <a href="http://www.keylength.com/en/4/" class="urlextern" title="http://www.keylength.com/en/4/"  rel="nofollow">equally strong</a> (actually little bit stronger) 521 bit <a href="http://en.wikipedia.org/wiki/ECDSA" class="interwiki iw_wp" title="http://en.wikipedia.org/wiki/ECDSA">ECDSA</a> key took only 1.7 seconds to login. However the difference won&#039;t be really noticeble with shorter keys. To get it working, you need to:
</p>
<ol>
<li class="level1"><div class="li"> compile <code>libopenssl</code> without <code>NO-EC</code> option</div>
</li>
<li class="level1"><div class="li"> compile <code>openssh-server</code> and <code>openssh-keygen</code> with the new <code>libopenssl</code> in <code>build_dir</code></div>
</li>
<li class="level1"><div class="li"> <pre class="code bash"><span class="kw2">ssh-keygen</span> <span class="re5">-t</span> ecdsa <span class="re5">-b</span> <span class="nu0">521</span></pre>
</div>
</li>
</ol>

</div>

<h3 class="sectionedit14" id="reinstalling_packages_after_firmware_upgrade">Reinstalling Packages after Firmware Upgrade</h3>
<div class="level3">

<p>
If you save the list of installed packages before a firmware upgrade, you can reinstall all packages that are not part of the firwmare with the script suggested in <a href="https://forum.openwrt.org/viewtopic.php?id=42739" class="urlextern" title="https://forum.openwrt.org/viewtopic.php?id=42739"  rel="nofollow">this thread</a>.
</p>

</div>

<h2 class="sectionedit15" id="usb">USB</h2>
<div class="level2">

</div>

<h3 class="sectionedit16" id="benchmark_your_drive">Benchmark your drive</h3>
<div class="level3">

<p>
Firstly, you will need <code>hdparm</code> program. Then locate your attached drive in <code>/dev</code> directory - typically <code>/dev/sda1</code> or <code>/dev/sda2</code> etc.
<pre class="code bash">opkg update <span class="sy0">&amp;&amp;</span> opkg <span class="kw2">install</span> hdparm
hdparm <span class="re5">-t</span> <span class="sy0">/</span>dev<span class="sy0">/</span>sda1</pre>

</p>

<p>
See also <a href="../../inbox/benchmark.usb" class="wikilink1" title="inbox:benchmark.usb">USB Benchmarks</a> and <a href="../hardware/performance" class="wikilink1" title="doc:hardware:performance">Filesystems performance</a> page.
</p>

</div>

<h2 class="sectionedit17" id="led">LED</h2>
<div class="level2">

</div>

<h3 class="sectionedit18" id="ipv6_activity_led">IPv6 activity LED</h3>
<div class="level3">

<p>
Flashes on activity in <a href="http://tunnelbroker.net" class="urlextern" title="http://tunnelbroker.net"  rel="nofollow">Hurricane Electric</a> <a href="../uci/network#staticipv6-in-ipv4tunnel" class="wikilink1" title="doc:uci:network">6in4 tunnel</a>. Taken from <code>/etc/config/system</code> file:
</p>
<div class="table sectionedit19"><table class="inline">
	<tr class="row0">
		<td class="col0"><code>config &#039;led&#039; &#039;6in4_led&#039;
        option &#039;name&#039; &#039;6in4&#039;
        option &#039;sysfs&#039; &#039;tl-wr1043nd:green:qss&#039;
        option &#039;trigger&#039; &#039;netdev&#039;
        option &#039;mode&#039; &#039;link tx rx&#039;
        option &#039;dev&#039; &#039;6in4-henet&#039;
</code></td>
	</tr>
</table></div>

<p>
Note:<em>detailed configuration is <a href="../uci/system#networkactivity" class="wikilink1" title="doc:uci:system">here</a>.</em>
</p>

</div>

<h2 class="sectionedit20" id="banner_customization">Banner customization</h2>
<div class="level2">

<p>
All edits take place in <code>/etc/profile</code> file. We place the scripts in this section below the <code>cat /etc/banner</code>.
</p>

</div>

<h3 class="sectionedit21" id="show_screen_sessions">Show screen sessions</h3>
<div class="level3">

<p>
For those who uses the <code>screen</code> command. This will print for example this:
</p>
<div class="table sectionedit22"><table class="inline">
	<tr class="row0">
		<td class="col0"><code>3 Screen sessions: pts-0, snort, iperf</code></td>
	</tr>
</table></div>

<p>
And the script for it:
<pre class="code bash"><span class="kw3">local</span> <span class="re2">screenlabel</span>=$<span class="br0">&#40;</span><span class="kw2">screen</span> <span class="re5">-ls</span> <span class="sy0">|</span> <span class="kw2">sed</span> <span class="re5">-n</span> <span class="st_h">'s|^\([0-9][0-9]*\) Socket.*| \1 Screen sessions: |p'</span><span class="br0">&#41;</span>
<span class="kw2">screen</span> <span class="re5">-ls</span> <span class="sy0">|</span> <span class="kw2">sed</span> <span class="re5">-n</span> <span class="st_h">'s|[^a-z]*[0-9][0-9]*\.\([a-zA-Z][a-zA-Z0-9-]*\).*|\1|p'</span> <span class="sy0">|</span> <span class="kw2">sed</span> <span class="re5">-e</span> <span class="st0">&quot;s|^|<span class="es3">${screenlabel}</span>|&quot;</span> <span class="re5">-e</span> :a <span class="re5">-e</span> N <span class="re5">-e</span> <span class="st_h">'s|\n|, |'</span> <span class="re5">-e</span> ta</pre>

</p>

<p>
<em>Note: <code>screenlabel</code> variable just contain number of sessoins and static text, so if you are ok with just list of screen sessions you can skip it and make it little bit more clear. Second line first get names of sessions, then add <code>screenlabel</code> variable in front of it and then put it all in one line.</em>
</p>

</div>

<h3 class="sectionedit23" id="show_available_entropy">Show available entropy</h3>
<div class="level3">

<p>
Less useful script, but anyway ;)
</p>
<div class="table sectionedit24"><table class="inline">
	<tr class="row0">
		<td class="col0"><code>Entropy: 143/4096</code></td>
	</tr>
</table></div>

<p>
<pre class="code bash"><span class="kw3">echo</span> <span class="st0">&quot; Entropy:&quot;</span> $<span class="br0">&#40;</span><span class="kw2">cat</span> <span class="sy0">/</span>proc<span class="sy0">/</span>sys<span class="sy0">/</span>kernel<span class="sy0">/</span>random<span class="sy0">/</span>entropy_avail<span class="br0">&#41;</span><span class="sy0">/</span>$<span class="br0">&#40;</span><span class="kw2">cat</span> <span class="sy0">/</span>proc<span class="sy0">/</span>sys<span class="sy0">/</span>kernel<span class="sy0">/</span>random<span class="sy0">/</span>poolsize<span class="br0">&#41;</span></pre>

</p>

</div>

                    <!-- wikipage stop -->
                                    </div>

                <div class="docInfo"><bdi>doc/howto/snippets.txt</bdi> · Last modified: 2013/09/01 20:16 by <bdi>70d7a4f46</bdi></div>

                            </div></div><!-- /content -->

            <hr class="a11y" />

            <!-- PAGE ACTIONS -->
            <div id="dokuwiki__pagetools">
                <h3 class="a11y">Page Tools</h3>
                <div class="tools">
                    <ul>
                        <li><a href="snippets?do=edit"  class="action source" accesskey="v" rel="nofollow" title="Show pagesource [V]"><span>Show pagesource</span></a></li><li><a href="snippets?do=revisions"  class="action revs" accesskey="o" rel="nofollow" title="Old revisions [O]"><span>Old revisions</span></a></li><li><a href="snippets?do=backlink"  class="action backlink" rel="nofollow" title="Backlinks"><span>Backlinks</span></a></li><li><a href="snippets#dokuwiki__top"  class="action top" accesskey="t" rel="nofollow" title="Back to top [T]"><span>Back to top</span></a></li>                    </ul>
                </div>
            </div>
        </div><!-- /wrapper -->

        
<!-- ********** FOOTER ********** -->
<div id="dokuwiki__footer"><div class="pad">
    <div class="license">Except where otherwise noted, content on this wiki is licensed under the following license: <bdi><a href="http://creativecommons.org/licenses/by-nc-sa/3.0/" rel="license" class="urlextern">CC Attribution-Noncommercial-Share Alike 3.0 Unported</a></bdi></div>
    <div class="buttons">
        <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/" rel="license"><img src="../../lib/images/license/button/cc-by-nc-sa.png" alt="CC Attribution-Noncommercial-Share Alike 3.0 Unported" /></a>        <a href="http://www.dokuwiki.org/donate" title="Donate" ><img
            src="../../lib/tpl/openwrt/images/button-donate.gif" width="80" height="15" alt="Donate" /></a>
        <a href="http://www.php.net" title="Powered by PHP" ><img
            src="../../lib/tpl/openwrt/images/button-php.gif" width="80" height="15" alt="Powered by PHP" /></a>
        <a href="http://validator.w3.org/check/referer" title="Valid HTML5" ><img
            src="../../lib/tpl/openwrt/images/button-html5.png" width="80" height="15" alt="Valid HTML5" /></a>
        <a href="http://jigsaw.w3.org/css-validator/check/referer?profile=css3" title="Valid CSS" ><img
            src="../../lib/tpl/openwrt/images/button-css.png" width="80" height="15" alt="Valid CSS" /></a>
        <a href="http://dokuwiki.org/" title="Driven by DokuWiki" ><img
            src="../../lib/tpl/openwrt/images/button-dw.png" width="80" height="15" alt="Driven by DokuWiki" /></a>
    </div>
</div></div><!-- /footer -->

    </div></div><!-- /site -->

    <div class="no"><img src="../../lib/exe/indexer.php?id=doc%253Ahowto%253Asnippets&amp;1432267154" width="2" height="1" alt="" /></div>
    <div id="screen__mode" class="no"></div>    <!--[if ( lte IE 7 | IE 8 ) ]></div><![endif]-->
</body>
</html>
