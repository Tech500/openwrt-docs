<!DOCTYPE html>
<html lang="en" dir="ltr" class="no-js">
<head>
    <meta charset="utf-8" />
    <title>IPsec Basics [OpenWrt Wiki]</title>
    <script>(function(H){H.className=H.className.replace(/\bno-js\b/,'js')})(document.documentElement)</script>
    <meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="keywords" content="crypto"/>
<link rel="search" type="application/opensearchdescription+xml" href="../../lib/exe/opensearch.php" title="OpenWrt Wiki"/>
<link rel="start" href="../../index.html"/>
<link rel="contents" href="vpn.ipsec.basics?do=index" title="Sitemap"/>
<link rel="alternate" type="application/rss+xml" title="Recent changes" href="../../feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Current namespace" href="../../feed.php?mode=list&amp;ns=doc:howto"/>
<link rel="alternate" type="text/html" title="Plain HTML" href="../../_export/xhtml/doc/howto/vpn.ipsec.basics"/>
<link rel="alternate" type="text/plain" title="Wiki Markup" href="../../_export/raw/doc/howto/vpn.ipsec.basics"/>
<link rel="canonical" href="vpn.ipsec.basics"/>
<link rel="stylesheet" type="text/css" href="../../lib/exe/css.php?t=openwrt&amp;tseed=6f44f363dc87908d905dc56ff3acbfc4"/>
<script type="text/javascript">/*<![CDATA[*/var NS='doc:howto';var JSINFO = {"id":"doc:howto:vpn.ipsec.basics","namespace":"doc:howto"};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="../../lib/exe/js.php?tseed=6f44f363dc87908d905dc56ff3acbfc4"></script>
<script type="text/javascript" charset="utf-8">/*<![CDATA[*/jQuery(function(){
	for ( i=0; i < document.forms.length; i++ ) {
		if (document.forms[i].method == 'post') {
			var myElement = document.createElement('input');
			myElement.setAttribute('type', 'hidden');
			myElement.name = 'bb2_screener_';
			myElement.value = '1432268131 166.182.3.13';
			document.forms[i].appendChild(myElement);
		}
	}
});
/*!]]>*/</script>
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <link rel="shortcut icon" href="../../lib/tpl/openwrt/images/favicon.ico" />
<link rel="apple-touch-icon" href="../../lib/tpl/openwrt/images/apple-touch-icon.png" />
    </head>

<body>
    <!--[if lte IE 7 ]><div id="IE7"><![endif]--><!--[if IE 8 ]><div id="IE8"><![endif]-->
    <div id="dokuwiki__site"><div id="dokuwiki__top" class="site dokuwiki mode_show tpl_openwrt     ">

        
<!-- ********** HEADER ********** -->
<div id="dokuwiki__header"><div class="pad group">

    
    <div class="headings group">
        <ul class="a11y skip">
            <li><a href="vpn.ipsec.basics#dokuwiki__content">skip to content</a></li>
        </ul>

        <h1><a href="../../start"  accesskey="h" title="[H]"><img src="../../lib/tpl/openwrt/images/logo.png" width="386" height="98" alt="" /> <span>OpenWrt Wiki</span></a></h1>
            </div>

    <div class="tools group">
        <!-- USER TOOLS -->
                    <div id="dokuwiki__usertools">
                <h3 class="a11y">User Tools</h3>
                <ul>
                    <li><a href="vpn.ipsec.basics?do=register"  class="action register" rel="nofollow" title="Register">Register</a></li><li><a href="vpn.ipsec.basics?do=login&amp;sectok=382740b13d95f946eed36caa57076b4a"  class="action login" rel="nofollow" title="Login">Login</a></li>                </ul>
            </div>
        
        <!-- SITE TOOLS -->
        <div id="dokuwiki__sitetools">
            <h3 class="a11y">Site Tools</h3>
            <form action="../../start" accept-charset="utf-8" class="search" id="dw__search" method="get" role="search"><div class="no"><input type="hidden" name="do" value="search" /><input type="text" id="qsearch__in" accesskey="f" name="id" class="edit" title="[F]" /><input type="submit" value="Search" class="button" title="Search" /><div id="qsearch__out" class="ajax_qsearch JSpopup"></div></div></form>            <div class="mobileTools">
                <form action="../../doku.php" method="get" accept-charset="utf-8"><div class="no"><input type="hidden" name="id" value="doc:howto:vpn.ipsec.basics" /><select name="do" class="edit quickselect" title="Tools"><option value="">Tools</option><optgroup label="Page Tools"><option value="edit">Show pagesource</option><option value="revisions">Old revisions</option><option value="backlink">Backlinks</option></optgroup><optgroup label="Site Tools"><option value="recent">Recent changes</option><option value="media">Media Manager</option><option value="index">Sitemap</option></optgroup><optgroup label="User Tools"><option value="login">Login</option><option value="register">Register</option></optgroup></select><input type="submit" value="&gt;" /></div></form>            </div>
            <ul>
                <li><a href="vpn.ipsec.basics?do=recent"  class="action recent" accesskey="r" rel="nofollow" title="Recent changes [R]">Recent changes</a></li><li><a href="vpn.ipsec.basics?do=media&amp;ns=doc%253Ahowto"  class="action media" rel="nofollow" title="Media Manager">Media Manager</a></li><li><a href="vpn.ipsec.basics?do=index"  class="action index" accesskey="x" rel="nofollow" title="Sitemap [X]">Sitemap</a></li>            </ul>
        </div>

    </div>

    <!-- BREADCRUMBS -->
            <div class="breadcrumbs">
                            <div class="youarehere"><span class="bchead">You are here: </span><span class="home"><bdi><a href="../../start" class="wikilink1" title="start">OpenWrt Wiki</a></bdi></span> » <bdi><a href="../start" class="wikilink1" title="doc:start">Documentation</a></bdi> » <bdi><a href="start" class="wikilink1" title="doc:howto:start">HOWTOs</a></bdi> » <bdi><span class="curid"><a href="vpn.ipsec.basics" class="wikilink1" title="doc:howto:vpn.ipsec.basics">IPsec Basics</a></span></bdi></div>
                                    <div class="plugin_multilingual">
        <ul>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/cz/doc/howto/vpn.ipsec.basics" class="media" title="cz:doc:howto:vpn.ipsec.basics"><img src="../../lib/exe/fetch.php?cache=&amp;tok=aff589&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fcz.gif" class="media" title="Čeština (Czech)" alt="Čeština (Czech)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/de/doc/howto/vpn.ipsec.basics" class="media" title="de:doc:howto:vpn.ipsec.basics"><img src="../../lib/exe/fetch.php?cache=&amp;tok=e24010&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fde.gif" class="media" title="Deutsch (German)" alt="Deutsch (German)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <span class="curid"><a href="vpn.ipsec.basics" class="media" title="doc:howto:vpn.ipsec.basics"><img src="../../lib/exe/fetch.php?cache=&amp;tok=2a37ae&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fgb.gif" class="media" title="English" alt="English" /></a></span>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/es/doc/howto/vpn.ipsec.basics" class="media" title="es:doc:howto:vpn.ipsec.basics"><img src="../../lib/exe/fetch.php?cache=&amp;tok=46c004&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fmx.gif" class="media" title="Español (Spanish, Mexico)" alt="Español (Spanish, Mexico)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/fr/doc/howto/vpn.ipsec.basics" class="media" title="fr:doc:howto:vpn.ipsec.basics"><img src="../../lib/exe/fetch.php?cache=&amp;tok=a5beba&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Ffr.gif" class="media" title="Français (French)" alt="Français (French)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/hu/doc/howto/vpn.ipsec.basics" class="media" title="hu:doc:howto:vpn.ipsec.basics"><img src="../../lib/exe/fetch.php?cache=&amp;tok=6b5470&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fhu.gif" class="media" title="Magyar (Hungarian)" alt="Magyar (Hungarian)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/jp/doc/howto/vpn.ipsec.basics" class="media" title="jp:doc:howto:vpn.ipsec.basics"><img src="../../lib/exe/fetch.php?cache=&amp;tok=f999fc&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fjp.gif" class="media" title="日本語 (Japanese)" alt="日本語 (Japanese)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/pl/doc/howto/vpn.ipsec.basics" class="media" title="pl:doc:howto:vpn.ipsec.basics"><img src="../../lib/exe/fetch.php?cache=&amp;tok=c805c0&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fpl.gif" class="media" title="Poliski (Polish)" alt="Poliski (Polish)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/pt-br/doc/howto/vpn.ipsec.basics" class="media" title="pt-br:doc:howto:vpn.ipsec.basics"><img src="../../lib/exe/fetch.php?cache=&amp;tok=13127d&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fbr.gif" class="media" title="Português brasileiro (Portuguese, Brasil)" alt="Português brasileiro (Portuguese, Brasil)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/ru/doc/howto/vpn.ipsec.basics" class="media" title="ru:doc:howto:vpn.ipsec.basics"><img src="../../lib/exe/fetch.php?cache=&amp;tok=66ab5e&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fru.gif" class="media" title="Русский (Russsian)" alt="Русский (Russsian)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/tr/doc/howto/vpn.ipsec.basics" class="media" title="tr:doc:howto:vpn.ipsec.basics"><img src="../../lib/exe/fetch.php?cache=&amp;tok=f4beed&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Ftr.gif" class="media" title="Tϋrkçe (Turkish)" alt="Tϋrkçe (Turkish)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/zh-cn/doc/howto/vpn.ipsec.basics" class="media" title="zh-cn:doc:howto:vpn.ipsec.basics"><img src="../../lib/exe/fetch.php?cache=&amp;tok=93625a&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fzh-cn.gif" class="media" title="官話/官话 (Chinese)" alt="官話/官话 (Chinese)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/zh-tw/doc/howto/vpn.ipsec.basics" class="media" title="zh-tw:doc:howto:vpn.ipsec.basics"><img src="../../lib/exe/fetch.php?cache=&amp;tok=b56198&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fzh-tw.gif" class="media" title="臺灣華語 (Taiwanese)" alt="臺灣華語 (Taiwanese)" /></a>
              </div>
            </div>
          </li>
        </ul>
      </div>
        </div>
    
    
    <hr class="a11y" />
</div></div><!-- /header -->

        <div class="wrapper group">

            
            <!-- ********** CONTENT ********** -->
            <div id="dokuwiki__content"><div class="pad group">

                <div class="pageId"><span>doc:howto:vpn.ipsec.basics</span></div>

                <div class="page group">
                                                            <!-- wikipage start -->
                    <!-- TOC START -->
<div id="dw__toc">
<h3 class="toggle">Table of Contents</h3>
<div>

<ul class="toc">
<li class="level1"><div class="li"><a href="vpn.ipsec.basics#packages">Packages</a></div></li>
<li class="level1"><div class="li"><a href="vpn.ipsec.basics#configuration_concept">Configuration concept</a></div></li>
<li class="level1"><div class="li"><a href="vpn.ipsec.basics#ike_daemon">IKE Daemon</a></div></li>
<li class="level1"><div class="li"><a href="vpn.ipsec.basics#what_s_next">What&#039;s next</a></div></li>
<li class="level1"><div class="li"><a href="vpn.ipsec.basics#tag">Tag</a></div></li>
</ul>
</div>
</div>
<!-- TOC END -->

<h1 class="sectionedit1" id="ipsec_basics">IPsec Basics</h1>
<div class="level1">
<div class="table sectionedit2"><table class="inline">
	<tr class="row0">
		<td class="col0"> For an overview over all existing Virtual private network (VPN)-related articles in the OpenWrt wiki, please visit <a href="vpn.overview" class="wikilink1" title="doc:howto:vpn.overview">vpn.overview</a> </td>
	</tr>
</table></div>

<p>
A quick starters quide based on OpenWrt Barrier Breaker 14.07. Maybe it will save you and me time if one has to setup an IPsec VPN in the future. Hopefully it will ecourage other people to use Openwrt as an IPsec VPN router. We cannot provide a graphical user interface at the moment but at least it is a solid alternative to commercial IPsec appliances. 
</p>

</div>

<h2 class="sectionedit3" id="packages">Packages</h2>
<div class="level2">

<p>
If not already installed on your router you need the at least those packages. 
</p>
<ul>
<li class="level1"><div class="li"> strongswan-default: everything needed for IPsec tunnels </div>
</li>
<li class="level1"><div class="li"> ip: Required to make scripting easier</div>
</li>
<li class="level1"><div class="li"> iptables-mod-nat-extra: For VPN networks with <a href="vpn.ipsec.overlappingsubnets" class="wikilink1" title="doc:howto:vpn.ipsec.overlappingsubnets">overlapping IP addresses</a></div>
</li>
<li class="level1"><div class="li"> djbdns-tools: for simpler name resolving than nslookup</div>
</li>
</ul>

<p>
Altogehter those packages will eat up about some <abbr title="Megabyte">MB</abbr> of your router&#039;s flash memory. Maybe it is time for an <a href="extroot" class="wikilink1" title="doc:howto:extroot">extroot</a> installation?
</p>

</div>

<h2 class="sectionedit4" id="configuration_concept">Configuration concept</h2>
<div class="level2">

<p>
If you already worked with strongSwan you should know the different files you need to configure. They include
</p>
<ul>
<li class="level1"><div class="li"> <strong>/etc/strongswan.conf</strong>: Central configuration file </div>
</li>
<li class="level1"><div class="li"> <strong>/etc/ipsec.conf</strong>: Tunnel definitions</div>
</li>
<li class="level1"><div class="li"> <strong>/etc/ipsec.secrets</strong>: List of preshared keys</div>
</li>
<li class="level1"><div class="li"> <strong>/etc/ipsec.d</strong>: Folder for certificates</div>
</li>
</ul>

<p>
<img src="../../lib/images/smileys/icon_exclaim.gif" class="icon" alt=":!:" /> Remark! If you you want to stay with that configuration you have reached the wrong place. 
</p>

<p>
The major challenge is handling all of those files automatically with a clean integration into the OpenWrt configuration concept. To solve this we will use a hierarchical configuration process. That involves
</p>
<ul>
<li class="level1"><div class="li"> <strong>/etc/config/ipsec</strong>: The OpenWrt configuration file for strongSwan</div>
</li>
<li class="level1"><div class="li"> <strong>/etc/init.d/ipsec</strong>: The Strongswan start script. It will generate the required configuration files for strongSwan</div>
</li>
<li class="level1"><div class="li"> <strong>/var/ipsec.conf</strong>: The generated Strongswan config</div>
</li>
<li class="level1"><div class="li"> <strong>/var/ipsec.secrets</strong> : The generated file with preshared keys</div>
</li>
<li class="level1"><div class="li"> <strong>/var/strongswan.conf</strong> : The generated central configuration file</div>
</li>
</ul>

<p>
Here a short example of the configuration methodology when having two VPN tunnels to ACME and Yabadoo networks 
</p>

<p>
<pre class="code">#/etc/config/ipsec
config &#039;remote&#039; &#039;ACME&#039;
  option &#039;enabled&#039; &#039;1&#039;
  option &#039;gateway&#039; &#039;1.2.3.4&#039;
  list   &#039;tunnel&#039; &#039;acme_lan&#039;
  ...

config &#039;tunnel&#039; &#039;acme_lan&#039;
  option &#039;local_subnet&#039; &#039;192.168.213.64/26&#039;
  option &#039;remote_subnet&#039; &#039;192.168.10.0/24&#039;
  ...

config &#039;remote&#039; &#039;Yabadoo&#039;
  option &#039;enabled&#039; &#039;1&#039;
  option &#039;gateway&#039; &#039;5.6.7.8&#039;</pre>

</p>

<p>
Read more about the complete syntax for <a href="../uci/ipsec" class="wikilink1" title="doc:uci:ipsec">/etc/config/ipsec</a>.
</p>

</div>

<h2 class="sectionedit5" id="ike_daemon">IKE Daemon</h2>
<div class="level2">

<p>
To let Charon run as a background daemon we can place a hook in the init environment. Therefore create the file <strong>/etc/init.d/ipsec</strong> and set the executable bit. Remark: This script is in an early alpha state. It currently works for site to site tunnels with preshared keys. Feel free to enhance it.
</p>

<p>
<pre class="code bash"><span class="co0">#!/bin/sh /etc/rc.common</span>
<span class="co0">#/etc/init.d/ipsec - version 5 - 2015/02/19</span>
&nbsp;
<span class="re2">NAME</span>=ipsec
<span class="re2">START</span>=<span class="nu0">60</span>
<span class="re2">STOP</span>=<span class="nu0">60</span>
&nbsp;
. <span class="re1">$IPKG_INSTROOT</span><span class="sy0">/</span>lib<span class="sy0">/</span>functions.sh
. <span class="re1">$IPKG_INSTROOT</span><span class="sy0">/</span>lib<span class="sy0">/</span>functions<span class="sy0">/</span>service.sh
&nbsp;
<span class="re2">FileSecrets</span>=<span class="sy0">/</span>var<span class="sy0">/</span>ipsec<span class="sy0">/</span>ipsec.secrets
<span class="re2">FileConn</span>=<span class="sy0">/</span>var<span class="sy0">/</span>ipsec<span class="sy0">/</span>ipsec.conf
<span class="re2">FileCommon</span>=<span class="sy0">/</span>var<span class="sy0">/</span>ipsec<span class="sy0">/</span>strongswan.conf
&nbsp;
<span class="re2">FolderCerts</span>=<span class="sy0">/</span>var<span class="sy0">/</span>ipsec<span class="sy0">/</span>ipsec.d
&nbsp;
ConfigUser<span class="br0">&#40;</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
  <span class="kw3">local</span> enabled
  <span class="kw3">local</span> xauth
  <span class="kw3">local</span> name
  <span class="kw3">local</span> password
  <span class="kw3">local</span> crt_subject
&nbsp;
  config_get_bool enabled <span class="re4">$1</span> enabled <span class="nu0">0</span>
  <span class="br0">&#91;</span><span class="br0">&#91;</span> <span class="st0">&quot;<span class="es2">$enabled</span>&quot;</span> == <span class="st0">&quot;0&quot;</span> <span class="br0">&#93;</span><span class="br0">&#93;</span> <span class="sy0">&amp;&amp;</span> <span class="kw3">return</span>
&nbsp;
  config_get_bool xauth       <span class="re4">$1</span> xauth       <span class="nu0">0</span>
  config_get      name        <span class="re4">$1</span> name        <span class="st0">&quot;&quot;</span>
  config_get      password    <span class="re4">$1</span> password    <span class="st0">&quot;&quot;</span>
&nbsp;
  <span class="kw1">if</span> <span class="br0">&#91;</span> <span class="re1">$xauth</span> <span class="re5">-eq</span> <span class="nu0">1</span> <span class="re5">-a</span> <span class="st0">&quot;<span class="es2">$name</span>&quot;</span> <span class="sy0">!</span>= <span class="st0">&quot;&quot;</span> <span class="re5">-a</span> <span class="st0">&quot;<span class="es2">$password</span>&quot;</span> <span class="sy0">!</span>= <span class="st0">&quot;&quot;</span> <span class="br0">&#93;</span>; <span class="kw1">then</span>
    <span class="kw3">echo</span> <span class="st0">&quot;<span class="es2">$name</span> : XAUTH <span class="es1">\&quot;</span><span class="es2">$password</span><span class="es1">\&quot;</span>&quot;</span> <span class="sy0">&gt;&gt;</span> <span class="re1">$FileSecrets</span>
  <span class="kw1">fi</span>
<span class="br0">&#125;</span>
&nbsp;
&nbsp;
ConfigPhase1<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
  <span class="kw3">local</span> encryption_algorithm
  <span class="kw3">local</span> hash_algorithm
  <span class="kw3">local</span> dh_group
&nbsp;
  config_get encryption_algorithm  <span class="st0">&quot;$1&quot;</span> encryption_algorithm
  config_get hash_algorithm        <span class="st0">&quot;$1&quot;</span> hash_algorithm
  config_get dh_group              <span class="st0">&quot;$1&quot;</span> dh_group
&nbsp;
  <span class="re2">Phase1Proposal</span>=<span class="co1">${Phase1Proposal}</span><span class="st0">&quot;,&quot;</span><span class="co1">${encryption_algorithm}</span>-<span class="co1">${hash_algorithm}</span>-<span class="co1">${dh_group}</span>
<span class="br0">&#125;</span>
&nbsp;
ConfigTunnel<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
  <span class="kw3">local</span> local_subnet
  <span class="kw3">local</span> local_nat
  <span class="kw3">local</span> remote_subnet
  <span class="kw3">local</span> p2_proposal
  <span class="kw3">local</span> pfs_group
  <span class="kw3">local</span> encryption_algorithm
  <span class="kw3">local</span> authentication_algorithm
&nbsp;
  config_get local_subnet             <span class="st0">&quot;$1&quot;</span>           local_subnet
  config_get local_nat                <span class="st0">&quot;$1&quot;</span>           local_nat <span class="st0">&quot;&quot;</span>
  config_get remote_subnet            <span class="st0">&quot;$1&quot;</span>           remote_subnet
  config_get p2_proposal              <span class="st0">&quot;$1&quot;</span>           p2_proposal
  config_get pfs_group                <span class="st0">&quot;<span class="es2">$p2_proposal</span>&quot;</span> pfs_group
  config_get encryption_algorithm     <span class="st0">&quot;<span class="es2">$p2_proposal</span>&quot;</span> encryption_algorithm
  config_get authentication_algorithm <span class="st0">&quot;<span class="es2">$p2_proposal</span>&quot;</span> authentication_algorithm
&nbsp;
  <span class="br0">&#91;</span><span class="br0">&#91;</span> <span class="st0">&quot;<span class="es2">$local_nat</span>&quot;</span> <span class="sy0">!</span>= <span class="st0">&quot;&quot;</span> <span class="br0">&#93;</span><span class="br0">&#93;</span> <span class="sy0">&amp;&amp;</span> <span class="re2">local_subnet</span>=<span class="re1">$local_nat</span>
&nbsp;
  <span class="re2">p2_proposal</span>=<span class="st0">&quot;<span class="es3">${encryption_algorithm}</span>-<span class="es3">${authentication_algorithm}</span>-<span class="es3">${pfs_group}</span>&quot;</span>
&nbsp;
  <span class="kw3">echo</span> <span class="st0">&quot;conn <span class="es2">$ConfigName</span>-$1&quot;</span> <span class="sy0">&gt;&gt;</span> <span class="re1">$FileConn</span>
  <span class="kw3">echo</span> <span class="st0">&quot;  keyexchange=ikev1&quot;</span> <span class="sy0">&gt;&gt;</span> <span class="re1">$FileConn</span>
  <span class="kw3">echo</span> <span class="st0">&quot;  left=<span class="es2">$LocalGateway</span>&quot;</span> <span class="sy0">&gt;&gt;</span> <span class="re1">$FileConn</span>
  <span class="kw3">echo</span> <span class="st0">&quot;  right=<span class="es2">$RemoteGateway</span>&quot;</span> <span class="sy0">&gt;&gt;</span> <span class="re1">$FileConn</span>
  <span class="kw3">echo</span> <span class="st0">&quot;  leftsubnet=<span class="es2">$local_subnet</span>&quot;</span> <span class="sy0">&gt;&gt;</span> <span class="re1">$FileConn</span>
  <span class="kw1">if</span> <span class="br0">&#91;</span> <span class="st0">&quot;<span class="es2">$AuthenticationMethod</span>&quot;</span> = <span class="st0">&quot;psk&quot;</span> <span class="br0">&#93;</span>; <span class="kw1">then</span>
    <span class="kw3">echo</span> <span class="st0">&quot;  leftauth=psk&quot;</span> <span class="sy0">&gt;&gt;</span> <span class="re1">$FileConn</span>
    <span class="kw3">echo</span> <span class="st0">&quot;  rightauth=psk&quot;</span> <span class="sy0">&gt;&gt;</span> <span class="re1">$FileConn</span>
    <span class="kw3">echo</span> <span class="st0">&quot;  rightsubnet=<span class="es2">$remote_subnet</span>&quot;</span> <span class="sy0">&gt;&gt;</span> <span class="re1">$FileConn</span>
<span class="co0"># should be auto=route when going to 5.0.1</span>
    <span class="kw3">echo</span> <span class="st0">&quot;  auto=start&quot;</span> <span class="sy0">&gt;&gt;</span> <span class="re1">$FileConn</span>
  <span class="kw1">elif</span> <span class="br0">&#91;</span> <span class="st0">&quot;<span class="es2">$AuthenticationMethod</span>&quot;</span> = <span class="st0">&quot;xauth_psk_server&quot;</span> <span class="br0">&#93;</span>; <span class="kw1">then</span>
    <span class="kw3">echo</span> <span class="st0">&quot;  authby=xauthpsk&quot;</span> <span class="sy0">&gt;&gt;</span> <span class="re1">$FileConn</span>
    <span class="kw3">echo</span> <span class="st0">&quot;  xauth=server&quot;</span> <span class="sy0">&gt;&gt;</span> <span class="re1">$FileConn</span>
    <span class="kw3">echo</span> <span class="st0">&quot;  modeconfig=pull&quot;</span> <span class="sy0">&gt;&gt;</span> <span class="re1">$FileConn</span>
    <span class="kw3">echo</span> <span class="st0">&quot;  rightsourceip=<span class="es2">$remote_subnet</span>&quot;</span> <span class="sy0">&gt;&gt;</span> <span class="re1">$FileConn</span>
    <span class="kw3">echo</span> <span class="st0">&quot;  auto=add&quot;</span> <span class="sy0">&gt;&gt;</span> <span class="re1">$FileConn</span>
  <span class="kw1">fi</span>
  <span class="kw1">if</span> <span class="br0">&#91;</span> <span class="st0">&quot;<span class="es2">$LocalIdentifier</span>&quot;</span> <span class="sy0">!</span>= <span class="st0">&quot;&quot;</span> <span class="br0">&#93;</span>; <span class="kw1">then</span>
    <span class="kw3">echo</span> <span class="st0">&quot;  leftid=<span class="es2">$LocalIdentifier</span>&quot;</span> <span class="sy0">&gt;&gt;</span> <span class="re1">$FileConn</span>
  <span class="kw1">fi</span>
  <span class="kw1">if</span> <span class="br0">&#91;</span> <span class="st0">&quot;<span class="es2">$RemoteIdentifier</span>&quot;</span> <span class="sy0">!</span>= <span class="st0">&quot;&quot;</span> <span class="br0">&#93;</span>; <span class="kw1">then</span>
    <span class="kw3">echo</span> <span class="st0">&quot;  rightid=<span class="es2">$RemoteIdentifier</span>&quot;</span> <span class="sy0">&gt;&gt;</span> <span class="re1">$FileConn</span>
  <span class="kw1">fi</span>
&nbsp;
<span class="co0">#  echo &quot;  auth=esp&quot; &gt;&gt; $FileConn</span>
  <span class="kw3">echo</span> <span class="st0">&quot;  esp=<span class="es2">$p2_proposal</span>&quot;</span> <span class="sy0">&gt;&gt;</span> <span class="re1">$FileConn</span>
  <span class="kw3">echo</span> <span class="st0">&quot;  ike=<span class="es2">$Phase1Proposal</span>&quot;</span> <span class="sy0">&gt;&gt;</span> <span class="re1">$FileConn</span>
  <span class="kw3">echo</span> <span class="st0">&quot;  type=tunnel&quot;</span> <span class="sy0">&gt;&gt;</span> <span class="re1">$FileConn</span>
<span class="br0">&#125;</span>
&nbsp;
ConfigRemote<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
  <span class="kw3">local</span> enabled
  <span class="kw3">local</span> gateway
  <span class="kw3">local</span> pre_shared_key
  <span class="kw3">local</span> authentication_method
  <span class="kw3">local</span> local_identifier
  <span class="kw3">local</span> remote_identifier
&nbsp;
  <span class="re2">ConfigName</span>=<span class="re4">$1</span>
&nbsp;
  config_get_bool enabled <span class="st0">&quot;$1&quot;</span> enabled <span class="nu0">0</span>
  <span class="br0">&#91;</span><span class="br0">&#91;</span> <span class="st0">&quot;<span class="es2">$enabled</span>&quot;</span> == <span class="st0">&quot;0&quot;</span> <span class="br0">&#93;</span><span class="br0">&#93;</span> <span class="sy0">&amp;&amp;</span> <span class="kw3">return</span>
&nbsp;
  config_get gateway               <span class="st0">&quot;$1&quot;</span> gateway
  config_get pre_shared_key        <span class="st0">&quot;$1&quot;</span> pre_shared_key
  config_get authentication_method <span class="st0">&quot;$1&quot;</span> authentication_method
  config_get local_identifier      <span class="st0">&quot;$1&quot;</span> local_identifier
  config_get remote_identifier     <span class="st0">&quot;$1&quot;</span> remote_identifier
&nbsp;
  <span class="re2">AuthenticationMethod</span>=<span class="re1">$authentication_method</span>
  <span class="re2">LocalIdentifier</span>=<span class="re1">$local_identifier</span>
  <span class="re2">RemoteIdentifier</span>=<span class="re1">$remote_identifier</span>
&nbsp;
  <span class="re2">RemoteGateway</span>=<span class="re1">$gateway</span>
  <span class="kw1">if</span> <span class="br0">&#91;</span> <span class="st0">&quot;<span class="es2">$RemoteGateway</span>&quot;</span> = <span class="st0">&quot;any&quot;</span> <span class="br0">&#93;</span>; <span class="kw1">then</span>
    <span class="re2">RemoteGateway</span>=<span class="st0">&quot;%any&quot;</span>
    <span class="re2">LocalGateway</span>=<span class="sy0">`</span><span class="kw2">ip route</span> get 1.1.1.1 <span class="sy0">|</span> <span class="kw2">awk</span> <span class="re5">-F</span><span class="st0">&quot;src&quot;</span> <span class="st_h">'/src/{gsub(/ /,&quot;&quot;);print $2}'</span><span class="sy0">`</span>
  <span class="kw1">else</span>
    <span class="re2">LocalGateway</span>=<span class="sy0">`</span><span class="kw2">ip route</span> get <span class="re1">$RemoteGateway</span> <span class="sy0">|</span> <span class="kw2">awk</span> <span class="re5">-F</span><span class="st0">&quot;src&quot;</span> <span class="st_h">'/src/{gsub(/ /,&quot;&quot;);print $2}'</span><span class="sy0">`</span>
  <span class="kw1">fi</span>
  <span class="kw3">echo</span> <span class="st0">&quot;<span class="es2">$LocalGateway</span> <span class="es2">$RemoteGateway</span> : PSK <span class="es1">\&quot;</span><span class="es2">$pre_shared_key</span><span class="es1">\&quot;</span>&quot;</span> <span class="sy0">&gt;&gt;</span> <span class="re1">$FileSecrets</span>
&nbsp;
  <span class="re2">Phase1Proposal</span>=<span class="st0">&quot;&quot;</span>
  config_list_foreach <span class="st0">&quot;$1&quot;</span> p1_proposal ConfigPhase1
  <span class="re2">Phase1Proposal</span>=<span class="sy0">`</span><span class="kw3">echo</span> <span class="re1">$Phase1Proposal</span> <span class="sy0">|</span> <span class="kw2">cut</span> <span class="re5">-b</span> <span class="nu0">2</span>-<span class="sy0">`</span>
&nbsp;
  config_list_foreach <span class="st0">&quot;$1&quot;</span> tunnel ConfigTunnel
<span class="br0">&#125;</span>
&nbsp;
PrepareEnvironment<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
  <span class="kw3">local</span> debug
&nbsp;
  <span class="kw1">for</span> d <span class="kw1">in</span> cacerts aacerts ocspcerts crls acerts; <span class="kw1">do</span>
    <span class="kw2">mkdir</span> <span class="re5">-p</span> <span class="re1">$FolderCerts</span><span class="sy0">/</span><span class="re1">$d</span> <span class="nu0">2</span><span class="sy0">&gt;/</span>dev<span class="sy0">/</span>null
  <span class="kw1">done</span>
&nbsp;
  <span class="kw1">if</span> <span class="br0">&#91;</span> <span class="sy0">!</span> <span class="re5">-L</span> <span class="sy0">/</span>etc<span class="sy0">/</span>ipsec.d <span class="br0">&#93;</span>; <span class="kw1">then</span>
    <span class="kw2">rm</span> <span class="re5">-rf</span> <span class="sy0">/</span>etc<span class="sy0">/</span>ipsec.d <span class="nu0">2</span><span class="sy0">&gt;/</span>dev<span class="sy0">/</span>null
    <span class="kw2">ln</span> <span class="re5">-s</span> <span class="re1">$FolderCerts</span> <span class="sy0">/</span>etc<span class="sy0">/</span>ipsec.d
  <span class="kw1">fi</span>
&nbsp;
  <span class="kw1">if</span> <span class="br0">&#91;</span> <span class="sy0">!</span> <span class="re5">-L</span> <span class="sy0">/</span>etc<span class="sy0">/</span>ipsec.secrets <span class="br0">&#93;</span>; <span class="kw1">then</span>
    <span class="kw2">rm</span> <span class="sy0">/</span>etc<span class="sy0">/</span>ipsec.secrets <span class="nu0">2</span><span class="sy0">&gt;/</span>dev<span class="sy0">/</span>null
    <span class="kw2">ln</span> <span class="re5">-s</span> <span class="re1">$FileSecrets</span> <span class="sy0">/</span>etc<span class="sy0">/</span>ipsec.secrets
  <span class="kw1">fi</span>
&nbsp;
  <span class="kw1">if</span> <span class="br0">&#91;</span> <span class="sy0">!</span> <span class="re5">-L</span> <span class="sy0">/</span>etc<span class="sy0">/</span>strongswan.conf <span class="br0">&#93;</span>; <span class="kw1">then</span>
    <span class="kw2">rm</span> <span class="sy0">/</span>etc<span class="sy0">/</span>strongswan.conf <span class="nu0">2</span><span class="sy0">&gt;/</span>dev<span class="sy0">/</span>null
    <span class="kw2">ln</span> <span class="re5">-s</span> <span class="re1">$FileCommon</span> <span class="sy0">/</span>etc<span class="sy0">/</span>strongswan.conf
  <span class="kw1">fi</span>
&nbsp;
  <span class="kw1">if</span> <span class="br0">&#91;</span> <span class="sy0">!</span> <span class="re5">-L</span> <span class="sy0">/</span>etc<span class="sy0">/</span>ipsec.conf <span class="br0">&#93;</span>; <span class="kw1">then</span>
    <span class="kw2">rm</span> <span class="sy0">/</span>etc<span class="sy0">/</span>ipsec.conf <span class="nu0">2</span><span class="sy0">&gt;/</span>dev<span class="sy0">/</span>null
    <span class="kw2">ln</span> <span class="re5">-s</span> <span class="re1">$FileConn</span> <span class="sy0">/</span>etc<span class="sy0">/</span>ipsec.conf
  <span class="kw1">fi</span>
&nbsp;
  <span class="kw3">echo</span> <span class="st0">&quot;# generated by /etc/init.d/ipsec&quot;</span> <span class="sy0">&gt;</span> <span class="re1">$FileConn</span>
  <span class="kw3">echo</span> <span class="st0">&quot;version 2&quot;</span> <span class="sy0">&gt;</span> <span class="re1">$FileConn</span>
  <span class="kw3">echo</span> <span class="st0">&quot;# generated by /etc/init.d/ipsec&quot;</span> <span class="sy0">&gt;</span> <span class="re1">$FileSecrets</span>
&nbsp;
  config_get debug <span class="st0">&quot;$1&quot;</span> debug <span class="nu0">0</span>
&nbsp;
  <span class="kw3">echo</span> <span class="st0">&quot;# generated by /etc/init.d/ipsec&quot;</span> <span class="sy0">&gt;</span> <span class="re1">$FileCommon</span>
  <span class="kw3">echo</span> <span class="st0">&quot;charon {&quot;</span> <span class="sy0">&gt;&gt;</span> <span class="re1">$FileCommon</span>
  <span class="kw3">echo</span> <span class="st0">&quot;  load = aes des sha1 sha2 md5 gmp random nonce hmac stroke kernel-netlink socket-default updown&quot;</span> <span class="sy0">&gt;&gt;</span> <span class="re1">$FileCommon</span>
  <span class="kw3">echo</span> <span class="st0">&quot;  filelog {&quot;</span> <span class="sy0">&gt;&gt;</span> <span class="re1">$FileCommon</span>
  <span class="kw3">echo</span> <span class="st0">&quot;    /var/log/charon.log {&quot;</span> <span class="sy0">&gt;&gt;</span> <span class="re1">$FileCommon</span>
  <span class="kw3">echo</span> <span class="st0">&quot;      time_format = %b %e %T&quot;</span> <span class="sy0">&gt;&gt;</span> <span class="re1">$FileCommon</span>
  <span class="kw3">echo</span> <span class="st0">&quot;      ike_name = yes&quot;</span> <span class="sy0">&gt;&gt;</span> <span class="re1">$FileCommon</span>
  <span class="kw3">echo</span> <span class="st0">&quot;      append = no&quot;</span> <span class="sy0">&gt;&gt;</span> <span class="re1">$FileCommon</span>
  <span class="kw3">echo</span> <span class="st0">&quot;      default = &quot;</span> <span class="re1">$debug</span> <span class="sy0">&gt;&gt;</span> <span class="re1">$FileCommon</span>
  <span class="kw3">echo</span> <span class="st0">&quot;      flush_line = yes&quot;</span> <span class="sy0">&gt;&gt;</span> <span class="re1">$FileCommon</span>
  <span class="kw3">echo</span> <span class="st0">&quot;    }&quot;</span> <span class="sy0">&gt;&gt;</span> <span class="re1">$FileCommon</span>
  <span class="kw3">echo</span> <span class="st0">&quot;  }&quot;</span> <span class="sy0">&gt;&gt;</span> <span class="re1">$FileCommon</span>
  <span class="kw3">echo</span> <span class="st0">&quot;}&quot;</span> <span class="sy0">&gt;&gt;</span> <span class="re1">$FileCommon</span>
&nbsp;
<span class="br0">&#125;</span>
&nbsp;
CheckInstallation<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
  <span class="kw1">if</span> <span class="br0">&#91;</span> <span class="sy0">!</span> <span class="re5">-x</span> <span class="sy0">/</span>usr<span class="sy0">/</span>sbin<span class="sy0">/</span><span class="kw2">ip</span> <span class="br0">&#93;</span>; <span class="kw1">then</span>
    <span class="kw3">echo</span> <span class="sy0">/</span>usr<span class="sy0">/</span>sbin<span class="sy0">/</span><span class="kw2">ip</span> missing
    <span class="kw3">echo</span> <span class="kw2">install</span> with <span class="co3">\&quot;</span>opkg <span class="kw2">install</span> <span class="kw2">ip</span><span class="co3">\&quot;</span>
    <span class="kw3">exit</span>
  <span class="kw1">fi</span>
&nbsp;
  <span class="kw1">for</span> f <span class="kw1">in</span> aes authenc cbc hmac md5 sha1; <span class="kw1">do</span>
    <span class="kw1">if</span> <span class="br0">&#91;</span> <span class="sy0">`</span>opkg list kmod-crypto-<span class="re1">$f</span> <span class="sy0">|</span> <span class="kw2">wc</span> -l<span class="sy0">`</span> <span class="re5">-eq</span> <span class="nu0">0</span> <span class="br0">&#93;</span>; <span class="kw1">then</span>
      <span class="kw3">echo</span> kmod-crypto-<span class="re1">$f</span> missing
      <span class="kw3">echo</span> <span class="kw2">install</span> with  <span class="co3">\&quot;</span>opkg <span class="kw2">install</span> kmod-crypto-<span class="re1">$f</span> <span class="re5">--nodeps</span><span class="co3">\&quot;</span>
      <span class="kw3">exit</span>
    <span class="kw1">fi</span>
  <span class="kw1">done</span>
&nbsp;
  <span class="kw1">for</span> f <span class="kw1">in</span> aes gmp hmac kernel-netlink md5 random sha1 updown attr resolve; <span class="kw1">do</span>
    <span class="kw1">if</span> <span class="br0">&#91;</span> <span class="sy0">!</span> <span class="re5">-f</span> <span class="sy0">/</span>usr<span class="sy0">/</span>lib<span class="sy0">/</span>ipsec<span class="sy0">/</span>plugins<span class="sy0">/</span>libstrongswan-<span class="co1">${f}</span>.so <span class="br0">&#93;</span>; <span class="kw1">then</span>
      <span class="kw3">echo</span> <span class="sy0">/</span>usr<span class="sy0">/</span>lib<span class="sy0">/</span>ipsec<span class="sy0">/</span>plugins<span class="sy0">/</span><span class="re1">$f</span> missing
      <span class="kw3">echo</span> <span class="kw2">install</span> with <span class="co3">\&quot;</span>opkg <span class="kw2">install</span> strongswan-mod-<span class="re1">$f</span> <span class="re5">--nodeps</span><span class="co3">\&quot;</span>
      <span class="kw3">exit</span>
    <span class="kw1">fi</span>
  <span class="kw1">done</span>
<span class="br0">&#125;</span>
&nbsp;
start<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
  CheckInstallation
&nbsp;
  config_load ipsec
  config_foreach PrepareEnvironment ipsec
  config_foreach ConfigRemote remote
&nbsp;
  config_load <span class="kw2">users</span>
  config_foreach ConfigUser user
&nbsp;
  <span class="sy0">/</span>usr<span class="sy0">/</span>sbin<span class="sy0">/</span>ipsec start
<span class="br0">&#125;</span>
&nbsp;
stop<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
  <span class="sy0">/</span>usr<span class="sy0">/</span>sbin<span class="sy0">/</span>ipsec stop
<span class="br0">&#125;</span></pre>

</p>

<p>
Before you start Charon with the web interface you should make a dry run from command line. This will show you if there are any errors in your generated configuration file <strong>/etc/ipsec.conf</strong>. Afterwards you can control startup behaviour with LuCI.
</p>

<p>
<a href="../../_detail/doc/howto/ipsec_daemon.png?id=doc%253Ahowto%253Avpn.ipsec.basics" class="media" title="doc:howto:ipsec_daemon.png"><img src="../../_media/doc/howto/ipsec_daemon.png" class="media" alt="" /></a>
</p>

</div>

<h2 class="sectionedit6" id="what_s_next">What&#039;s next</h2>
<div class="level2">

<p>
After the basic setup you should make sure you understand the <a href="vpn.ipsec.performance" class="wikilink1" title="doc:howto:vpn.ipsec.performance">expected performance</a> of low budget routers.
</p>

</div>

<h2 class="sectionedit7" id="tag">Tag</h2>
<div class="level2">
<div class="tags"><span>
	<a href="../../tag/crypto?do=showtag&amp;tag=crypto" class="wikilink1" title="tag:crypto" rel="tag">crypto</a>
</span></div>

</div>

                    <!-- wikipage stop -->
                                    </div>

                <div class="docInfo"><bdi>doc/howto/vpn.ipsec.basics.txt</bdi> · Last modified: 2015/04/26 07:47 by <bdi>milledel</bdi></div>

                            </div></div><!-- /content -->

            <hr class="a11y" />

            <!-- PAGE ACTIONS -->
            <div id="dokuwiki__pagetools">
                <h3 class="a11y">Page Tools</h3>
                <div class="tools">
                    <ul>
                        <li><a href="vpn.ipsec.basics?do=edit"  class="action source" accesskey="v" rel="nofollow" title="Show pagesource [V]"><span>Show pagesource</span></a></li><li><a href="vpn.ipsec.basics?do=revisions"  class="action revs" accesskey="o" rel="nofollow" title="Old revisions [O]"><span>Old revisions</span></a></li><li><a href="vpn.ipsec.basics?do=backlink"  class="action backlink" rel="nofollow" title="Backlinks"><span>Backlinks</span></a></li><li><a href="vpn.ipsec.basics#dokuwiki__top"  class="action top" accesskey="t" rel="nofollow" title="Back to top [T]"><span>Back to top</span></a></li>                    </ul>
                </div>
            </div>
        </div><!-- /wrapper -->

        
<!-- ********** FOOTER ********** -->
<div id="dokuwiki__footer"><div class="pad">
    <div class="license">Except where otherwise noted, content on this wiki is licensed under the following license: <bdi><a href="http://creativecommons.org/licenses/by-nc-sa/3.0/" rel="license" class="urlextern">CC Attribution-Noncommercial-Share Alike 3.0 Unported</a></bdi></div>
    <div class="buttons">
        <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/" rel="license"><img src="../../lib/images/license/button/cc-by-nc-sa.png" alt="CC Attribution-Noncommercial-Share Alike 3.0 Unported" /></a>        <a href="http://www.dokuwiki.org/donate" title="Donate" ><img
            src="../../lib/tpl/openwrt/images/button-donate.gif" width="80" height="15" alt="Donate" /></a>
        <a href="http://www.php.net" title="Powered by PHP" ><img
            src="../../lib/tpl/openwrt/images/button-php.gif" width="80" height="15" alt="Powered by PHP" /></a>
        <a href="http://validator.w3.org/check/referer" title="Valid HTML5" ><img
            src="../../lib/tpl/openwrt/images/button-html5.png" width="80" height="15" alt="Valid HTML5" /></a>
        <a href="http://jigsaw.w3.org/css-validator/check/referer?profile=css3" title="Valid CSS" ><img
            src="../../lib/tpl/openwrt/images/button-css.png" width="80" height="15" alt="Valid CSS" /></a>
        <a href="http://dokuwiki.org/" title="Driven by DokuWiki" ><img
            src="../../lib/tpl/openwrt/images/button-dw.png" width="80" height="15" alt="Driven by DokuWiki" /></a>
    </div>
</div></div><!-- /footer -->

    </div></div><!-- /site -->

    <div class="no"><img src="../../lib/exe/indexer.php?id=doc%253Ahowto%253Avpn.ipsec.basics&amp;1432268131" width="2" height="1" alt="" /></div>
    <div id="screen__mode" class="no"></div>    <!--[if ( lte IE 7 | IE 8 ) ]></div><![endif]-->
</body>
</html>
