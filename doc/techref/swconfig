<!DOCTYPE html>
<html lang="en" dir="ltr" class="no-js">
<head>
    <meta charset="utf-8" />
    <title>Swconfig [OpenWrt Wiki]</title>
    <script>(function(H){H.className=H.className.replace(/\bno-js\b/,'js')})(document.documentElement)</script>
    <meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="keywords" content="swconfig,rtl8366rb,ar8316"/>
<link rel="search" type="application/opensearchdescription+xml" href="../../lib/exe/opensearch.php" title="OpenWrt Wiki"/>
<link rel="start" href="../../index.html"/>
<link rel="contents" href="swconfig?do=index" title="Sitemap"/>
<link rel="alternate" type="application/rss+xml" title="Recent changes" href="../../feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Current namespace" href="../../feed.php?mode=list&amp;ns=doc:techref"/>
<link rel="alternate" type="text/html" title="Plain HTML" href="../../_export/xhtml/doc/techref/swconfig"/>
<link rel="alternate" type="text/plain" title="Wiki Markup" href="../../_export/raw/doc/techref/swconfig"/>
<link rel="canonical" href="swconfig"/>
<link rel="stylesheet" type="text/css" href="../../lib/exe/css.php?t=openwrt&amp;tseed=6f44f363dc87908d905dc56ff3acbfc4"/>
<script type="text/javascript">/*<![CDATA[*/var NS='doc:techref';var JSINFO = {"id":"doc:techref:swconfig","namespace":"doc:techref"};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="../../lib/exe/js.php?tseed=6f44f363dc87908d905dc56ff3acbfc4"></script>
<script type="text/javascript" charset="utf-8">/*<![CDATA[*/jQuery(function(){
	for ( i=0; i < document.forms.length; i++ ) {
		if (document.forms[i].method == 'post') {
			var myElement = document.createElement('input');
			myElement.setAttribute('type', 'hidden');
			myElement.name = 'bb2_screener_';
			myElement.value = '1432267220 166.182.3.150';
			document.forms[i].appendChild(myElement);
		}
	}
});
/*!]]>*/</script>
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <link rel="shortcut icon" href="../../lib/tpl/openwrt/images/favicon.ico" />
<link rel="apple-touch-icon" href="../../lib/tpl/openwrt/images/apple-touch-icon.png" />
    </head>

<body>
    <!--[if lte IE 7 ]><div id="IE7"><![endif]--><!--[if IE 8 ]><div id="IE8"><![endif]-->
    <div id="dokuwiki__site"><div id="dokuwiki__top" class="site dokuwiki mode_show tpl_openwrt     ">

        
<!-- ********** HEADER ********** -->
<div id="dokuwiki__header"><div class="pad group">

    
    <div class="headings group">
        <ul class="a11y skip">
            <li><a href="swconfig#dokuwiki__content">skip to content</a></li>
        </ul>

        <h1><a href="../../start"  accesskey="h" title="[H]"><img src="../../lib/tpl/openwrt/images/logo.png" width="386" height="98" alt="" /> <span>OpenWrt Wiki</span></a></h1>
            </div>

    <div class="tools group">
        <!-- USER TOOLS -->
                    <div id="dokuwiki__usertools">
                <h3 class="a11y">User Tools</h3>
                <ul>
                    <li><a href="swconfig?do=register"  class="action register" rel="nofollow" title="Register">Register</a></li><li><a href="swconfig?do=login&amp;sectok=382740b13d95f946eed36caa57076b4a"  class="action login" rel="nofollow" title="Login">Login</a></li>                </ul>
            </div>
        
        <!-- SITE TOOLS -->
        <div id="dokuwiki__sitetools">
            <h3 class="a11y">Site Tools</h3>
            <form action="../../start" accept-charset="utf-8" class="search" id="dw__search" method="get" role="search"><div class="no"><input type="hidden" name="do" value="search" /><input type="text" id="qsearch__in" accesskey="f" name="id" class="edit" title="[F]" /><input type="submit" value="Search" class="button" title="Search" /><div id="qsearch__out" class="ajax_qsearch JSpopup"></div></div></form>            <div class="mobileTools">
                <form action="../../doku.php" method="get" accept-charset="utf-8"><div class="no"><input type="hidden" name="id" value="doc:techref:swconfig" /><select name="do" class="edit quickselect" title="Tools"><option value="">Tools</option><optgroup label="Page Tools"><option value="edit">Show pagesource</option><option value="revisions">Old revisions</option><option value="backlink">Backlinks</option></optgroup><optgroup label="Site Tools"><option value="recent">Recent changes</option><option value="media">Media Manager</option><option value="index">Sitemap</option></optgroup><optgroup label="User Tools"><option value="login">Login</option><option value="register">Register</option></optgroup></select><input type="submit" value="&gt;" /></div></form>            </div>
            <ul>
                <li><a href="swconfig?do=recent"  class="action recent" accesskey="r" rel="nofollow" title="Recent changes [R]">Recent changes</a></li><li><a href="swconfig?do=media&amp;ns=doc%253Atechref"  class="action media" rel="nofollow" title="Media Manager">Media Manager</a></li><li><a href="swconfig?do=index"  class="action index" accesskey="x" rel="nofollow" title="Sitemap [X]">Sitemap</a></li>            </ul>
        </div>

    </div>

    <!-- BREADCRUMBS -->
            <div class="breadcrumbs">
                            <div class="youarehere"><span class="bchead">You are here: </span><span class="home"><bdi><a href="../../start" class="wikilink1" title="start">OpenWrt Wiki</a></bdi></span> » <bdi><a href="../start" class="wikilink1" title="doc:start">Documentation</a></bdi> » <bdi><a href="../techref.1" class="wikilink1" title="doc:techref:start">Technical Reference</a></bdi> » <bdi><span class="curid"><a href="swconfig" class="wikilink1" title="doc:techref:swconfig">Swconfig</a></span></bdi></div>
                                    <div class="plugin_multilingual">
        <ul>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/cz/doc/techref/swconfig" class="media" title="cz:doc:techref:swconfig"><img src="../../lib/exe/fetch.php?cache=&amp;tok=aff589&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fcz.gif" class="media" title="Čeština (Czech)" alt="Čeština (Czech)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/de/doc/techref/swconfig" class="media" title="de:doc:techref:swconfig"><img src="../../lib/exe/fetch.php?cache=&amp;tok=e24010&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fde.gif" class="media" title="Deutsch (German)" alt="Deutsch (German)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <span class="curid"><a href="swconfig" class="media" title="doc:techref:swconfig"><img src="../../lib/exe/fetch.php?cache=&amp;tok=2a37ae&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fgb.gif" class="media" title="English" alt="English" /></a></span>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/es/doc/techref/swconfig" class="media" title="es:doc:techref:swconfig"><img src="../../lib/exe/fetch.php?cache=&amp;tok=46c004&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fmx.gif" class="media" title="Español (Spanish, Mexico)" alt="Español (Spanish, Mexico)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/fr/doc/techref/swconfig" class="media" title="fr:doc:techref:swconfig"><img src="../../lib/exe/fetch.php?cache=&amp;tok=a5beba&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Ffr.gif" class="media" title="Français (French)" alt="Français (French)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/hu/doc/techref/swconfig" class="media" title="hu:doc:techref:swconfig"><img src="../../lib/exe/fetch.php?cache=&amp;tok=6b5470&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fhu.gif" class="media" title="Magyar (Hungarian)" alt="Magyar (Hungarian)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/jp/doc/techref/swconfig" class="media" title="jp:doc:techref:swconfig"><img src="../../lib/exe/fetch.php?cache=&amp;tok=f999fc&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fjp.gif" class="media" title="日本語 (Japanese)" alt="日本語 (Japanese)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/pl/doc/techref/swconfig" class="media" title="pl:doc:techref:swconfig"><img src="../../lib/exe/fetch.php?cache=&amp;tok=c805c0&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fpl.gif" class="media" title="Poliski (Polish)" alt="Poliski (Polish)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/pt-br/doc/techref/swconfig" class="media" title="pt-br:doc:techref:swconfig"><img src="../../lib/exe/fetch.php?cache=&amp;tok=13127d&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fbr.gif" class="media" title="Português brasileiro (Portuguese, Brasil)" alt="Português brasileiro (Portuguese, Brasil)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/ru/doc/techref/swconfig" class="media" title="ru:doc:techref:swconfig"><img src="../../lib/exe/fetch.php?cache=&amp;tok=66ab5e&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fru.gif" class="media" title="Русский (Russsian)" alt="Русский (Russsian)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/tr/doc/techref/swconfig" class="media" title="tr:doc:techref:swconfig"><img src="../../lib/exe/fetch.php?cache=&amp;tok=f4beed&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Ftr.gif" class="media" title="Tϋrkçe (Turkish)" alt="Tϋrkçe (Turkish)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/zh-cn/doc/techref/swconfig" class="media" title="zh-cn:doc:techref:swconfig"><img src="../../lib/exe/fetch.php?cache=&amp;tok=93625a&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fzh-cn.gif" class="media" title="官話/官话 (Chinese)" alt="官話/官话 (Chinese)" /></a>
              </div>
            </div>
          </li>
          <li>
            <div class="li">
              <div class="flag_not_exists">
                <a href="http://wiki.openwrt.org/zh-tw/doc/techref/swconfig" class="media" title="zh-tw:doc:techref:swconfig"><img src="../../lib/exe/fetch.php?cache=&amp;tok=b56198&amp;media=http%253A%252F%252Fwiki.openwrt.org%252Flib%252Fplugins%252Fmultilingual%252Fflags%252Fzh-tw.gif" class="media" title="臺灣華語 (Taiwanese)" alt="臺灣華語 (Taiwanese)" /></a>
              </div>
            </div>
          </li>
        </ul>
      </div>
        </div>
    
    
    <hr class="a11y" />
</div></div><!-- /header -->

        <div class="wrapper group">

            
            <!-- ********** CONTENT ********** -->
            <div id="dokuwiki__content"><div class="pad group">

                <div class="pageId"><span>doc:techref:swconfig</span></div>

                <div class="page group">
                                                            <!-- wikipage start -->
                    <!-- TOC START -->
<div id="dw__toc">
<h3 class="toggle">Table of Contents</h3>
<div>

<ul class="toc">
<li class="level2"><div class="li"><a href="swconfig#supported_hardware">Supported hardware</a></div></li>
<li class="level1"><div class="li"><a href="swconfig#usage_examples">Usage examples</a></div></li>
<li class="level1"><div class="li"><a href="swconfig#show">Show</a></div></li>
<li class="level1"><div class="li"><a href="swconfig#change">Change</a></div></li>
<li class="level2"><div class="li"><a href="swconfig#design_and_rationale">Design and rationale</a></div></li>
<li class="level1"><div class="li"><a href="swconfig#introduction">Introduction</a></div></li>
<li class="level1"><div class="li"><a href="swconfig#scope_and_rationale">Scope and rationale</a></div></li>
<li class="level1"><div class="li"><a href="swconfig#distributed_switch_architecture_vs_swconfig">Distributed Switch Architecture vs. swconfig</a></div></li>
<li class="level1"><div class="li"><a href="swconfig#switch_configuration_api">Switch configuration API</a></div></li>
<li class="level1"><div class="li"><a href="swconfig#references">References</a></div></li>
<li class="level1"><div class="li"><a href="swconfig#tags">Tags</a></div></li>
</ul>
</div>
</div>
<!-- TOC END -->

<h1 class="sectionedit1" id="swconfig">Swconfig</h1>
<div class="level1">

<p>
The program <code>swconfig</code> allows you to configure <em>configurable</em> <a href="../hardware/switch" class="wikilink1" title="doc:hardware:switch">Ethernet network switches</a>.
</p>

</div>

<h3 class="sectionedit2" id="supported_hardware">Supported hardware</h3>
<div class="level3">

<p>
<code>swconfig</code> supports the following hardware switches using the mentioned <code>swconfig</code> driver;
</p>
<div class="table sectionedit3"><table class="inline">
	<tr class="row0">
		<td class="col0"> Driver </td><td class="col1"> Ethernet switches models </td><td class="col2"> Hardware wiring </td>
	</tr>
	<tr class="row1">
		<td class="col0"> <a href="https://dev.openwrt.org/browser/trunk/target/linux/generic/files/drivers/net/phy/adm6996.c" class="urlextern" title="https://dev.openwrt.org/browser/trunk/target/linux/generic/files/drivers/net/phy/adm6996.c"  rel="nofollow">adm6696</a> </td><td class="col1"> Infineon/ADMTek 66996M/L/FC </td><td class="col2"> MDIO / GPIO </td>
	</tr>
	<tr class="row2">
		<td class="col0"> <a href="https://dev.openwrt.org/browser/trunk/target/linux/generic/files/drivers/net/phy/ar8216.c" class="urlextern" title="https://dev.openwrt.org/browser/trunk/target/linux/generic/files/drivers/net/phy/ar8216.c"  rel="nofollow">ar8216</a> </td><td class="col1"> Qualcomm/Atheros AR8216/8236/8316/8327/8337</td><td class="col2"> MDIO </td>
	</tr>
	<tr class="row3">
		<td class="col0"> <a href="https://dev.openwrt.org/browser/trunk/target/linux/generic/files/drivers/net/phy/b53" class="urlextern" title="https://dev.openwrt.org/browser/trunk/target/linux/generic/files/drivers/net/phy/b53"  rel="nofollow">b53</a> </td><td class="col1"> Broadcom BCM5325/5365/5395/5398/53115/53125/53128/53010/53011/53012/53018/53019/63xx </td><td class="col2"> MDIO / SPI / MMIO </td>
	</tr>
	<tr class="row4">
		<td class="col0"> <a href="https://dev.openwrt.org/browser/trunk/target/linux/generic/files/drivers/net/phy/ip17xx.c" class="urlextern" title="https://dev.openwrt.org/browser/trunk/target/linux/generic/files/drivers/net/phy/ip17xx.c"  rel="nofollow">ip17xx</a> </td><td class="col1"> IC+ IP178C IP175A/C/D </td><td class="col2"> MDIO </td>
	</tr>
	<tr class="row5">
		<td class="col0"> <a href="https://dev.openwrt.org/browser/trunk/target/linux/generic/files/drivers/net/phy/psb6970.c" class="urlextern" title="https://dev.openwrt.org/browser/trunk/target/linux/generic/files/drivers/net/phy/psb6970.c"  rel="nofollow">psb6970</a> </td><td class="col1"> Lantiq PSB6970 </td><td class="col2"> MDIO </td>
	</tr>
	<tr class="row6">
		<td class="col0"> <a href="https://dev.openwrt.org/browser/trunk/target/linux/generic/files/drivers/net/phy/rtl8306.c" class="urlextern" title="https://dev.openwrt.org/browser/trunk/target/linux/generic/files/drivers/net/phy/rtl8306.c"  rel="nofollow">rtl8306</a> </td><td class="col1"> Realtek RTL8306S/SD/SDM </td><td class="col2"> MDIO </td>
	</tr>
	<tr class="row7">
		<td class="col0"> <a href="https://dev.openwrt.org/browser/trunk/target/linux/generic/files/drivers/net/phy/rtl8366s.c" class="urlextern" title="https://dev.openwrt.org/browser/trunk/target/linux/generic/files/drivers/net/phy/rtl8366s.c"  rel="nofollow">rtl8366s</a> </td><td class="col1"> Realtek RTL8366S </td><td class="col2"> MDIO GPIO/SMI </td>
	</tr>
	<tr class="row8">
		<td class="col0"> <a href="https://dev.openwrt.org/browser/trunk/target/linux/generic/files/drivers/net/phy/rtl8366rb.c" class="urlextern" title="https://dev.openwrt.org/browser/trunk/target/linux/generic/files/drivers/net/phy/rtl8366rb.c"  rel="nofollow">rtl8366rb</a> </td><td class="col1"> Realtek RTL8366RB </td><td class="col2"> MDIO GPIO/SMI </td>
	</tr>
	<tr class="row9">
		<td class="col0"> <a href="https://dev.openwrt.org/browser/trunk/target/linux/generic/files/drivers/net/phy/rtl8367.c" class="urlextern" title="https://dev.openwrt.org/browser/trunk/target/linux/generic/files/drivers/net/phy/rtl8367.c"  rel="nofollow">rtl8367</a> </td><td class="col1"> Realtek RTL8367 </td><td class="col2"> MDIO </td>
	</tr>
	<tr class="row10">
		<td class="col0"> <a href="https://dev.openwrt.org/browser/trunk/target/linux/generic/files/drivers/net/phy/rtl8367b.c" class="urlextern" title="https://dev.openwrt.org/browser/trunk/target/linux/generic/files/drivers/net/phy/rtl8367b.c"  rel="nofollow">rtl8367b</a> </td><td class="col1"> Realtek RTL8367B </td><td class="col2"> MDIO </td>
	</tr>
</table></div>

</div>

<h2 class="sectionedit4" id="usage_examples">Usage examples</h2>
<div class="level2">

</div>

<h2 class="sectionedit5" id="show">Show</h2>
<div class="level2">
<ul>
<li class="level1"><div class="li"> <pre class="code">swconfig list</pre>
</div>
</li>
<li class="level1"><div class="li"> <pre class="code">swconfig dev switch0 show</pre>
</div>
</li>
<li class="level1"><div class="li"> Show current configuration<pre class="code">swconfig dev rtl8366rb show</pre>
and you will obtain:<pre class="code">VLAN 1:
        info: VLAN 1: Ports: &#039;12345t&#039;, members=003e, untag=001e, fid=0
        fid: 0
        ports: 1 2 3 4 5t
VLAN 2:
        info: VLAN 2: Ports: &#039;05t&#039;, members=0021, untag=0001, fid=0
        fid: 0
        ports: 0 5t</pre>
</div>
</li>
<li class="level1"><div class="li"> Show available features<pre class="code">swconfig dev rt305x help
switch0: rt305x(rt305x-esw), ports: 7 (cpu @ 6), vlans: 4096
     --switch
        Attribute 1 (int): enable_vlan (VLAN mode (1:enabled))
        Attribute 2 (int): alternate_vlan_disable (Use en_vlan instead of doubletag to disable VLAN mode)
        Attribute 3 (none): apply (Activate changes in the hardware)
        Attribute 4 (none): reset (Reset the switch)
     --vlan
        Attribute 1 (ports): ports (VLAN port mapping)
     --port
        Attribute 1 (int): disable (Port state (1:disabled))
        Attribute 2 (int): doubletag (Double tagging for incoming vlan packets (1:enabled))
        Attribute 3 (int): untag (Untag (1:strip outgoing vlan tag))
        Attribute 4 (int): led (LED mode (0:link, 1:100m, 2:duplex, 3:activity, 4:collision, 5:linkact, 6:duplcoll, 7:10mact, 8:1)
        Attribute 5 (int): lan (HW port group (0:wan, 1:lan))
        Attribute 6 (int): recv_bad (Receive bad packet counter)
        Attribute 7 (int): recv_good (Receive good packet counter)
        Attribute 8 (int): pvid (Primary VLAN ID)
        Attribute 9 (string): link (Get port link information)</pre>
or<pre class="code">swconfig dev rtl8366rb help
switch1: rtl8366rb(RTL8366RB), ports: 6 (cpu @ 5), vlans: 4096
     --switch
        Attribute 1 (int): enable_learning (Enable learning, enable aging)
        Attribute 2 (int): enable_vlan (Enable VLAN mode)
        Attribute 3 (int): enable_vlan4k (Enable VLAN 4K mode)
        Attribute 4 (none): reset_mibs (Reset all MIB counters)
        Attribute 5 (int): blinkrate (Get/Set LED blinking rate (0 = 43ms, 1 = 84ms, 2 = 120ms, 3 = 170ms, 4 = 340ms, 5 = 670ms))
        Attribute 6 (int): enable_qos (Enable QOS)
        Attribute 7 (none): apply (Activate changes in the hardware)
        Attribute 8 (none): reset (Reset the switch)
     --vlan
        Attribute 1 (string): info (Get vlan information)
        Attribute 2 (int): fid (Get/Set vlan FID)
        Attribute 3 (ports): ports (VLAN port mapping)
     --port
        Attribute 1 (none): reset_mib (Reset single port MIB counters)
        Attribute 2 (string): mib (Get MIB counters for port)
        Attribute 3 (int): led (Get/Set port group (0 - 3) led mode (0 - 15))
        Attribute 4 (int): disable (Get/Set port state (enabled or disabled))
        Attribute 5 (int): rate_in (Get/Set port ingress (incoming) bandwidth limit in kbps)
        Attribute 6 (int): rate_out (Get/Set port egress (outgoing) bandwidth limit in kbps)
        Attribute 7 (int): pvid (Primary VLAN ID)
        Attribute 8 (string): link (Get port link information)</pre>
</div>
</li>
</ul>

</div>

<h2 class="sectionedit6" id="change">Change</h2>
<div class="level2">

<p>
Note: Make sure to apply any changes made previously with the &quot;<strong>set</strong>&quot; command.
</p>
<ul>
<li class="level1"><div class="li"> LEDs:<pre class="code">swconfig dev rtl8366s port 0 set led 2
wconfig dev rtl8366rb set apply</pre>
</div>
</li>
<li class="level1"><div class="li"> Disable VLANs:<pre class="code">swconfig dev switch0 set enable_vlan 0
swconfig dev switch0 set apply</pre>
</div>
</li>
</ul>

</div>

<h3 class="sectionedit7" id="design_and_rationale">Design and rationale</h3>
<div class="level3">

<p>
Generic Netlink Switch configuration <abbr title="Application Programming Interface">API</abbr>
</p>

</div>

<h2 class="sectionedit8" id="introduction">Introduction</h2>
<div class="level2">

<p>
The following documentation covers the Linux Ethernet switch configuration <abbr title="Application Programming Interface">API</abbr>
which is based on the Generic Netlink infrastructure.
</p>

</div>

<h2 class="sectionedit9" id="scope_and_rationale">Scope and rationale</h2>
<div class="level2">

<p>
Most Ethernet switches found in small routers are managed switches which allow
the following operations:
</p>
<ul>
<li class="level1"><div class="li"> configure a port to belong to a particular set of VLANs either as tagged or untagged</div>
</li>
<li class="level1"><div class="li"> configure a particular port to advertise specific link/speed/duplex settings</div>
</li>
<li class="level1"><div class="li"> collect statistics about the number of packets/bytes transferred/received</div>
</li>
<li class="level1"><div class="li"> any other vendor specific feature: rate limiting, single/double tagging…</div>
</li>
</ul>

<p>
Such switches can be connected to the controlling CPU using different hardware
busses, but most commonly:
</p>
<ul>
<li class="level1"><div class="li"> SPI/I2C/GPIO bitbanging</div>
</li>
<li class="level1"><div class="li"> MDIO</div>
</li>
<li class="level1"><div class="li"> Memory mapped into the CPU register address space</div>
</li>
</ul>

<p>
As of today the usual way to configure such a switch was either to write a
specific driver or to write an user-space application which would have to know
about the hardware differences and figure out a way to access the switch
registers (spidev, SIOCIGGMIIREG, mmap…) from user-space.
</p>

<p>
This has multiple issues:
</p>
<ul>
<li class="level1"><div class="li"> proliferation of ad-hoc solutions to configure a switch both open source and proprietary</div>
</li>
<li class="level1"><div class="li"> absence of common software reference for switches commonly found on the market (Broadcom, Lantiq/Infineon/ADMTek, Marvell, Qualcomm/Atheros…) which implies a duplication effort for each implementer</div>
</li>
<li class="level1"><div class="li"> inability to leverage existing hardware representation mechanisms such as Device Tree (spidev, i2c-dev.. do not belong in Device Tree and rely on Linux-specific &quot;forwarder&quot; drivers) to describe a switch device</div>
</li>
</ul>

<p>
The goal of the switch configuration <abbr title="Application Programming Interface">API</abbr> is to provide a common basis to build
re-usable and extensible switch drivers with the following ideas in mind:
</p>
<ul>
<li class="level1"><div class="li"> having a central point of configuration on top of which a reference user-space implementation can be provided but also allow for other user-space implementations to exist</div>
</li>
<li class="level1"><div class="li"> ensure the Linux kernel is in control of the actual hardware access</div>
</li>
<li class="level1"><div class="li"> be extensible enough to support per-switch features without making the generic implementation too heavy weighted and without making user-space changes each and every time a new feature is added</div>
</li>
</ul>

<p>
Based on these design goals the Generic Netlink kernel/user-space communication
mechanism was chosen because it allows for all design goals to be met.
</p>

</div>

<h2 class="sectionedit10" id="distributed_switch_architecture_vs_swconfig">Distributed Switch Architecture vs. swconfig</h2>
<div class="level2">

<p>
The Marvell Distributed Switch Architecture drivers is an existing solution
which is a heavy switch driver infrastructure, is Marvell centric, only
supports MDIO connected switches, mangles an Ethernet driver transmit/receive
paths and does not offer a central control path for the user.
</p>

<p>
swconfig is vendor agnostic, does not mangle the transmit/receive path
of an Ethernet driver and is focused on the control path of the switch rather
that the data path. It is based on Generic Netlink to allow for each switch
driver to easily extend the swconfig <abbr title="Application Programming Interface">API</abbr> without causing major core parts rework
each and every time someone has a specific feature to implement and offers a
central configuration point with a well-defined <abbr title="Application Programming Interface">API</abbr>.
</p>

</div>

<h2 class="sectionedit11" id="switch_configuration_api">Switch configuration API</h2>
<div class="level2">

<p>
The main data structure of the switch configuration <abbr title="Application Programming Interface">API</abbr> is a &quot;struct switch_dev&quot;
which contains the following members:
</p>
<ul>
<li class="level1"><div class="li"> a set of common operations to all switches (struct switch_dev_ops)</div>
</li>
<li class="level1"><div class="li"> a network device pointer it is physically attached to</div>
</li>
<li class="level1"><div class="li"> a number of physical switch ports (including CPU port)</div>
</li>
<li class="level1"><div class="li"> a set of configured vlans</div>
</li>
<li class="level1"><div class="li"> a CPU specific port index</div>
</li>
</ul>

<p>
A particular switch device is registered/unregistered using the following pair
of functions:
</p>

<p>
register_switch(struct switch_dev *sw_dev, struct net_device *dev);
unregister_switch(struct switch_dev);
</p>

<p>
A given switch driver can be backed by any kind of underlying bus driver (i2c
client, GPIO driver, MMIO driver, directly into the Ethernet MAC driver…).
</p>

<p>
The set of common operations to all switches is represented by the &quot;struct
switch_dev_ops&quot; function pointers, these common operations are defined as such:
</p>
<ul>
<li class="level1"><div class="li"> get the port list of a VLAN identifier</div>
</li>
<li class="level1"><div class="li"> set the port list of a VLAN identifier</div>
</li>
<li class="level1"><div class="li"> get the primary VLAN identifier of a port</div>
</li>
<li class="level1"><div class="li"> set the primary VLAN identifier of a port</div>
</li>
<li class="level1"><div class="li"> apply the changed configuration to the switch</div>
</li>
<li class="level1"><div class="li"> reset the switch</div>
</li>
<li class="level1"><div class="li"> get a port link status</div>
</li>
<li class="level1"><div class="li"> get a port statistics counters</div>
</li>
</ul>

<p>
The switch_dev_ops structure also contains an extensible way of representing and
querying switch specific features, 3 different types of attributes are
available:
</p>
<ul>
<li class="level1"><div class="li"> global attributes: attributes global to a switch (name, identifier, number of ports)</div>
</li>
<li class="level1"><div class="li"> port attributes: per-port specific attributes (MIB counters, enabling port mirroring…)</div>
</li>
<li class="level1"><div class="li"> vlan attributes: per-VLAN specific attributes (VLAN id, specific VLAN information)</div>
</li>
</ul>

<p>
Each of these 3 categories must be represented using an array of &quot;struct
switch_attr&quot; attributes. This structure must be filed with:
</p>
<ul>
<li class="level1"><div class="li"> an unique name for the operation</div>
</li>
<li class="level1"><div class="li"> a description for the operation</div>
</li>
<li class="level1"><div class="li"> a setter operation</div>
</li>
<li class="level1"><div class="li"> a getter operation</div>
</li>
<li class="level1"><div class="li"> a data type (string, integer, port)</div>
</li>
<li class="level1"><div class="li"> eventual min/max limits to validate user input data</div>
</li>
</ul>

<p>
The &quot;struct switch_attr&quot; directly maps to a Generic Netlink type of command and
will be automatically discovered by the &quot;swconfig&quot; user-space utility without
requiring user-space changes.
</p>

</div>

<h2 class="sectionedit12" id="references">References</h2>
<div class="level2">
<ul>
<li class="level1"><div class="li"> <a href="http://inst.eecs.berkeley.edu/~pathorn/ip175c/" class="urlextern" title="http://inst.eecs.berkeley.edu/~pathorn/ip175c/"  rel="nofollow">http://inst.eecs.berkeley.edu/~pathorn/ip175c/</a> <img src="../../lib/images/smileys/fixme.gif" class="icon" alt="FIXME" /> link down</div>
</li>
<li class="level1"><div class="li"> <a href="https://web.archive.org/web/20110831151445/http://inst.eecs.berkeley.edu/~pathorn/ip175c/phylib-swconfig/" class="urlextern" title="https://web.archive.org/web/20110831151445/http://inst.eecs.berkeley.edu/~pathorn/ip175c/phylib-swconfig/"  rel="nofollow">https://web.archive.org/web/20110831151445/http://inst.eecs.berkeley.edu/~pathorn/ip175c/phylib-swconfig/</a> (links to archive.org; content of original site is gone)</div>
</li>
<li class="level1"><div class="li"> <a href="http://www.debwrt.net/2010/11/07/switch-configuration-command-line-tool-swconfig-ported-2/" class="urlextern" title="http://www.debwrt.net/2010/11/07/switch-configuration-command-line-tool-swconfig-ported-2/"  rel="nofollow">http://www.debwrt.net/2010/11/07/switch-configuration-command-line-tool-swconfig-ported-2/</a></div>
</li>
<li class="level1"><div class="li"> <a href="http://www.icplus.com.tw/pp-IP175C.html" class="urlextern" title="http://www.icplus.com.tw/pp-IP175C.html"  rel="nofollow">http://www.icplus.com.tw/pp-IP175C.html</a></div>
</li>
<li class="level1"><div class="li"> <a href="https://forum.openwrt.org/viewtopic.php?pid=152508" class="urlextern" title="https://forum.openwrt.org/viewtopic.php?pid=152508"  rel="nofollow">OpenWrt Forum</a></div>
</li>
<li class="level1"><div class="li"> <a href="https://forum.openwrt.org/viewtopic.php?id=28716" class="urlextern" title="https://forum.openwrt.org/viewtopic.php?id=28716"  rel="nofollow">switch_port</a></div>
</li>
<li class="level1"><div class="li"> <a href="https://forum.openwrt.org/viewtopic.php?id=27485" class="urlextern" title="https://forum.openwrt.org/viewtopic.php?id=27485"  rel="nofollow">Is VLAN trunking on WR1034ND with VLAN id higher than 15 possible</a></div>
</li>
</ul>

</div>

<h2 class="sectionedit13" id="tags">Tags</h2>
<div class="level2">
<div class="tags"><span>
	<a href="../../tag/swconfig?do=showtag&amp;tag=swconfig" class="wikilink1" title="tag:swconfig" rel="tag">swconfig</a>,
	<a href="../../tag/rtl8366rb?do=showtag&amp;tag=rtl8366rb" class="wikilink1" title="tag:rtl8366rb" rel="tag">rtl8366rb</a>,
	<a href="../../tag/ar8316?do=showtag&amp;tag=AR8316" class="wikilink1" title="tag:ar8316" rel="tag">AR8316</a>
</span></div>

</div>

                    <!-- wikipage stop -->
                                    </div>

                <div class="docInfo"><bdi>doc/techref/swconfig.txt</bdi> · Last modified: 2014/08/06 05:05 by <bdi>phip</bdi></div>

                            </div></div><!-- /content -->

            <hr class="a11y" />

            <!-- PAGE ACTIONS -->
            <div id="dokuwiki__pagetools">
                <h3 class="a11y">Page Tools</h3>
                <div class="tools">
                    <ul>
                        <li><a href="swconfig?do=edit"  class="action source" accesskey="v" rel="nofollow" title="Show pagesource [V]"><span>Show pagesource</span></a></li><li><a href="swconfig?do=revisions"  class="action revs" accesskey="o" rel="nofollow" title="Old revisions [O]"><span>Old revisions</span></a></li><li><a href="swconfig?do=backlink"  class="action backlink" rel="nofollow" title="Backlinks"><span>Backlinks</span></a></li><li><a href="swconfig#dokuwiki__top"  class="action top" accesskey="t" rel="nofollow" title="Back to top [T]"><span>Back to top</span></a></li>                    </ul>
                </div>
            </div>
        </div><!-- /wrapper -->

        
<!-- ********** FOOTER ********** -->
<div id="dokuwiki__footer"><div class="pad">
    <div class="license">Except where otherwise noted, content on this wiki is licensed under the following license: <bdi><a href="http://creativecommons.org/licenses/by-nc-sa/3.0/" rel="license" class="urlextern">CC Attribution-Noncommercial-Share Alike 3.0 Unported</a></bdi></div>
    <div class="buttons">
        <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/" rel="license"><img src="../../lib/images/license/button/cc-by-nc-sa.png" alt="CC Attribution-Noncommercial-Share Alike 3.0 Unported" /></a>        <a href="http://www.dokuwiki.org/donate" title="Donate" ><img
            src="../../lib/tpl/openwrt/images/button-donate.gif" width="80" height="15" alt="Donate" /></a>
        <a href="http://www.php.net" title="Powered by PHP" ><img
            src="../../lib/tpl/openwrt/images/button-php.gif" width="80" height="15" alt="Powered by PHP" /></a>
        <a href="http://validator.w3.org/check/referer" title="Valid HTML5" ><img
            src="../../lib/tpl/openwrt/images/button-html5.png" width="80" height="15" alt="Valid HTML5" /></a>
        <a href="http://jigsaw.w3.org/css-validator/check/referer?profile=css3" title="Valid CSS" ><img
            src="../../lib/tpl/openwrt/images/button-css.png" width="80" height="15" alt="Valid CSS" /></a>
        <a href="http://dokuwiki.org/" title="Driven by DokuWiki" ><img
            src="../../lib/tpl/openwrt/images/button-dw.png" width="80" height="15" alt="Driven by DokuWiki" /></a>
    </div>
</div></div><!-- /footer -->

    </div></div><!-- /site -->

    <div class="no"><img src="../../lib/exe/indexer.php?id=doc%253Atechref%253Aswconfig&amp;1432267220" width="2" height="1" alt="" /></div>
    <div id="screen__mode" class="no"></div>    <!--[if ( lte IE 7 | IE 8 ) ]></div><![endif]-->
</body>
</html>
